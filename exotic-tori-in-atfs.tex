% vim: spelllang=en_gb

\documentclass[12pt,a4paper,draft]{scrartcl}
\usepackage{ifdraft}

% --------------------
% Set Language Options
% --------------------

\usepackage[nswissgerman,french,main=english]{babel}
\usepackage[autostyle,english=american,german=swiss]{csquotes}
\MakeOuterQuote{"}

\usepackage[shortcuts]{extdash}

% --------------
% Font & Symbols
% --------------

\usepackage{amssymb,mathtools}
\usepackage[warnings-off={mathtools-colon,mathtools-overbracket}]{unicode-math}
\usepackage[oldstyle,proportional]{libertinus-otf}

% ---------------
% Set Page Layout
% ---------------

% Get length of 65 characters
%\setlxvchars

\usepackage[driver=auto]{geometry}
% A5: 148mm × 210mm
% A4: 210mm × 297mm
\geometry{
  width=140mm,
  height=217mm,
  marginparsep=3mm,
  marginparwidth=30mm,
}
\ifdraft{\geometry{
  inner=10mm,
  marginparwidth=50mm
}}{}


% ---------------------
% Load Various Packages
% ---------------------

% Various Math Environments
\usepackage{amsthm,thmtools}
\usepackage{physics} % various shortcuts

% Bibliography
\usepackage{biblatex}
\addbibresource{bibliography.bib}

% For general figures
\usepackage[final]{graphicx}
\graphicspath{{/img}}
\usepackage{subcaption}
\usepackage{tikz}
\usetikzlibrary{babel,cd,shapes,3d}
\tikzcdset{arrow style=math font}
\tikzset{cross/.style={
    cross out, draw, solid, thin, 
    minimum size=2*(#1-\pgflinewidth), 
    inner sep=0pt, outer sep=0pt
  },
  cross/.default={3},
  conic/.pic={
    \begin{scope}[canvas is xz plane at y=0]
      \draw (0,0) circle [radius=0.5];
    \end{scope}
    \begin{scope}[canvas is xz plane at y=1]
      \draw (0,0) circle [radius=0.8];
    \end{scope}
    \begin{scope}[canvas is xz plane at y=-1]
      \draw (-20:.8) arc [start angle=-20,end angle=160,radius=.8];
      \draw[dotted] (160:.8) arc [start angle=160,end angle=340,radius=.8];
    \end{scope}
    \begin{scope}[rotate around y=20]
      \draw (.8,1) .. controls +(0,0) and +(0,.3) .. (0.5,0) .. controls +(0,-0.3) and +(0,0) .. (.8,-1);
      \draw (-.8,1) .. controls +(0,0) and +(0,.3) .. (-0.5,0) .. controls +(0,-0.3) and +(0,0) .. (-.8,-1);
    \end{scope}
  },
  degenerate conic/.pic={
    \begin{scope}[canvas is xz plane at y=1]
      \draw (0,0) circle [radius=.8];
    \end{scope}
    \begin{scope}[canvas is xz plane at y=-1]
      \draw (-20:.8) arc [start angle=-20,end angle=160,radius=.8];
      \draw[dotted] (160:.8) arc [start angle=160,end angle=340,radius=.8];
    \end{scope}
    \begin{scope}[rotate around y=20]
      \draw (-.8,-1) -- (.8,1);
      \draw (-.8,1) -- (.8,-1);
    \end{scope}
  },
  reduced conic/.pic={
    \begin{scope}[canvas is xz plane at y=1]
      \draw[very thin, opacity=0.5] (0,0) circle [radius=.8];
      \draw (-32:.8) arc [start angle=-32,end angle=32,radius=.8];
    \end{scope}
    \begin{scope}[canvas is xz plane at y=-1]
      \draw[very thin, opacity=0.5] (0,0) circle [radius=.8];
      \draw (-32:.8) arc [start angle=-32,end angle=32,radius=.8];
    \end{scope}
    \begin{scope}[canvas is xz plane at y=0]
      \draw[very thin, opacity=0.5] (0,0) circle [radius=.5];
      \draw (-32:.5) arc [start angle=-32,end angle=32,radius=.5];
    \end{scope}
    \foreach \φ in {32,-32} {
      \begin{scope}[rotate around y=\φ]
        \draw (.8,1) .. controls +(0,0) and +(0,.3) .. (0.5,0) .. controls +(0,-0.3) and +(0,0) .. (.8,-1);
      \end{scope}
    }
    \begin{scope}[rotate around y=20]
      \draw[very thin, opacity=0.5] (-.8,1) .. controls +(0,0) and +(0,.3) .. (-0.5,0) .. controls +(0,-0.3) and +(0,0) .. (-.8,-1);
    \end{scope}
  }
}

% For lists
\usepackage[shortlabels]{enumitem}

% For better Tables
\usepackage{tabularray}

% For more fine grained typesetting in final mode.
% Else set the tolerance for overfull warnings higher.
\ifdraft{\hfuzz=1.5pt}{\usepackage{microtype}}

% Links and stuff
\usepackage[final]{hyperref}
\usepackage[noabbrev,capitalize]{cleveref}

% For Todonotes
\usepackage[obeyDraft]{luatodonotes}

% --------------------------------------------
% Define Theorem Environments & Math Operators
% --------------------------------------------

\declaretheorem[numberwithin=section]{theorem}
\declaretheorem[sibling=theorem]{lemma, proposition, corollary}
\declaretheorem[sibling=theorem,style=definition]{definition, example}
\declaretheorem[sibling=theorem,style=remark]{remark}

\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\HF}{HF}
\DeclareMathOperator{\HM}{HM}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\Flux}{Flux}
\DeclareMathOperator{\Crit}{Crit}

\begin{document}
\title{Semi-Local Lagrangian Tori in Dimension Four}
\author{JoJoJo}

\maketitle

\todo{Definitionen von begriffen mit \textbf{textbf} oder \emph{emph}? Joel bevorzugt \textbf{fettes zeug}.}

\section{Introduction}

\section{Local model}

\subsection{Some almost toric geometry}

We use almost toric geometry to define the local model spaces. In the honest toric setting, every Delzant polytope defines a toric symplectic manifold which is unique up to equivariant symplectomorphisms. A similar result holds in almost toric geometry, where the role of the toric moment polytope is played by the so-called \emph{almost toric base diagram}. Every almost toric base diagram defines a unique symplectic manifold, see \cite[Theorems 8.5]{evans2021atfs}. 

\begin{remark}
    \label{rk:atfbasediagram}
    The following lengthy remark is a rough description of the geometric significance of almost toric base diagrams.
    Except for \cref{rk:atffibres}, it will not be used anywhere else in the paper.
    Every almost toric fibration has an underlying completely integrable system whose singularities are of toric or of focus-focus type.
    If there is at least one focus-focus singularity, then the system does not admit global action coordinates in the sense of \cite{Dui80} (in contrast to the honest toric case) because of topological monodromy of the torus bundle over the regular locus.
    By removing certain curves from the base, one make it simply connected and obtain a toric moment map $\pi_0 \colon X_0 \rightarrow \Delta_0$ defined on an open dense subset $X_0$.
    The closure of $\Delta_0$ yields the underlying set $\Delta \subset \mathbb{R}^2$ of the ATF-base diagram.
    Its decorations are given by nodes (marking the position of focus-focus singularities) and dashed lines (corresponding to where curves were removed to compute action coordinates).
    One can always choose the set of curves such that $\Delta$ is a polytope and from every node, there emanates one straight ray.
    This ray (whose direction encodes information about the eigenvector of the topological monodromy around the corresponding node) is called the \emph{eigenray} of the node.
    In that case, the map $\pi_0$ extends to a continuous map $\pi \colon X \rightarrow \Delta$.
    We call $\pi$ the \emph{almost toric moment map}, as it is an analogue of the moment map in the toric case.
    In the context of this paper, we will only encounter almost toric fibrations having an almost toric moment map. 
\end{remark}

Let $d,p,q \in \mathbb{N}$ be integers such that $d≥1$,   $p,q$ are coprime\footnote{Here, we consider the pair $(1,0)$ as coprime.} and with $p>q≥0$. Let $\Delta_{dpq}$ be the almost toric base diagram obtained by decorating the right half-plane
$$\Delta_{dpq} = \{ (x,y) \in \mathbb{R}^2 \, \vert \, x \geqslant 0 \}$$
with $d$ distinct nodes contained in the ray 
\begin{equation}
  \label{eqn:eigenline}
  R = \{\alpha (p,q) \in \Delta_{dpq} \, \vert \, \alpha > 0 \}
\end{equation}
and having a common eigenvector $(p,q)$, see \cref{fig:Bdpq_moment_image}(a). 

\begin{definition}
    \label{def:bdpq}
    Let $B_{dpq}$ be the symplectic manifold having $\Delta_{dpq}$ as almost toric base diagram. 
\end{definition}

\begin{remark}
    The symplectic manifold $(B_{dpq}, \omega)$ is exact. Indeed, we will see in \cref{sec:homology} that there is a set of generators of $H_2(B_{dpq})$ represented by Lagrangian spheres, meaning that $[\omega] = 0 \in H^2(B_{dpq};\mathbb{R})$. The space $B_{dpq}$ can be realized as the Milnor fibre of a smoothing of certain cyclic quotient sigularities. For more details on this, see ...
\end{remark}

Note that $\Delta_{dpq}$ depends on $d$ parameters $x_1,\ldots,x_d > 0$ which correspond to the $x$-coordinate of the position of the nodes. The symplectic manifold in \cref{def:bdpq} is independent of the position of the nodes, which is why we suppress the dependency on the $x_i$ in the notation. Indeed, any configuration of $d$ nodes on a common eigenline is related to any other such configuration by a so-called \emph{nodal slide} and a nodal slide of the ATF-base diagram induces a symplectomorphism of the corresponding symplectic manifolds, see \cite[Theorems 8.10]{evans2021atfs}. This means that the space $B_{dpq}$ is well-defined up to symplectomorphisms.

Let $\Delta$ be an ATF-base diagram of a symplectic manifold $X$. Then every $x \in \Delta$ defines a unique subset $T(x) \subset X$, which we call the \emph{ATF-fibre} over $x$. If $x \in \partial \Delta$, then $T(x)$ is a point or an isotropic circle. If $x$ is a node, then $T(x)$ is a Lagrangian Whitney sphere, i.e.\ a Lagrangian immersion of a $2$-sphere with one transverse self-intersection. If $x$ is neither a node, nor contained in the boundary, then $T(x)$ is a Lagrangian torus and we call such a torus a \emph{regular ATF-fibre}.

\begin{remark}
    \label{rk:atffibres}
    The ATF-fibre $T(x)$ can be defined as the fibre $T(x) = \pi^{-1}(x)$ of the almost toric moment map $\pi$, defined in \cref{rk:atfbasediagram}. Note however that the definition of $\pi$ is not straightforward. 
\end{remark}

\begin{remark}
    \label{rk:pinchedtorus}
    A Lagrangian Whitney sphere living over the node of an ATF-base diagram can be interpreted as a limit of regular fibres (i.e.\ Lagrangian tori) by viewing it as a Lagrangian torus which is \emph{pinched} along a curve on the torus. The homology class of this curve determines the topological monodromy of the torus bundle in a neighbourhood of the node and thus the eigenvector of the node. 
\end{remark}

Almost toric fibres are left unaffected by nodal slides, provided they are not contained in the segment on which the nodal slide is supported\footnote{By this we mean the line segment obtained as the union of points across which the node moves during the nodal slide.}.

\begin{lemma}
    \label{thm:nodal_slide}
    Let $\Delta, \Delta'$ be two almost toric base diagrams which are related by nodal slides\footnote{This impies that the underlying sets $\Delta, \Delta' \subset \mathbb{R}^2$ coincide.} which are supported in the set $\Sigma$. Let $X,X'$ be symplectic manifolds corresponding to $\Delta,\Delta'$ and dentote by $T(x) \subset X$ and $T'(x) \subset X$ their respective ATF fibres. Then for every $x \in \Delta \setminus \Sigma$, there is a symplectomorphism $\psi \colon X \rightarrow X'$ with $\psi(T(x)) = T'(x)$.\todo{definition nodal slide, und bild dazu.}
\end{lemma}

\begin{proof}
    This follows from the proof of \cite[Theorem 8.10]{evans2021atfs}, by taking the set $K \subset \Delta$ therein small enough so that $x \notin K$.
\end{proof}

\begin{remark}
    This fails for points which are contained in a segment on which a nodal slide is supported, even if both points correspond to regular almost toric fibres. In fact, this is one of the main sources to construct so-called exotic Lagrangian tori, i.e.\ sets of tori for which there is no ambient symplectomorphism mapping one to the other. This was pioneered by Vianna \cite{Via16,Via17}. This occurs for example in $\mathbb{R}^4 = \mathbb{C}^2$. Let $T_{\text Cl}(a) = S^1(a) \times S^1(a) \subset \mathbb{C} \times \mathbb{C}$ be the Clifford torus. It is the toric fibre over the base point $(a,a)$ in the standard toric structure on $\mathbb{R}^4$. To obtain an almost toric fibration with one focus-focus singularity on $\mathbb{R}^4$, perform a nodal trade at the vertex of the toric structure. By a nodal slide, move the node across $(a,a)$ to obtain the Chekanov torus $T_{\text Ch}(a)$ over the point $(a,a)$.
\end{remark}

Returning to the special case of $X = B_{dpq}$, let $R = \{\lambda(p,q) \vert \lambda > 0\} \subset \Delta_{dpq}$ be the half-line containing the eigenray of the nodes in the base diagram $\Delta_{dpq}$. 

\begin{definition}
    For every $x \in \Delta_{dpq} \setminus R$, we denote the almost toric fibre over $x$ by $T_{dpq}(x) \subset B_{dpq}$. For every $x \in R$ and $k \in \{0,\ldots,d\}$, we denote by $T^k_{dpq}(x) \subset B_{dpq}$ the almost toric fibre over $x$ in an almost toric base diagram in which there are $k$ of the $d$ nodes to the left of $x$.\todo{image}
\end{definition}

By \cref{thm:nodal_slide}, these tori are well-defined, i.e.\ independent of the position of the nodes in $\Delta_{dpq}$. 

\subsection{Symplectic embeddings}

\subsection{Homology of \texorpdfstring{$B_{dpq}$}{Bdpq}}
\label{sec:homology}

Let $T(x) = π^{-1}(\qty{x})$ for $x ∈ Δ_{dpq}$ be a Lagrangian torus fibre. In the computation of the displacement energy of $T(x)$, we rely on an explicit basis of the relative homology group $H_2\qty(B_{dpq},T(x))$.
See also \cite[Lemma 7.11]{evans2021atfs} for the homology of $B_{dpq}$.

\begin{lemma}
  \label{thm:homology}
  We have
  \begin{align*}
    H_0(B_{dpq}) &≅ ℤ & H_1(B_{dpq}) &≅ ℤ_p & H_2(B_{dpq}) &≅ ℤ^{d-1} \\
                 &    &              &      & H_2(B_{dpq},T(b)) &≅ ℤ^{d+1}
  \end{align*}
\end{lemma}

\begin{proof}
  Here we follow very closely \cite[Lemma 7.11]{evans2021atfs}.

  Since all $T(x) = π^{-1}(x)$ are homotopic, we may assume that $x = (x_1,x_2)$ is contained in the horizontal eigenline $R$ (see \cref{eqn:eigenline}) such that all the nodes are to the right of $x$ as in \cref{fig:branch_cut_retraction}.

  As in \cite[Lemma 7.11]{evans2021atfs}, $B_dpq$ retracts onto $π^{-1}(ℓ)$, where $ℓ ⊂ R$ a line segment containing $(0,0)$ and all the nodes.
The preimage $π^{-1}(ℓ)$ can be understood as follows:
If there were no nodes on the line, this would be a solid torus $\hat{T} = S¹×D²$ with $∂ \hat{T}$  homotopy equivalent to $T(x)$.
With an appropriate choice of basis $(1,0),(0,1) ∈ H₁(∂ \hat{T})$, for each critical fibre $k ∈ \qty{1,…,d}$ we collapse a loop along the homology class $(-q,p)$, as in \cref{fig:collapse_cycles}.

Up to homotopy this is the same as attaching a disk $D_k$ along $(-q,p)$.
Again up to homotopy we can also require that the $d$ discs $D_1,…,D_d$ are attached along $∂ \hat{T}$.
Let us call the resulting space (solid torus $\hat{T}$ with disks $D_i$ attached) $S$.

\begin{figure}
  \centering
  \begin{subfigure}{0.45\textwidth}
    \centering
    \begin{tikzpicture}[scale=1.8]
      \fill[blue,opacity=0.2] (0,1) rectangle (3,-1);
      \draw[thick] (0,1) -- (0,-1);
      \draw[line width=0.08cm,red,opacity=0.4,text opacity=1] (0,0) -- node[pos=0.6, anchor=north] {$ℓ$} (2.5,0);
    \fill (2.5,0)  circle[radius=1pt] node[anchor=south] {$T(b)$};
      \draw (1,0) node[cross] {} (2,0) node[cross] {};
    \end{tikzpicture}
    \caption{Retraction to branch cut line}
    \label{fig:branch_cut_retraction}
  \end{subfigure}%
  \begin{subfigure}{0.55\textwidth}
    \includegraphics[width=\textwidth]{img/homology_collapse.pdf}
    \caption{The two cycles marked in red and purple (here $p=2, q=1$) are collapsed to a point.}
    \label{fig:collapse_cycles}
  \end{subfigure}
  \caption{Calculation of the homology of $B_{dpq}$}
\end{figure}

We consider the long exact sequence of homology for the pair $(S,∂ \hat{T})$:

\[
\begin{tikzcd}[column sep=small]
  H_2(∂ \hat{T}) \ar[r,"0"] &
  H_2(S) \ar[r,hook]\ar[d,"≅"] &
  H_2(S,∂ \hat{T}) \ar[r]\ar[d,"≅"] &
  H_1(∂ \hat{T}) \ar[r,two heads]\ar[d,"≅"] &
  H_1(S) \ar[r,"0"] \ar[d,"≅"] &
  H_1(S, ∂ \hat{T}) \ar[d,"≅"]
  \\
  &
  ℤ^{d-1} &
  ℤ^{d+1} &
  ℤ² &
  ℤ_p &
  0
\end{tikzcd}
\]

The first horizontal map is zero since $∂ \hat{T}$ is homotopic to a circle in $S$.

The homology $H_2(S)$ can be seen as follows: By contracting the solid torus $\hat{T}$ in $S$ to a circle, we see that $S$ is homotopic to a circle with $d$ discs glued to its boundary by a degree $p$ map.
So $H_2(S)$ is generated by the visible Lagrangian spheres $\qty{S_2,…,S_d}$ mentioned in \cref{sec:Bdpqatfs}, since $S_k ≃ D_{k-1}-D_{k}$.

$H_2(S,∂ \hat{T})$ is generated by the discs $D_0 = \text{pt}×D²,D₁,…,D_d$. In $B_{dpq}$, these discs can be seen, where the disc intersecting the toric boundary collapses the $(0,1)$ cycle in the toric fibre $T(x_1,x_2)$ and the discs intersecting the critical points collapse the $(-q,p)$ cycle (see \cref{fig:homology_generating_discs}).

The boundary map $∂ \colon H_2(S,∂ \hat{T}) → H_1(∂ \hat{T})$ is given by $\partial D_0 = (0,1),\, \partial D_i = (-q,p)$, meaning that the last horizontal map $H_1(∂ \hat{T}) → H_1(S)$ maps $(0,1)$ to the generator of $ℤ_p$.
\end{proof}

\begin{figure}
  \centering
  \begin{tikzpicture}
    \fill[black!5] (0,4) rectangle (7,-1);

    \coordinate (xy) at (2.7,3.5);
    \node[anchor=south] at (xy) {$T(x_1,x_2)$};
    \fill (xy) circle[radius=.05];
    \draw (xy)
           .. controls +(0,0) and +(-.5,1) .. node[anchor=east, near end] {$D₁$} (2,1)
      (xy) .. controls +(0,0) and +(-.5,1) .. node[anchor=west, near end] {$D₂$} (4,2)
      (xy) .. controls +(0,0) and +(-.5,1) .. node[anchor=west, near end] {$D₃$} (6,3)
      (xy) .. controls +(0,0) and +(1,0) .. node[anchor=south, near end] {$D₀$} (0,2.5);

    \draw[ultra thick, blue, draw opacity=.3] (2,1) -- node[anchor=north] {$S₂$} (4,2);
    \draw[ultra thick, purple, draw opacity=.3] (4,2) -- node[anchor=north] {$S₃$} (6,3);

    \draw[thick,dotted] (2,1) node[cross] {} -- (4,2) node[cross] {} -- (6,3) node[cross] {} -- (7,3.5);

    \draw[thick] (0,4) -- (0,-1);
  \end{tikzpicture}

  \caption{The disks $D₀, …, D_d$ generating the homology $H₂\qty(B_{dpq}, T(x_1,x_2))$}
  \label{fig:homology_generating_discs}
\end{figure}

\section{Lower Bound on Displacement Energy: Minimal J-holomorphic Curves}
\label{sec:lower_bound}

We want to use a classical theorem by Chekanov \cite{chekanov1998}, that gives a lower bound on the displacement energy of Lagrangian submanifolds in certain symplectic manifolds. To state the theorem we recall the central notions contained in the theorem.

Suppose that $(X,\omega)$ is a symplectic manifold. Define $\mathcal{H}(X)\vcentcolon=\mathcal{C}^\infty_\text{c}(X\times[0,1],\mathbb{R})$, the space of compactly supported, time-dependent Hamiltonian functions on $X$. For $H \in \mathcal{H}(X)$ set
\[
    \lVert H \rVert \vcentcolon= \int_0^1 \left(\sup_\text{x \in X} H_t(x) - \inf_\text{x \in X} H_t(x) \right) dt.
\]
This defines a semi-norm on $\mathcal{H}(X)$ and leads to the definition of the displacement energy.

\begin{definition}
\label{def:displacement_energy}
    For a subset $A \subseteq X$ in a symplectic manifold $(X,\omega)$ define the \textbf{displacement energy} of $A$ to be 
    \[e(A)\vcentcolon=\inf\left\{\lVert H\rVert \mid H\in \mathcal{H}(X) \text{ such that } \varphi^H_1(A) \cap A = \emptyset\right\},\]
    where $\varphi^H_1$ denotes the Hamiltonian diffeomorphism generated by $H$ and the infimum over the empty set is defined to be infinity.
\end{definition}

Chekanov's theorem only holds for a specific class of symplectic manifolds, namely geometrically bounded ones.

\begin{definition}
    Let $(X,\omega)$ be a symplectic manifold. We call an almost complex structure $J$ on $(X,\omega)$ \textbf{geometrically bounded}\footnote{This is non-standard terminology. We do not use the word \textit{tame} in order to avoid confusion with the notion of $\omega$-tame.} if there is a Riemannian metric $g$ on $X$ such that 
    \begin{enumerate}
        \item $g$ is complete,
        \item there are constants $c_1,c_2 > 0$ such that $\omega(JV,V) \geqslant c_1 \Vert V \Vert_g^2$ and $\vert \omega(V,W) \vert \leqslant c_2 \Vert V \Vert_g \Vert W \Vert_g$ for all tangent vectors $V,W$, and
        \item the sectional curvature of $g$ is bounded from above and the injectivity radius is bounded from below.
    \end{enumerate}
    Denote the space of such almost complex structures by $\mathcal{J}_{\text{geo}}(X,\omega)$.
    The symplectic manifold $(X,\omega)$ is called \textbf{geometrically bounded} if there exists a geometrically bounded $J$. 
\end{definition}

\begin{remark}
  \label{rem:Bdpq_geometrically_bounded}
    Closed symplectic manifolds are geometrically bounded, and the same holds for a large class of symplectic manifolds that look standard at infinity, i.e. cotangent bundles of compact manifolds and symplectizations. For more details on this notion see also \cite[Chapter X, Definition 2.2.1]{AudLaf94}. In particular $B_{dpq}$ is geometrically bounded by \cref{rem:Bdpq_lens_space}.
\end{remark}
\begin{remark}
  \label{rem:J_compactly_perturbed}
  If $J_0 \in \mathcal{J}_\text{geo}(X,ω)$ is a geometrically bounded almost complex structure, $K ⊂ M$ compact, and $J$ is a tame almost complex structure such that $J = J_0$ on $M ∖ K$, then $J$ is also geometrically bounded.
\end{remark}

With these definitions in place we define the two quantities that play a crucial role in Chekanov's theorem.

\begin{definition}
    Suppose that $L$ is a compact Lagrangian submanifold in a symplectic manifold $(X,\omega)$ that is geometrically bounded. Furthermore, let $J \in \mathcal{J}_{\text{geo}}(X,\omega)$ be a geometrically bounded almost complex structure. Define
    \[
        \sigma_D(X,L,J)\vcentcolon=\text{inf}\{\langle[\omega],[u]\rangle \mid u\colon(\mathbb{D}^2,\partial {\mathbb{D}^2})\to(X,L) \text{ non-constant $J$-holomorphic disc}   \}
    \]
    and 
    \[
        \sigma_S(X,J)\vcentcolon=\text{inf}\left\{\langle[\omega],[u]\rangle \mid u:S^2 \to X \text{ non-constant $J$-holomorphic sphere}   \right\},
    \]
    where $\langle\cdot{,}\cdot\rangle$ denotes the evaluation map, given my integration. These two quantities may be equal to infinity, if the infimum is taken over an empty set.
\end{definition}

\begin{theorem}[Chekanov 1998 \cite{chekanov1998}]
  \label{thm:chekanov}
  Let $L$ be a compact Lagrangian submanifold of a geometrically bounded symplectic manifold $(X,ω)$. For every geometrically bounded almost complex structure $J$, the displacement energy satisfies
  \[e(L) ≥ \min\qty{σ_D(X,L,J),σ_S(X,J)}.\]
\end{theorem}



Let $(M,ω,J)$ be a geometrically bounded connected symplectic manifold with $ω$-compatible almost complex structure $J$, denote by $g$ the associated Riemannian metric, and let $u\colon Σ → M$ be a J-holomorphic curve.

Then Gromov's Monotonicity Lemma (e.g. \cite[Proposition 4.3.1 (ii)]{sikorav1994}) gives us the following statement:

\begin{lemma}[Monotonicity]
  \label{thm:monotonicity}
  There exists a $C>0$ (depending only on $(M,ω,J)$) s.t.\ for all $x ∈ \im(u)$, $B_r(x)$ an open ball w.r.t.\ $g$ with $r > 0$ and $u(∂Σ) ⊂ M ∖ B_r(x)$, we have
  \[∫_u ω ≥ C r²\]
\end{lemma}

As a simple corollary we get:

\begin{corollary}
  \label{thm:small_buffer}
  Suppose $A^+ ⊔ A^- ⊂ M$, with both $A^±$ non-empty, $Σ$ is connected Riemann surface with $∂Σ = ∂Σ^+ ⊔ ∂Σ^-$, with both $∂Σ^±$ non-empty and $u\colon (Σ,∂Σ) → (M,A^+ ⊔ A^-)$ a $J$-holomorphic with $u(∂Σ^±) ⊂ A^±$ respectively.
  Then
  \[∫_u ω ≥ \frac{C d(A^+,A^-)^2}{4} \; .\]
\end{corollary}

\begin{proof}
  Pick a path $γ$ from $∂Σ^-$ to $∂Σ^+$. By the intermediate value theorem there is $t$ s.t.\ $d((u ∘ γ) (t),A^+) = d((u ∘ γ)(t), A^-)$. Picking $x = (u ∘ γ)(t)$ and using the triangle inequality we have that $B_{d(A^+,A^-)/2}(x) ⊂ M ∖ ( A^+ ⊔ A^-) $. Applying \cref{thm:monotonicity} to $B$ we get the desired result.
\end{proof}

\begin{proposition}
  \label{thm:lower_bound}
    \[
        e(T(x)) ≥ x_1. 
    \]
\end{proposition}
\begin{proof}
  Looking at the almost moment image $\im μ$, we want to pretend for a moment that there are no nodes.
  This gives us the toric manifold
  \begin{align*}
    μ_0 \colon ℂ × T^* S^1 &→ \{x ∈ ℝ² \mid x_1 ≥ 0\}\\
    (z,q,θ) &↦ (\abs{z}^2, q) \; ,
  \end{align*}
  with the symplectic structure $ω_0 = ω_ℂ ⊕  ω_{T^*S¹}$, the two direct summands being the standard symplectic structures on $ℂ$ and $T^*S¹$ respectively. We also equip $ℂ × T^*S¹$ with the standard almost complex structure $J_0$, which is compatible with $ω_0$.
  In particular $( ℂ × T^* S^1, ω_0, J_0)$ is geometrically bounded.\footnote{We may identify $ℂ × T^* S^1$ with $ℂ × (ℂ / ℤ)$, where $ℤ$ acts by the isometries of $ℤ$-translations along the real axis. Thus $(ℂ × T^* S^1, ω_0, J_0)$ is geometrically bounded as a quotient of $( ℂ^2, ω_ℂ ⊕ ω_ℂ, i ⊕ i)$ by isometries.}
  
  The induced Riemannian metric defines the metric
  \[ d((z_1,p_1,θ_1), (z_2,p_2,θ_2))^2 = \abs{z_2 - z_1}^2 + (p_2 - p_1)^2 + \min_{k ∈ ℤ}\{(θ_2 - θ_1 + 2πk)^2\}\]
  for $(z_i,p_i,θ_i) ∈ ℂ × T^* S¹$.

  Let $u,v ∈ \im μ_0$. Then we have
  \[ d(μ_0^{-1}(u),μ_0^{-1}(v))^2 ≥ (\sqrt{v_1}-\sqrt{u_1})^2 + (v_2-u_2)^2 ≕ d_{μ_0}(u,v)^2 \; ,\]
  defining us a metric on $\im μ_0$.

  Let $C$ be the constant in \cref{thm:monotonicity} for $( ℂ × T^* S¹, ω_0, J_0)$.
  Set $A_0^- = x, A_0 = \qty{y ∈ \im μ_0 \mid d_{μ_0}(x,y) ≤ 2 \sqrt{\frac{x_1}{C}} }$ and $A_0^+ =\qty{y ∈ \im μ_0 \mid d_{μ_0}(x,y) = 2 \sqrt{\frac{x_1}{C}}}$.

  Let us now return to $B_{dpq}$. Using a nodal slide (\cref{thm:nodal_slide}) we may assume that $A_0 ⊂ \im μ$ contains no nodes.
  Using Delzant's classification of toric symplectic manifolds, we may identify $μ^{-1}(A_0) ⊂ B_{dpq}$ with $μ_0^{-1}(A_0) ⊂ ℂ × T^* S¹$ by an equivariant symplectomorphism.
  Let $J_{B_{dpq}}$ be a geometrically bounded almost complex structure on $B_{dpq}$ (which exists by \cref{rem:Bdpq_geometrically_bounded}).
  Let $K$ be a compact set, its interior containing $μ^{-1}(A_0)$. Then there exists a geometrically bounded (by \cref{rem:J_compactly_perturbed}) almost complex structure $J$ on $B_{dpq}$ such that $J=J_{B_{dpq}}$ on $B_{dpq} ∖ K$ and $J=J_0$ on $μ^{-1}(A_0)$.

  Set $A^± = μ^{-1}(A_0^±), A = μ^{-1}(A_0)$ and let $u\colon (D,∂D) → (B_{dpq}, T(x))$ be a $J$-holomorphic disk. If $u(D) ⊂ A$, the homology class $[u] ∈ H_2(ℂ × T^*S¹, T(x))$ must be a multiple of the generator $D_0$ of this homology group, which has $∫_{D_0} ω_0 = x_1$.
  
  If $u(D)$ is not contained in $A$, then $u(D) ∩ A^+$ is non-empty. Let $Σ ⊂ D$ be the connected component of $u^{-1}(A)$ containing $∂D$. Using \cref{thm:small_buffer} on $A^±$ and $u|_Σ$, we get
  \[∫_u ω ≥ ∫_{u|_Σ} ω ≥ \frac{C}{4} d(A^+,A^-)^2 ≥ \frac{C}{4} \frac{4x_1}{C} = x_1 \;. \]

  Noting that there cannot be any non-constant $J$-holomorphic spheres (since $H_2(B_{dpq})$ is generated by Lagrangians, see \cref{thm:homology}), and then using \cref{thm:chekanov} we conclude.
\end{proof}

Gescheiterte Boxen:
\begin{proof}
  Set $A = [0,2x_1] × [x_2-x_1, x_2+x_1] ⊂ \im μ$, called the "box" of $T(x)$.
  Using \cref{thm:nodal_slide}, we may slide the nodes such that none are contained in the box $A$.
  Then by Delzant's classification of toric symplectic manifolds, $μ^{-1}(C)$ is equivariantly symplectomorphic to a subset of $T^*S¹ × ℂ$, namely $C × D$ with $C = \{(p,q) ∈ T^*S^1 \mid \norm{q}^2 < x_1\}, D = \{z ∈ ℂ \mid \abs{z}^2< 2x_1\}$.

  Let $J_A$ be the almost complex structure $C × D$ induced by the canonical\todo{??} complex structures on $T^*S¹$ and $ℂ$, and $J_{B_{dpq}}$ a geometrically bounded structure on $B_{dpq}$.
  Let $K ⊂ B_{dpq}$ be a compact set such that its interior contains $μ^{-1}(C)$.
  Then interpolating between $J_A$ and $J_{B_{dpq}}$, there exists a geometrically bounded (by \cref{rem:J_compactly_perturbed}) almost complex structure $J$ on $B_{dpq}$ such that $J=J_A$ on $μ^{-1}(C)$ and $J=J_{B_{bdp}}$ on $B_{dpq} ∖ K$.

  Suppose $u \colon (D_1,∂D_1) → (B_{dpq},T(x))$ is a $J$-holomorphic disk.
  We claim that $∫_u ω ≥ x_1$. 

  If $u(D_1) ⊂ μ^{-1}(A)$, i.e.\ it is contained in our box, then since $[u] ∈ H_1(μ^{-1}(A), T(x))$ has positive area class, and $H_1(μ^{-1}(A),T(x))$ is generated by a disk $D_0$ of area $x_1$ the result follows.

  Otherwise, $u$ intersects at least one of the three boundaries of the box:
  \[ μ^{-1}(\{2x_1\} × [x_2-x_1, x_2+x_1]) \; ,\quad
     μ^{-1}([0,2x_1] × \{x_2 ±x_1\}) \; .
  \]
  Let us assume it intersects $μ^{-1}(\{2x_1\} × [x_2-x_1, x_2+x_1])$, the other two cases are similar.
  Let $Σ ⊂ u^{-1}(μ^{-1}(A)) ⊂ D$ be the connected component of $u^{-1}(μ^{-1}(A))$ containing $∂D_1$. Denote $∂_A$ So $u|_Σ$ is a $J$-holomorphic curve contained in $μ^{-1}(A) = C × D$. Let $π_2 \colon C × D$ be the projection onto the second factor. Then 
\end{proof}











\todo{Why is $B_{dpq}$ geometrically bounded?}






To use \cref{thm:chekanov}, we can choose a suitable almost complex structure on $B_{dpq}$.

We do so in the following way: In the construction of $B_{dpq}$ in \cref{sec:construction}, we defined $B_{dpq}$ as the quotient of $M_P$ under the free action of $G_p$. As a algebraic hypersurface $M_P$ naturally inherits the complex structure of $ℂ³$, and we use $J$ to denote this structure on $M_P$ as well as on its quotient $B_{dpq}$.

\begin{definition}
  Let $(M,J)$ be a almost complex manifold.
  A (smooth) function $f\colon (M,J) → ℂ$ is weakly plurisubharmonic if
  \[-d d^ℂ f = -d(d f ∘ J) ≥ 0 \;.\]
\end{definition}

The first component of $\symbf{H}$ in \ref{eqn:non-toric-system}, is a weakly plurisubharmonic function on $ℂ³$, as $-d d^ℂ \symbf{H}₁ = 2 d{x_3} ∧ d{y_3} ≥ 0$. As $M_P$ is an algebraic hypersurface, this restricts to a plurisubharmonic function on $M_P$, and also descends to the quotient $B_{dpq}$ as a plurisubharmonic function.

In particular, any $J$-holomorphic curve $u\colon Σ → B_{dpq}$ satisfies the maximum principle with respect to $\symbf{H}₁$, i.e.\ if $\symbf{H}₁ ∘ u$ has a maximum, it must be on $∂Σ$, and if $\symbf{H}₁ ∘ u$ is non-zero then it must be constant.\footnote{The latter is obtained by applying the maximum principle to $\frac{1}{\symbf{H}₁ ∘ u}$.}

\subsection{Non-Embedded lower bound}

Let $b = (b₁,b₂) ∈ \im(\symbf{H})$ and set $T = \symbf{H}^{-1}(b)$. Let $u \colon (Σ,∂Σ) → (B_{dpq},T)$ be a $J$-holomorphic curve. We have $\symbf{H}₁ ∘ u ≤ b₁$ by the maximum principle, thus $u$ is entirely contained in the region $\symbf{H}^{-1}(\qty{\symbf{H}₁ ≤ b₁})$. If we have $b₁ ≤ \symbf{H}₁(aᵢ)$, for all $1≤i≤d$, where the $a_i$ are the zeros of $P$ as in \cref{sec:homology}, then this region is homotopic to a solid torus.

Since the homology of $(\symbf{H}^{-1}(\qty{\symbf{H}_1 ≤ b_1}), T)$ is isomorphic to $ℤ$ and generated by $D₀$ as in \cref{sec:homology}, and the area of a $J$-disc rel $T$ only depends on its homology class, we have that
\[σ_D(X,T,J) ≥ ∫_{D₀} ω  = μ₁(T)\]

Since $B_{dpq}$ contains no $J$-holomorphic spheres,\footnote{As seen in \cref{sec:homology} the homology of $B_{dpq}$ is generated by Lagrangian spheres, thus any closed $J$-holomorphic curve has symplectic area $0$ and must be constant.} we have proven the following:

\begin{lemma}
  \label{thm:lower_bound_tmp}
  If $b₁ < \symbf{H}₁(aᵢ)$ for all $1 ≤ i ≤ d$, then
  \[e(B_{dpq},T) ≥ σ_D(X,T,J) ≥ ∫_{D₀} ω  = μ₁(T) \; .\]
\end{lemma}

Actually, since we are free to choose another almost complex structure, we can improve this result: 
Using a nodal slide on the moment image $μ$ as in \cref{thm:nodal_slide} we may construct a symplectomorphism $B_{P_1,q} → B_{P_2,q}$ which is a fibre-wise outside a neighbourhood of the line $\symbf{H}^{P_k,q}_2=0$, where $P_k$ are two polynomials each with $d$ distinct roots of multiplicity $p$.
For a torus $\symbf{H}^{-1}(b)$ with $b_2 ≠ 0$ we may therefore always change to a different polynomial $P_2$ where $b_1 < \symbf{H}_1(a_i)$, and choose the pullback of the natural almost complex structure of $B_{P_2,q}$. So we obtain:

\begin{lemma}
  \label{thm:lower_bound_old}
  If $b_2 ≠ 0$ then $e(B_{dpq},T) ≥ σ_D(X,T,J) ≥ μ₁(T)$.
\end{lemma}

\subsection{Embedded lower bound}



\begin{definition}
A \textbf{milnor fibre}
of $B_{dpq}$ is a open subset $U$ containing $\symbf{H}^{-1}(ℓ)$, where $ℓ = [0,\symbf{H}(a_d)] × \{0\}$. \end{definition}

\begin{remark}
  This definition is a bit unusual but equivalent to the usual one.
\end{remark}

\begin{proposition}
  \label{thm:lower_bound_embedded}
  Let $φ:B_{dpq} ⊃ U → (X,ω)$ an embedding of a milnor fibre of $B_{dpq}$ into a tame symplectic manifold.

  Then there exists an $ε>0$, such that there exists a neighbourhood $V$ of $[0,ε) × \{0\} ⊂ \im{\symbf{H}}$ such that for all $b ∈ V$ with $b_2 ≠ 0$ we have $e(φ(T(b)),X) ≥ μ_1(T(b))$.
\end{proposition}

\begin{proof}
  Choose a smaller open neighbourhood $\symbf{H}^{-1}(ℓ) ⊂ U' ⊂ U$ such that $d(∂U',∂U) = s > 0$ and $U' = \symbf{H}^{-1}(V')$ for some open subset $V' ⊂ \im(\symbf{H})$ (this is possible since $\symbf{H}$ is an open map).
  Let $J$ be the natural almost complex structure on $B_{dqp}$ as in \cref{thm:lower_bound_tmp}, and $\hat{J}$ an extension of $φ_* J$ to all of $X$.


  The moment map $μ$ is given by $μ =  τ ∘ \symbf{H}$ for some diffeomorphism $τ$ defined on the complement of the branch cut line. Set $δ = \min\qty{σ_S(X,\hat{J}), \frac{Cs²}{4}}$, and set $V = V' ∩ τ^{-1}(μ_1 < δ)$.

  Let $b ∈ V$ with $b_2 ≠ 0$ and $u \colon (Σ,∂Σ) → (X,φ(T(b)))$ be a $\hat{J}$-holomorphic disk.
  If $u$ is contained in $U$, then $φ^{-1} ∘ u$ is a $J$-holomorphic disk in $B_{dpq}$ and $∫_{φ^{-1}u} ω ≥ σ_D(B_{dpq},T(b),J) ≥ e(T(b)) = μ_1(T(b)) = τ(b)$ by \cref{thm:lower_bound}.
  If not, then $u$ crosses the region $U ∖ U'$, so we can apply \cref{thm:small_buffer}, to get that $∫_u ω ≥ \frac{Cs²}{4} ≥ δ > μ_1(T(b))$.

  Since by choice of $δ$ we also have $σ_S(X,\hat{J}) ≥ μ_1(T(b))$, we can apply \cref{thm:chekanov} we get the desired result.
\end{proof}


\section{Upper bound on displacement energy: Probes}
\label{sec:upper_bound}

To calculate an upper bound on the displacement energy of a toric fibre $T(x)$ of the almost toric fibration $\mu \colon B_{dpq}\to \mathbb{R}^2$, we can explicitly construct a Hamiltonian symplectomorphism that displaces the toric fibre from itself.
By the definition of the displacement energy this yields an upper bound on the displacement energy of $T(b)$.

For this we want to use probes, first introduced by McDuff \cite{mcduff2011displacing}. We refer the reader there for the definitions and statements (mainly \cite[Definition 2.3, Lemma 2.4]{mcduff2011displacing}).


\begin{lemma}
    \label{thm:upper_bound}
    Assume that $\mu \colon B_{dpq} \to \mathbb{R}^2$ is the moment map associated to the almost toric fibration defined on $B_{dpq}$ as described in $\cref{thm:bdpq_moment_map}$. 
    Then, for a toric fibre $T(x)=\mu^{-1}(x)$, such that $x \in \mathbb{R}^2$ does not lie on the branch cut line, the displacement energy can be estimated from above by
    \[ e(B_{dpq},T(x))\leq x_1 = μ_1(T(x)). \]
\end{lemma}


\begin{proof}
  Fix $T(x)$ as in the statement.
  
By \cref{thm:nodal_slide}, we can change the almost toric fibration in a neighbourhood containing the branch cut $ℓ$, and not containing $T(x)$, such that the horizontal line $P$ containing $x$ does not intersect\footnote{If $q=0$ (that means $p=1$) this may not work if $x_2=0$. In this case we may apply an integral shear to go to the case $q=1$.} $ℓ$.

Removing $μ^{-1}(ℓ)$ we find ourselves in a toric fibration, where $P$ is an infinitely long probe. Now \cite[Lemma 2.4]{mcduff2011displacing} gives a Hamiltonian symplectomorphism with Hofer norm $x_1 = μ_1(T(x))$.
\end{proof}

\begin{proposition}
\label{thm:upper_bound_embedded}
  Let $φ:B_{dpq} ⊃ U → (X,ω)$ be an embedding of a milnor fibre of $B_{dpq}$ into a symplectic manifold.
  Then there exists an $ε>0$, such that there exists a neighbourhood $V$ of $[0,ε) × \{0\} ⊂ \im{\symbf{H}}$ such that for all $b ∈ V$ with $b_2 ≠ 0$ we have $e(φ(T(b)),X) \leq μ_1(T(b))$.
\end{proposition}

\begin{proof}
    This is essentially the same as \cref{thm:upper_bound}, but the probe will no longer be infinitely long, so we only get a finite probes.
    We may assume that for probes sufficiently close to $x_2=0$, they are at least $2δ$ long, so all fibres $T(x)$ with $x_2$ sufficiently small and $x_1<δ$ can be displaced with energy $μ_1(T(x))$.

    Now applying the diffemorphism $τ^{-1}$, we get the result.
\end{proof}

\section{Versal Deformations \& Nearby Lagrangians}

Let $L_0 ⊂ (X,ω)$ be a compact Lagrangian, and $\overline{\symcal{L}}$ the space of Lagrangians in $X$ equipped with the $\symcal{C}^1$-topology.

\begin{definition}
  A \textbf{Lagrangian isotopy} is a map $\Lambda \colon [0,1] \rightarrow \symcal{L}, t \mapsto \Lambda_t$ with $\Lambda_0 = L_0$ s.t.\ there is a smooth map $[0,1] \times L_0 \rightarrow X$ which maps $\{t\} \times L$ to $\Lambda_t$.

  Note that we can always find a smooth isotopy $φ_t \colon X → X$ s.t.\ $φ_t(L_0) = Λ_t$. We say that \textbf{$Λ$ is generated by $φ$}.
\end{definition}

By $\symcal{L}_{L_0} ⊂ \overline{\symcal{L}}$ (or simply $\symcal{L}$), denote the set of Lagrangians which are Lagrangian isotopic to $L_0$.
See \cite{ono2008LagrangianFlux} for more details on the $\symcal{C}^1$-topology on the space of Lagrangians.
Denote by $\tilde{\symcal{L}}$ the universal cover of $\symcal{L}$, that is the space of Lagrangian isotopies of $L_0$ up to endpoint preserving isotopies. Using Weinstein's Lagrangian neighbourhood theorem, one can check that $\symcal{L}$ is locally simply connected, showing that $\tilde{\symcal{L}} \rightarrow \symcal{L}$ is indeed the universal cover.

\begin{definition}
  \label{def:flux_map}
  Let $Λ \colon ([0,1],0) → (\symcal{L},L_0)$ be a Lagrangian isotopy. Its \textbf{(Lagrangian) flux} is the map
$$    H_1(L_0) → ℝ, \quad    ξ ↦  ∫_{C_ξ} ω, $$
where $C_ξ$ is the cylinder obtained by sliding a representative of $ξ$ in $L_0$ along the Lagrangian isotopy (called a \textbf{flux cylinder of $ξ$ over $Λ$}).
  This map is well defined (independent of the choice of $C_ξ$) and also independent by end point preserving isotopies of $Λ$.\footnote{If $C_ξ ≅ C_ξ'$ by homotopy $H$, $0=∫_{∂H} ω = ∫_{C_ξ} ω - ∫_{C_ξ'} ω + ∫_A ω + ∫_B ω$, with $A,B$ contained in the endpoints of the isotopy, which are Lagrangian.}

  Using $\Hom(H_1(L_0),ℝ) = H^1(L_0;ℝ)$ this gives a well defined map
  \[ \Flux \colon \tilde{\symcal{L}} → H^1(L_0;ℝ) \; ,\]
  called the \textbf{flux map}.
\end{definition}

\begin{lemma}
  \label{thm:hamiltonian_flux}
  A Lagrangian isotopy $Λ$ is generated by a Hamiltonian isotopy, iff $∀t ∈ [0,1], \Flux(Λ_s|_{s ∈ [0,t]}) = 0$.
\end{lemma}
\begin{proof}
  Let $γ(θ), θ ∈ S¹$ be a parametrisation of a 1-cycle with $[\gamma] = \xi$ in $L_0$, $φ_t \colon X → X$ a smooth isotopy generating $Λ$, $X_t$ a Vector field generating the isotopy $φ_t$, and $φ_t(γ(θ))$ a parametrisation of the flux cylinder $C_γ$ over $Λ_t$ as in \cref{def:flux_map}.
  \[ ∂_t \langle \Flux(Λ_s|_{s ∈ [0,t]}) , \xi \rangle = ∂_t ∫_0^t ∫_{φ_s ∘ γ} ι_{∂_s φ_s} ω ds = ∫_{φ_t ∘ γ} ι_{∂_t φ_t} ω
  = ∫_{φ_t ∘ γ} ι_{X_t ∘ φ_t} ω = ∫_γ φ_t^* ι_{X_t ∘ φ_t} ω.\]

  Now if $X_t$ is generated by a Hamiltonian $H_t$, the last integral is equal to
  \[ ∫_γ φ_t^* dH_t = ∫_{∂γ} φ_t^* H_t = 0.\]

  If the last integral is zero for all $γ$, the restriction of the 1-form $φ_t^* ι_{X_t ∘ φ_t} ω$ to $Ω^1(L_0)$ is exact, so we find primitives $\tilde{H}_t$ defined on $L_0$. $H_t = \tilde{H}_t ∘ φ_{-t}$ can then be extended smoothly to $X$ and $φ_t^* ι_{X_t ∘ φ_t} ω = φ_t^* d H_t$.
\end{proof}

Let $\mathcal{V} \subset \mathcal{L}$ be a simply-connected neighbourhood of $L_0$. Then we define the local flux map on $\mathcal{V}$ by setting 
\[
    \label{eq:localflux}
    \Flux_{\mathcal{V}} = \Flux \vert_{\mathcal{V_0}}, 
\]
by identifying $\symcal{V}$ with its lift $\symcal{V_0} ⊂ \tilde{\mathcal{L}}$ containing the constant loop at $L_0$.



\subsection{\texorpdfstring{$T^* L_0$}{T*L} and Graphs of 1-Forms} 

Let us look at the case $(X,ω)=(T^* L_0,d λ)$ with $L_0 ⊂ T^* L_0$ the zero section and $λ$ the tautological 1-form. We have the following statements:

\begin{lemma}
  \label{thm:graph_lagrangian}
  For any $α ∈ Ω^1(L_0)$, the graph $Γ_α$ of $α$ is Lagrangian iff $d α=0$.
\end{lemma}
\begin{proof}
  We have the embedding $α \colon L_0 → Γ_α ⊂ T^* L_0$. $Γ_α$ is Lagrangian iff $0 = α^* d λ = d α^* λ = d α = 0$. (The property $α^* λ = α$ characterizes the tautological 1-form.)
\end{proof}

\begin{lemma}
  \label{thm:graph_flux}
  Let $α ∈ Ω^1(L_0)$ closed and $Λ_t$ be a Lagrangian isotopy from the zero section $L_0$ to the graph $Γ_α$ of $α$. Then $\Flux(Λ_t) = [α]$.
\end{lemma}
\begin{proof}
  Let $ξ$ be some 1-cycle in $L_0$, $C_ξ$ the flux cylinder over $Λ$. Then $∂C_ξ = α ∘ ξ - ξ$.  Now
  \[⟨\Flux(Λ_t),ξ ⟩ = ∫_{C_ξ} dλ = ∫_{∂C_ξ} λ = ∫_{α ∘ ξ}λ - ∫_{ξ} λ = ∫_{ξ} α^* λ = ∫_{ξ} α = ⟨α,ξ⟩ .\]
\end{proof}

\begin{lemma}
  \label{thm:graph_hamiltonian_isotopic}
  Let $\alpha,\beta \in  \Omega^1(L_0)$ be closed $1$-forms. Their graphs $\Gamma_{\alpha}, \Gamma_{\beta}$ are Hamiltonian isotopic iff $[\alpha] = [\beta]$.
\end{lemma}
\begin{proof}
If $[\alpha] = [\beta]$, the linear isotopy $\Lambda_t = Γ_{(1-t)α + t β}$ is a Lagrangian isotopy with $\Flux(Λ_s|_{s ∈ [0,t]}) = 0$ for all $t \in [0,1]$. Therefore $\Lambda$ is generated by a Hamiltonian isotopy by \cref{thm:hamiltonian_flux}.

  If $Γ_α ≅ Γ_β$, then we can extend a Lagrangian isotopy from $0$ to $α$ (e.g. $Γ_{tα}$) by the Hamiltonian isotopy from $Γ_α$ to $Γ_β$ to get $Λ_t$. By \cref{thm:hamiltonian_flux} adding the Hamiltonian part does not change the flux map, so $[α] = \Flux(Λ_t) = [β]$, by \cref{thm:graph_flux}.
\end{proof}

Recall that $\symcal{L}$ denotes the space of Lagrangians isotopic to $L_0$ (here it is the zero-section $L_0 \subset T^*L_0$).
Let $\symcal{L}_Γ ⊂ \symcal{L}$ be the subspace of graphs of closed 1-forms.
Recall also that, a priori, the flux map is defined on the universal cover of $\symcal{L}$.

\begin{corollary}
  \label{thm:cotangent_classification}
  The subspace $\symcal{L}_Γ$ contains a neighbourhood of $L_0 \in \symcal{L}$ (by the definition of the $\symcal{C}^1$-topology) and $\Flux$ yields a well-defined (by \cref{thm:graph_flux}) map
\[ \Flux_Γ \colon \symcal{L}_Γ → H^1(L_0;ℝ), \]
which classifies elements in $\symcal{L}_Γ$ up to Hamiltonian isotopy (by \cref{thm:graph_hamiltonian_isotopic}).
\footnote{In fact Ono \cite[Proposition 2.3]{ono2008LagrangianFlux} allows to replace $\symcal{L}_Γ$ by $\symcal{L}$ in this statement in the case of the cotangent bundle. We do not need this stronger statement.}
\end{corollary}

\subsection{Versal deformations}
\label{sec:versal_deformations}

Let us return to the case of a general $(X,\omega)$.
Then $L_0$ admits an embedding of a Weinstein-neighbourhood $φ: T^*L_0 \dashrightarrow X$ \footnote{The $\dashrightarrow$ notes that the map is only defined near the zero-section.}, meaning that we can hope to prove a local result analogous to \cref{thm:cotangent_classification}. Since its proof relied on a linear interpolation of $1$-forms, we introduce the following notion.

\begin{definition}
    A neighbourhood $\mathcal{U} \subset \mathcal{L}$ of $L_0$ is called \textbf{Weinstein convex} (\textbf{W-convex}) if there is a Weinstein chart $φ: T^*L_0 \dashrightarrow X$ of $L_0$ such that every $L ∈ \symcal{U}$ can be written as $φ(Γ_α)$ for some closed 1-form $α ∈ Ω¹(L_0)$, and $\symcal{U}$ is convex with respect to the linear structure inherited from $Ω^1(L_0)$.
    Such a pair $(\symcal{U},φ)$ is called \textbf{Weinstein convex pair} (\textbf{W-convex pair})
\end{definition}

By the definition of the $C^1$-topology on $\mathcal{L}$, every neighbourhood of $L_0$ in $\mathcal{L}$ contains a W-convex neighbourhood.
Note that W-convex sets are simply connected, hence the local Flux map \eqref{eq:localflux} makes sense on them.

\begin{proposition}
  \label{thm:local_classification}
  Let $\symcal{U}$ be W-convex.
  The map $\Flux_{\symcal{U}}$ classifies $\symcal{U}$ up to Hamiltonian isotopies contained in $\symcal{U}$.
  By this we mean that any $L, L' \in \mathcal{U}$ are Hamiltonian isotopic by a Hamiltonian isotopy through $\symcal{U}$ iff $\Flux_{\symcal{U}}(L) = \Flux_{\symcal{U}}(L')$.
\end{proposition}
\begin{proof}
  This is essentially \cref{thm:cotangent_classification}. The fact that $\symcal{U}$ is convex guarantees that the linear Hamiltonian isotopy of \cref{thm:graph_hamiltonian_isotopic} between $L_1 ≅ L_2 ∈ \symcal{U}$ exists.
\end{proof}

A versal deformation is essentially a continuous "local section of the flux map":

\begin{definition}
  \label{def:versal_deformation}
  A continuous map $v_{L_0} \colon H^1(L_0;ℝ) \dashrightarrow \symcal{L}$, \footnote{The $\dashrightarrow$ denotes that it is only defined on some neighbourhood of $0$} is called \textbf{versal deformation of $L_0$} if for every simply connected neighbourhood $\symcal{U} ⊂ \symcal{L}$ of $L_0$ there exists an open neighbourhood $V$ of $0 ∈ H^1(L_0;ℝ)$ with $\Flux_{\symcal{U}} ∘ v_{L_0}|_V = \id$.
\end{definition}

By continuity of $v_{L_0}$, the neighbourhood $V$ can be chosen small enough for $v_{L_0}(V)$ to be contained in $\mathcal{U}$. Therefore, this definition makes sense.

\begin{remark}
  \label{rem:lazy_vd}
  It is sufficient that the condition in \cref{def:versal_deformation} is satisfied for one simply connected neighbourhood $\symcal{U} ⊂ \symcal{L}$:
  If $\symcal{V}$ is any other simply connected neighbourhood of $L_0$, then, since $\symcal{L}$ is locally simply connected, there is a simply connected neighbourhood $\symcal{W} ⊂ \symcal{U} ∩ \symcal{V}$, and, since $v_{L_0}$ is continuous, restricting $V$ appropriately gives the result.
\end{remark}

\begin{lemma}
  \label{thm:vd_existence}
  A versal deformation exists.
\end{lemma}
\begin{proof}
  Let $(\symcal{U},φ)$ be a Weinstein convex pair of $L_0$ and $α_1,…,α_d ∈ Ω_1(L_0)$ be a set of closed $1$-forms inducing a basis of $H¹(L_0;ℝ)$. Set 
  \[
        v_{L_0}(b) = \varphi( \Gamma_{b_1[\alpha_1] + \ldots + b_d[\alpha_d]} ), \quad
        b = \sum_{i=1}^d b_i [\alpha_i] \in H^1(L_0; \mathbb{R}),
  \]
  where we have chosen a small enough domain for this definition to make sense.

  Now $\symcal{U}$ is simply connected, and by \cref{thm:graph_flux} $\Flux_{ \symcal{U}} ∘ v_{L_0} = \id$.
  So by \cref{rem:lazy_vd}, $v_{L_0}$ is a versal deformation.
\end{proof}

\begin{lemma}
  \label{thm:vd_hamiltonian_isotopy}
  If $v_{L_0}, v_{L_0}'$ are two versal deformations, there is a neighbourhood $V ∈ H^1(L_0;ℝ)$ of $0$, s.t.\ $∀ α ∈ V, v_{L_0}(α) ≅ v_{L_0}'(α)$.
\end{lemma}
\begin{proof}
  Let $\symcal{U}$ be simply connected and $V$ such that $\Flux_{ \symcal{U}} ∘ v_{L_0}|_V = \Flux_{ \symcal{U}} ∘ v_{L_0}'|_V = \id$.
  Additionally restricting $V$ we may also assume that $\symcal{U}$ is also W-convex.
  Then for $α ∈ V$, by \cref{thm:local_classification} the result follows since $\Flux_{ \symcal{U}}(v_{L_0}(α)) = \Flux_{ \symcal{U}}(v_{L_0}'(α))$.
\end{proof}

We might say colloquially that a versal deformations parametrizes all nearby Lagrangians by a neighbourhood of zero in $H^1(L_0;ℝ)$ up to local Hamiltonian isotopy.

As a reminder: $\overline{\symcal{L}}$ is the total space of Lagrangians, $\symcal{L}$ the path-connected component containing $L_0$.

\begin{definition}
  \label{def:invariant_germs}
  Suppose $I \colon \overline{\symcal{L}} → A$ is some invariant of Lagrangians up to (Hamiltonian) symplectomorphism, and $v_{L_0}$ a versal deformation. Then the germ of $I ∘ v_{L_0}$ at $0 ∈ H^1(L_0;ℝ)$ is independent of the choice of versal deformation (by \cref{thm:vd_hamiltonian_isotopy}), and is called (by abuse of terminology) the \textbf{germ of $I$ at $L_0$} and denoted by
  \[
    [I]_{L_0} \colon H^1(L_0;ℝ) \dashrightarrow A \; .
  \]
\end{definition}

\begin{proposition}
  \label{thm:invariant_germs}
  If $φ$ is a (Hamiltonian) symplectomorphism, then
  \[
    [I]_{φ(L_0)} = [I]_{L_0} ∘ φ^* \; ,
  \]
  where $φ^*$ denotes the induced map on cohomology.

  So if there is no isomorphism $M \colon H^1(L;ℤ) → H^1(L';ℤ)$ s.t.\ $[I]_L ∘ M = [I]_{L'}$ there is no (Hamiltonian) symplectomorphism $φ$ with $φ(L) = L'$.
\end{proposition}

\begin{proof}
  Let $v$ be a versal deformation of $L_0$.
  Then $v_φ = φ ∘ v ∘ φ^*$ is a versal deformation of $φ(L_0)$.
  We have the following commutative diagram:
  \[\begin{tikzcd}[column sep=tiny]
  H^1(L_0;ℝ) \dar{v} & & H^1(φ(L_0);ℝ) \dar{v_φ} \ar[ll, swap, "φ^*"] \\
  \overline{\symcal{L}} \ar[rr, "φ"] \ar[dr, swap, "I"] & & \overline{\symcal{L}} \ar[dl, "I"] \\
                                     & A &
    \end{tikzcd}\]
  where the top square commutes by definition of $v_φ$, and the bottom triangle commutes since $I$ is invariant under (Hamiltonian) symplectomorphism.
\end{proof}

\subsection{Versal Deformations of Arnold-Liouville tori}
\label{sec:vd_AL}

Let $\symbf{H} \colon X \rightarrow B$ be a Lagrangian torus fibration as defined in \cite{evans2021atfs} and denote by $B_0 \subset B$ its regular locus. For every $b \in B_0$, the corresponding fibre $L_b = \pi^{-1}(b)$ is a Lagrangian torus, called \emph{Arnold--Liouville torus}. Since the base $B$ is $n$-dimensional, a natural candidate for a versal deformation of $L_b$ is picking nearby fibres of $\symbf{H}$. Indeed, we will see that neighbouring fibres, when parametrized by their Lagrangian flux, yield a versal deformation. 
\ref{}
Let $L_{b_0} = \pi^{-1}(b_0) \subset X$ be an Arnold--Liouville torus and let $\mathcal{U} \subset \mathcal{L}$ be a simply connected neighbourhood of $L_{b_0}$. Choose $V \subset B_0$ small enough so that $L_b \in \mathcal{U}$ for every $b \in V$. Then we can define the map $τ_V \colon V \rightarrow H^1(L_{b_0};\mathbb{R})$ by $b \mapsto \Flux_{\mathcal{U}}(L_b)$. For a small enough $V$, this is a diffeomorphism onto its image, see the proof of \cref{thm:ltfVD}. Now define
\begin{equation}
    \label{eq:ltfVD}
    v_{L_b} \colon H^1(L_b;\mathbb{R}) \dashrightarrow \mathcal{L}, \quad
    v_{L_b}(a) = L_{τ_V^{-1}(a)}.
\end{equation}
By definition we have $\Flux_{\mathcal{U}} \circ v_{L_b} = \id$, and thus by \cref{rem:lazy_vd}, we obtain the following. 

\begin{proposition}
    \label{thm:ltfVD}
    The map \eqref{eq:ltfVD} is a versal deformation. 
\end{proposition}

\begin{proof}
    It is left to show that the map $τ_V$ is a local diffeomorphism.
    Let $Y \in T_{b_0}B$ and $\gamma \colon [0,1] \rightarrow V$ a curve with $\gamma(0) = b_0$ and $\dot{\gamma}(0) = Y$.
    Then 
    \[
        \label{eq:Dphi}
        Dτ_V(b_0) Y = \partial_t\vert_{t = 0} \Flux (\Lambda_s\vert_{s \in [0,t]}),
    \]
    where $\Lambda_s = \mathbf{H}^{-1}(\gamma(s))$.
    As in the proof of \cref{thm:hamiltonian_flux}, we find that $Dτ_V(b_0) Y = [\iota_{\overline{Y}}\omega \vert_{L_{b_0}}] \in H^1(L_{b_0};\mathbb{R})$, where $\overline{Y} = \partial_t \vert_{t=0} \Lambda_t \in \Gamma(TX\vert_{L_{b_0}} \rightarrow L_{b_0})$ is a vector field generating $\Lambda_s$, i.e.\ satisfying $D\mathbf{H}\vert_x \overline{Y} = Y$ for every $x \in L_{b_0}$.
    If $Dτ_V(b_0) Y = 0$, then there is $f \in C^{\infty}(L_{b_0})$ with $df = \iota_{\overline{Y}}\omega \vert_{L_{b_0}}$.
    Let $x_0 \in \Crit(f)$ (this set is not empty), then $\overline{Y}_{x_0} = 0$.
    Since $D\mathbf{H} \vert_{x_0} \overline{Y}_{x_0} = Y$, this implies that $Y = 0$.
    This proves that $Dτ_V(b_0)$ is injective and thus bijective. 
\end{proof}

Any identification $H_1(L_{b_0};\mathbb{Z}) \cong \mathbb{Z}^n$ (which is unique up to an element of $\GL(n;ℤ)$) induces a dual identification $H^1(L_{b_0};\mathbb{R}) \cong \mathbb{R}^n$.
Equipped with charts of the form $τ_V$, the set $B_0$ inherits the structure of an integral affine manifold.
Furthermore, every map $τ_V \circ \mathbf{H}\vert_{\mathbf{H}^{-1}(V)} \colon \mathbf{H}^{-1}(V) \rightarrow \mathbb{R}^n$ yields action coordinates of a completely integrable system, see \cite[Lemma 2.15]{evans2021atfs}.
Equivalently $τ_V \circ \mathbf{H}\vert_{\mathbf{H}^{-1}(V)}$ is the moment map of a Hamiltonian $T^n$-action. Using a $T^n$-equivariant Weinstein chart of the orbit $L_{b_0}$, one can check directly that any moment map of a Hamiltonian $T^n$-action yields a canonical versal deformation by taking its fibres.

In order to formulate this precisely, we introduce the following model. Let $T^*T^n \cong T^n \times \mathbb{R}^n$ be equipped with the standard symplectic form $\sum_{i=1}^n d\theta_i \wedge db_i$ and let $\mu_0 \colon T^*T^n = T^n \times \mathbb{R}^n \rightarrow \mathbb{R}^n$ be the natural projection. The map $\mu_0$ generates the standard Hamiltonian $T^n$-action on $T^*T^n$ given by rotation in the $T^n$-component. This action restricts to any set of the form $\mu_0^{-1}(A)$ for $A \subset \mathbb{R}^n$. Giving a symplectomorphism from $(X,\omega)$ to $\mu_0^{-1}(A)$ is equivalent to fixing action-angle coordinates on $X$. 

\begin{proposition}
    \label{thm:flux_moment_map}
    Let $V \subset B_0$ be simply connected. Then 
    \[
        \mu_V = τ_V \circ \mathbf{H} \colon \mathbf{H}^{-1}(V) \rightarrow H^1(L_{b_0};\mathbb{R}) \cong \mathbb{R}^n
    \]
    generates a Hamiltonian $T^n$-action. If, additionally its image $\Omega = \im \mu_V = \im τ_V \subset \mathbb{R}^n$ is simply connected, then there is a symplectomorphism $\psi \colon \mathbf{H}^{-1}(V) \rightarrow \mu_0^{-1}(\Omega)$ with $\mu_V = \mu_0 \circ \psi$. In other words, the symplectomorphism is $T^n$-equivariant with respect to the standard Hamiltonian $T^n$-action on $\mu_0^{-1}(\Omega)$.
\end{proposition}

\section{Proof of Main Theorem}

Combining the "non-embedded" upper and lower bounds of \cref{thm:lower_bound} and \cref{thm:upper_bound}, we immediately get:

\begin{theorem}
  \label{thm:displacement_energy}
  Let $b=(b_1,b_2) ∈ \im(\symbf{H})$ with $b_2 ≠ 0$. Then $e(\symbf{H}^{-1}(b)) = μ_1(\symbf{H}^{-1}(b)) = τ_1(b)$.
\end{theorem}

Combining the "embedded" upper and lower bounds of \cref{thm:lower_bound_embedded} and \cref{thm:upper_bound_embedded} we get:

\begin{theorem}
  \label{thm:displacement_energy_embedded}
  Let $φ \colon B_{dpq} ⊃ U → (X,ω)$ be an embedding of a milnor fibre of $B_{dpq}$ into a geometrically bounded symplectic manifold. Then there is a neighbourhood $V$ of $[0,ε) × \{0\}$ such that for $b = (b_1,b_2) ∈ V$ with $b_2 ≠ 0$ we have $e(\symbf{H}^{-1}(b)) = μ_1(\symbf{H}^{-1}(b)) = τ_1(b)$.
\end{theorem}

\begin{figure}
  \centering
  \missingfigure{$T_{kpq}$ definition}
  \caption{$T_{kpq}$}
  \label{fig:tkpq_def}
\end{figure}

\begin{definition}
  Let $0 ≤ k ≤ d$ and $a>0$.
  Using nodal slides to modify $μ$, arrange it such that the line $μ_1 = a$ separates the $k$-th and the $(k+1)$-th nodes as in \cref{fig:tkpq_def}.
  Then set $T_{k,p,q}(a) = μ^{-1}(a,\frac{aq}{p})$.
\end{definition}

\begin{theorem}
  \label{thm:main}

  For $x ∈ H^1(T_{kpq}(a); ℝ)$, the displacement energy germ at $T_{kpq}(a)$ is given by
  \[ [e]_{T_{kpq}(a)} (x) \sim a + \min\qty{x_1, x_1 (1-kpq) + x_2 k p^2} \; , \]
  for some identification of $H^1(T_{kpq}(a);ℝ)$ with $ℝ²$.
  In particular, there is no symplectomorphism mapping $T_{kpq}(a)$ to $T_{k'p'q'}(a')$ if $(k,p,q,a) ≠ (k',p',q',a')$ (where equality in the $q$-coordinate is mod $p$).

  If $φ \colon B_{dpq} ⊃ U → (X,ω)$ is an embedding of a Milnor fibre into a geometrically bounded symplectic manifold, and $a<ε$ as given by \cref{thm:displacement_energy_embedded}, then the same expression holds for the displacement energy germ at $φ(T_{kpq}(a))$.
\end{theorem}

\begin{figure}
  \centering
  \missingfigure{modified moment map}
  \caption{Modifiying the moment map $μ$.}
  \label{fig:mod_moment_map}
\end{figure}

\begin{proof}
  The proof of the embedded and non-embedded part are essentially the same. For simplicity we only give the non-embedded part.

  Change the branch cuts of $μ$ such that $T_{kpq}$ does not lie on a branch cut, giving a new moment map $\hat{μ}$ as in \cref{fig:mod_moment_map},
  giving the relation
  \begin{equation}
    \label{eq:mu_muhat_rel}
    \hat{μ}(z) = \begin{cases}
      μ(z) & \text{if $μ(z)$ lies above the eigenline of $A$}\\
      A μ(z) & \text{if $μ(z)$ lies below the eigenline of $A$}
    \end{cases}
  \end{equation}
  where $A$ is given as the shear matrix
  \[\mqty(kpq+1 & -kp²\\ kq² & 1-kpq) = \qty(x ↦ x+k\det\mqty(x_1 & p\\ x_2 & q)(p,q)).\]

Like in \cref{sec:vd_action_angle}, let $b_0 = \hat{μ}(T_{kpq}(a)) = (a,aq/p)$, $B$ a simply connected neighbourhood of $b_0$, $\symcal{B} = \hat{μ}^{-1}(B) ⊂ \symcal{L}_{T_{kpq}}$, $i \colon H¹(T_{kpq};ℝ) → ℝ^2$ the identification given by the action angle coordinates of $\hat{μ}$ and choose the versal deformation $v_{\hat{μ}}$ of $T_{kpq}(a)$ as in \cref{thm:moment_map_flux} such that for $x ∈ H¹(T_{kpq};ℝ)$
  \[
    \hat{μ}(v_{ \hat{μ}}(x)) = i(\Flux_{ \symcal{B}}(v_{ \hat{μ}}(x))) = b_0 + i(x) \; .
  \]
  Then we know from \cref{thm:displacement_energy} (resp. \cref{thm:displacement_energy_embedded}) that for $v_{ \hat{μ}}(x)$ not on the eigenline of the nodes, $e(v_{ \hat{μ}}(x)) = μ_1(v_{ \hat{μ}}(x))$.

  Applying \eqref{eq:mu_muhat_rel} and setting $i(x) = (x_1,x_2)$, we get
  \[e(v_{ \hat{μ}}(x)) = \begin{cases}
    μ_1(v_{ \hat{μ}}(x)) = a + x_1 & \text{$x$ lies above the eigenline of $A$}\\
    A μ_1(v_{ \hat{μ}}(x)) = a + x_1(kpq+1) - x_2kp² & \text{$x$ lies below the eigenline of $A$}\\
    \text{unknown} & \text{$x$ lies on the eigenline of $A$}
  \end{cases}\]

  Now we have that $kp⟨i(x),(q,-p)⟩ = x_1 kpq - x_2 kp^2 > 0$ iff $x$ lies above the eigenline of $A$, so we get
  \[e(v(x)) = \begin{cases}
    a + \min\qty{x_1,x_1(kpq+1) - x_2kp²} & \text{$x$ doesn't lie on the eigenline of $A$}\\
    \text{unknown} & \text{$x$ lies on the eigenline of $A$}\\
  \end{cases}\]

  The fact that no symplectomorphism between two different $T_{kpq}(a), T_{k'p'q'}(a')$ exists follows now from \cref{thm:invariant_germs}.
\end{proof}
\end{document}
