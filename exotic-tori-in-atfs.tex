% vim: spelllang=en_gb

\documentclass[12pt,a4paper,abstract=true,final]{scrartcl}
\usepackage{ifdraft}

% --------------------
% Set Language Options
% --------------------

\usepackage[nswissgerman,french,main=english]{babel}
\usepackage[autostyle,english=american,german=swiss]{csquotes}
\MakeOuterQuote{"}

\usepackage[shortcuts]{extdash}

% --------------
% Font & Symbols
% --------------

\usepackage{amssymb,mathtools}
\usepackage[warnings-off={mathtools-colon,mathtools-overbracket}]{unicode-math}
\usepackage[oldstyle,proportional]{libertinus-otf}

% ---------------
% Set Page Layout
% ---------------

% Get length of 65 characters
%\setlxvchars

\usepackage[driver=auto]{geometry}
% A5: 148mm × 210mm
% A4: 210mm × 297mm
\geometry{
  width=140mm,
  height=217mm,
  marginparsep=3mm,
  marginparwidth=30mm,
}
\ifdraft{\geometry{
  inner=10mm,
  marginparwidth=50mm
}}{}


% ---------------------
% Load Various Packages
% ---------------------

% Various Math Environments
\usepackage{amsthm,thmtools}
\usepackage{physics} % various shortcuts

% Bibliography
\usepackage[style=numeric-comp,url=false,isbn=false]{biblatex}
\addbibresource{bibliography.bib}

% For general figures
\usepackage[final]{graphicx}
\graphicspath{{/img}}
\usepackage{subcaption}
\usepackage{tikz}
\usetikzlibrary{babel,cd,shapes,3d}
\tikzcdset{arrow style=math font}
\tikzset{cross/.style={
    cross out, draw, solid, thin, 
    minimum size=2*(#1-\pgflinewidth), 
    inner sep=0pt, outer sep=0pt
  },
  cross/.default={3}
}

% For lists
\usepackage[shortlabels]{enumitem}

% For better Tables
%\usepackage{tabularray}

% For more fine grained typesetting in final mode.
% Else set the tolerance for overfull warnings higher.
\ifdraft{\hfuzz=1.5pt}{\usepackage{microtype}}

% Links and stuff
\usepackage[final]{hyperref}
\usepackage[noabbrev,capitalize]{cleveref}

\hypersetup{
  pdfcreator = {},
  pdfproducer = {}
}
\pdfvariable suppressoptionalinfo \numexpr 1+2+4+8+16+32+64+128+256+512 \relax


% For Todonotes
\usepackage[obeyDraft]{luatodonotes}

% --------------------------------------------
% Define Theorem Environments & Math Operators
% --------------------------------------------

\declaretheorem[numberwithin=section]{theorem}
\declaretheorem[sibling=theorem]{lemma, proposition, corollary}
\declaretheorem[sibling=theorem,style=definition]{definition, example}
\declaretheorem[sibling=theorem,style=remark]{remark}
\declaretheorem[name=Theorem,
refname={Theorem,Theorems},
Refname={Theorem,Theorems}]{maintheorem}
\renewcommand{\themaintheorem}{\Alph{maintheorem}}


\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\interior}{int}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\HF}{HF}
\DeclareMathOperator{\HM}{HM}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\Flux}{Flux}
\DeclareMathOperator{\Crit}{Crit}

% Fix \norm spacing
\renewcommand{\norm}[1]{\left\lVert#1\mkern 1.2mu \right\rVert}

\begin{document}
\title{Semi-Local Exotic Lagrangian Tori in Dimension Four\\
\bigskip
\begin{tikzpicture}[scale=0.9]
\foreach \y in {0,1,2,3} {
  \begin{scope}[shift={(4*\y-1.5,0)}]
    \fill[opacity=0.1] (0.5,1) -- (0,0) -- (-0.5+\y,-1) -- (3,-1) -- (3,1);
    \begin{scope}
      \clip (0.5,1) -- (0,0) -- (-0.5+\y,-1) -- (3,-1) -- (3,1);
      \foreach \x in {0.2,0.4,...,3.5}
          \draw[very thin,gray] (\x+.5,1) -- (\x,0) -- (\x+\y-.5,-1);
    \end{scope}
    \draw[very thick, white] (0,0) -- (3,0);
    \draw[thick] (0.5,1) -- (0,0) -- (-0.5+\y,-1);
    \ifnum\y>0\relax\draw[dashed] (0,0) \foreach \x in {1,...,\y} { -- +({\x*1.5/(\y+1)},0) node[cross] {} };\fi
    \ifnum\y<3\relax\draw[dashed] (3,0) \foreach \x in {\y,...,2} { -- +({-(3-\x)*1.5/(4-\y)},0) node[cross] {} };\fi
    \fill (1.5,0) circle[radius=1.5pt];
  \end{scope}
}
\end{tikzpicture}\vspace{-0.5cm}}
\author{Joé Brendel, Johannes Hauber, Joel Schmitz}

\maketitle

\begin{abstract}
We study exotic Lagrangian tori in dimension four.
In certain Stein domains $B_{dpq}$ (which naturally appear in almost toric fibrations) we find $d+1$ families of monotone Lagrangian tori which are mutually distinct, up to symplectomorphisms.
We prove that these remain distinct under embeddings of $B_{dpq}$ into geometrically bounded symplectic four-manifolds.
We show that there are infinitely many different such embeddings when $X$ is compact and (almost) toric and hence conclude that $X$ contains arbitrarily many Lagrangian tori which are distinct up to symplectomorphisms of $X$.
In dimension four arbitrarily many different Lagrangian tori were previously known
only in del Pezzo surfaces.

Neither the embedded tori, nor the ambient space $X$ needs to be monotone for our methods to work. 
\end{abstract}

\section{Introduction}

\subsection{Context}
\label{sec:intro_context}

This paper is motivated by the symplectic classification question of Lagrangian submanifolds: for two Lagrangian submanifolds $L,L' \subset (X,\omega)$ of a symplectic manifold, can $L$ be mapped to $L'$ by a symplectomorphism of $X\,$? We say that $L,L'$ are \textbf{equivalent}, and write $L \cong L'$, if such a symplectomorphism exists.
If it does not, we say that $L,L'$ are \textbf{inequivalent} and write $L \ncong L'$. 

An obvious necessary condition for $L$ and $L'$ to be equivalent is that they are diffeomorphic as manifolds.
In this paper, we only consider Lagrangian tori.
They play a special role in symplectic geometry, since they are \emph{everywhere}.
Indeed, Darboux' theorem states that every symplectic manifold locally looks like a copy of the standard symplectic vector space which contains arbitrarily small Lagrangian tori.
Furthermore, Lagrangian tori naturally appear in classical mechanics, and more specifically in the study of completely integrable systems.
In fact, in this paper we heavily rely on certain completely integrable systems, so-called almost toric fibrations. We use these fibrations as an auxiliary tool to study the symplectic topology of their fibres.

Recall that every Lagrangian submanifold $L \subset X$ has two characteristic classes; the  \textbf{area class} $a_L \colon H_2(X,L) \rightarrow \mathbb{R}$ and the \textbf{Maslov class} $m_L \colon H_2(X,L) \rightarrow \mathbb{Z}$, which are preserved by symplectomorphisms in the sense that if there is $φ \in \operatorname{Symp}(X,\omega)$ with $φ(L) = L'$, then 
\begin{equation}
    \label{eq:softcond}
    a_{L} = a_{L'} \circ Φ, \quad
    m_{L} = m_{L'} \circ Φ, 
\end{equation}
where $Φ = φ_* \colon H_2(X,L) \rightarrow H_2(X,L')$.
Therefore, the existence of some isomorphism $Φ$ such that \eqref{eq:softcond} holds is a necessary condition for $L$ and $L'$ to be equivalent.
If such a map $Φ$ exists, we say that $L$ and $L'$ \textbf{have the same classical invariants} and write $L \sim L'$.
Recall also that $L$ is called \textbf{monotone}, with monotonicity constant $C > 0$, if $a_L = C \, m_L$. 

A full classification of Lagrangian tori up to symplectomorphism is out of reach in most ambient spaces of dimension four and above.
Note that the classification is not even known for $\mathbb{R}^4$, although there is some evidence \cite{Riz19} that every Lagrangian torus in $\mathbb{R}^4$ is Hamiltonian isotopic to either a product torus or a Chekanov torus.
Finding sets of Lagrangian tori which have the same classical invariants, but are \emph{not} equivalent is thus a well-motivated problem.
On the one hand, it sheds some light on what a classification of Lagrangian tori could look like, and on the other hand it represents an interesting occurrence of symplectic rigidity in its own right.
The study of such Lagrangian tori was initiated by \cite{Che96} and \cite{EliPol97} and has attracted much interest since,  see \cite{Aur15, brendel2020real, CheSch10, FOOO12, GalMik22, SheTonVia19, Via17, Via16} , which is a non-exhaustive list.
Lagrangian tori which are not equivalent to standard ones, such as e.g.\ product tori in $\mathbb{R}^{2n}$ or toric fibres in toric manifolds, are sometimes called \emph{exotic} or \emph{symplectically knotted}.

\subsection{Main results}
\label{sec:intro_main_results}

In this paper, we study exotic Lagrangian tori in dimension four.
We construct non-equivalent Lagrangian tori in certain model spaces $B_{dpq}$. If there is a symplectic embedding $B_{dpq} \supset U \rightarrow X$ of a neighbourhood $U$ of the Lagrangian skeleton of $B_{dpq}$ into a geometrically bounded symplectic four-manifold $(X,\omega)$, then we prove the images of small enough tori are non-equivalent with respect to symplectomorphisms of the new ambient space $X$.

More precisely, let $d,p,q \in \mathbb{N}$ be integers such that $d≥1$ and $p,q$ are coprime.
For every such triple, there is a symplectic manifold $B_{dpq}$, which will serve as model space for us. 
We will think of $q$ as an element in $ℤ_p / {±1}$, since different choices of representative define symplectomorphic spaces $B_{dpq}$.
For $d=1$, $B_{1pq} = B_{pq}$ is a rational homology ball.
In general, there are two complementary ways of viewing the spaces $B_{dpq}$.
The first is as a Milnor fibre of the smoothing of a cyclic quotient T-singularity, see \cite[Section 7.4]{evans2021atfs} for more details.
The second point of view, which is the one we will adopt in this paper, is that of almost toric fibrations.
The spaces $B_{dpq}$ appear naturally as spaces having an almost toric base diagram with one single vertex.
In other words, these spaces are the elementary building blocks of almost toric manifolds and thus very natural objects to study.
Just like every vertex of a toric moment map image yields a symplectic ball embedding, every vertex of an almost toric base diagram yields a symplectic embedding of a subset of $B_{dpq}$.
We postpone the discussion of almost toric geometry to \cref{sec:intro_methods,sec:local_model}. 

\begin{maintheorem}
    \label{thm:A}
    Let $(d,p,q)$ be a triple as above.
Then for every $a>0$, there are $d+1$ monotone Lagrangian tori $T^0_{pq}(a), \ldots , T^d_{pq}(a) \subset B_{dpq}$ with montonicity constant $\frac{a}{2}$ which have the same classical invariants, but are pairwise inequivalent, i.e.\ 
    \begin{equation}
        T^k_{pq}(a) \sim T^{k'}_{pq}(a), \quad 
         T^k_{pq}(a) \ncong T^{k'}_{pq}(a), \quad
        \forall k \neq k' \in \{0,\ldots,d\}.
    \end{equation}
\end{maintheorem}

This is proved in \cref{sec:main_thm}.

\begin{remark}
    \label{rk:lekili}
    Some special cases of \cref{thm:A} can be deduced from \cite{LekMay14}, see \cref{rk:lekili2} for details.
\end{remark}

\begin{example}
    \label{ex:cotangent}
    For $d=2, p=1, q=0$, we have $B_{2,1,0} \cong T^*S^2$ equipped with its standard symplectic form.
By \cref{thm:A}, there are three distinct types of monotone Lagrangian tori in $T^*S^2$. 
    \begin{enumerate}
        \item The torus $T^0_{1,0}(a)$ is a Chekanov-type torus, i.e.\ it is the image of a Chekanov torus in $\mathbb{R}^4$ under a symplectic embedding $\varphi \colon \mathbb{R}^4 \supset U \rightarrow T^*S^2$.
        \item The torus $T^1_{1,0}(a)$ is Clifford-type, i.e.\ the image of a Clifford torus under such an embedding.
        \item The torus $T^2_{1,0}(a)$ is a so-called Polterovich torus, see \cite{AlbFra08}. 
    \end{enumerate} 
\end{example}

In order to embed the exotic tori from \cref{thm:A} into a general symplectic four-manifold $(X,\omega)$, we consider certain symplectic embeddings of the form $\varphi \colon B_{dpq} \supset U \rightarrow X$, which we call \textbf{partial $B_{dpq}$\-/embeddings}, see \cref{def:partial_embedding}. Every space $B_{dpq}$ contains a configuration consisting of 
\begin{enumerate}
    \item a Lagrangian $(p,q)$-pinwheel, and
    \item $d-1$ Lagrangian spheres,
\end{enumerate}
which are \emph{visible} in the almost toric base diagram of $B_{dpq}$, see also \cite[Remark 7.10]{evans2021atfs}.
The union of these Lagrangian subspaces is connected and forms a chain starting with the pinwheel followed by the spheres, such that every member of the chain intersects its neighbours in one point.
From a symplectic point of view this union can be viewed as Lagrangian skeleton of the Stein domain $B_{dpq}$.
From the algebraic geometry point of view it can be viewed as vanishing cycle of the degeneration of $B_{dpq}$ to the corresponding cyclic quotient singularity.
See \cite{Eva19} for details on the latter point of view.

Roughly speaking, a partial $B_{dpq}$\-/embedding is a symplectic embedding of an open neighbourhood of the Lagrangian skeleton of $B_{dpq}$.
Our second main result distinguishes the images of small enough tori $T^k_{pq}$ via partial $B_{dpq}$\-/embeddings into geometrically bounded symplectic four-manifolds. 

\begin{maintheorem}
    \label{thm:B}
    Let $\varphi \colon B_{dpq} \supset U \rightarrow X$ be a partial $B_{dpq}$\-/embedding into a geometrically bounded symplectic four-manifold $(X,\omega)$.
Then there is $a_0 > 0$ such that for all $0 < a < a_0$, 
    \begin{equation}
        \varphi(T^k_{pq}(a)) \sim \varphi(T^{k'}_{pq}(a)), \quad 
        \varphi(T^k_{pq}(a)) \ncong \varphi(T^{k'}_{pq}(a)), \quad
        \forall k \neq k' \in \{0,\ldots,d\}.
    \end{equation}
    Furthermore, if $\varphi' \colon B_{d'p'q'} \supset U' \rightarrow (X,\omega)$ is a partial $B_{d'p'q'}$\-/embedding, then there is $a_0' > 0$ such that for all $0<a' < a_0'$, if $\varphi(T^k_{pq}(a))$ can be mapped by a symplectomorphism of $X$ to $\varphi'(T^{k'}_{p'q'}(a'))$, then $a=a'$ and either $k = k' = 0$ or $(k,p,q) = (k',p',q')$. 
\end{maintheorem}

In other words, we distinguish not only Lagrangian tori coming from a fixed partial $B_{dpq}$\-/embedding, but also Lagrangian tori\footnote{except if $k=k'=0$, in which case our invariant does not detect $(p,q)$} coming from partial $B_{dpq}$\-/embeddings with different $(p,q)$.
As a continuation of \cref{ex:cotangent}, the following is an immediate consequence of \cref{thm:B} and Weinstein's neighbourhood Theorem.

\begin{corollary}
    \label{thm:lag_sphere}
    Let $N \subset X$ be a Lagrangian sphere in a geometrically bounded symplectic four manifold.
    Then every neighbourhood of $N$ contains three different types of tori, namely a Chekanov torus, a Clifford torus and a Polterovich torus, which have the same classical invariants, but are not related by symplectomorphisms of $X$.
\end{corollary}

By \cite{Kho13}, every Lagrangian $(p,q)$-pinwheel induces a partial $B_{1pq}$\-/embedding, see also \cite[Definition 2.10]{EvaSmi18}.
Another immediate consequence of \cref{thm:B} is the following.

\begin{corollary}
    \label{thm:pinwheels}
    Let $P \subset X$ be a Lagrangian $(p,q)$-pinweel and $P' \subset X$ a Lagrangian $(p',q')$-pinwheel in a geometrically bounded symplectic manifold $(X,\omega)$.
    If $(p,q) ≠ (p',q')$, then there is a one-parameter family of tori in a neighbourhood of $P$ and a one-parameter family of tori in a neighbourhood of $P'$, such that its members are pairwise inequivalent up to symplectomorphisms of $X$.
\end{corollary}

To apply \cref{thm:B}, let us now move to examples of symplectic manifolds $(X,\omega)$ which admit partial $B_{dpq}$\-/embeddings.
For a given $X$ it is a highly non-trivial question to decide if, and for which triple $(d,p,q)$, there is a partial $B_{dpq}$\-/embedding.
Note that the existence of a partial $B_{dpq}$\-/embedding in particular implies that $X$ contains a particular configuration consisting of a Lagrangian $(p,q)$-pinwheel and $d-1$ Lagrangian spheres.
In fact, for $X = \mathbb{C}P^2$, it was shown in \cite{EvaSmi18}, that there is a partial $B_{dpq}$\-/embedding if and only if $d=1$ and $p$ is a so-called Markov number, the number $q$ can be determined from $p$ in this case.
On the other hand, we prove the following, see \cref{thm:toric_embeddings} for the detailed statement.

\begin{proposition}
    \label{thm:intro_stretch}
  Let $(X,\omega)$ be a compact four-dimensional symplectic manifold admitting an (almost) toric structure with a base diagram having finitely many nodes.
Then there is a sequence of partial $B_{d_i p_i q_i}$\-/embeddings into $X$ with $p_i \rightarrow \infty$. 
\end{proposition}

This is proved by considering certain sequences of almost toric mutations, see \cref{sec:stretch_edge}.
Similar ideas appeared in \cite{EvaUrz21}.
\cref{thm:intro_stretch} might be of independent interest, as it implies for example that every such manifold contains infinitely many different Lagrangian pinwheels. 

Now let $X$ be as in \cref{thm:intro_stretch} and let $\varphi_i \colon B_{d_i p_i q_i} \supset U_i \rightarrow X$ be the sequence of partial $B_{dpq}$\-/embeddings.
For all $i$, we obtain Lagrangian tori
\begin{equation}
    \label{eq:l_tori}
    L^{k_i}_i(a_i) = \varphi_i(T^{k_i}_{p_i q_i}(a_i))\;, \quad
    \forall k_i \in \{0,\ldots,d_i\}
\end{equation}
for all $a_i$ such that $T^{k_i}_{p_i q_i}(a_i) \subset U_i$.
By the definition of partial $B_{dpq}$\-/embeddings, there is a segment $(0,b_i)$ on which this holds.
Applying \cref{thm:B}, we obtain the following.
   

\begin{maintheorem}
    \label{thm:C}
    Let $(X,\omega)$ be a compact four-dimensional symplectic manifold admitting an (almost) toric structure with a base diagram having finitely many nodes.
For every $i \in \mathbb{N}$, there is $a_{i,0} > 0$ such that for every pair $n \neq m$, we have
    \begin{equation}
        L^{k_n}_n(a_n) \ncong L^{k_m}_m(a_m), \quad
        \forall 0 ≤ k_n ≤ d_n,\; 1 ≤ k_m ≤ d_m, \; a_n < a_{n,0}, \; a_m < a_{m,0},
    \end{equation}
    for the tori defined in \eqref{eq:l_tori}.
\end{maintheorem}

In other words, every such $X$ contains infinitely many one-parameter families of Lagrangian tori such that no member of one family is equivalen,  by a symplectomorphism of $X$, to a member of another family.
The parameter $a_i$ is an area parameter in the partial $B_{dpq}$\-/embedding and can be viewed as the size of the corresponding torus.
One drawback of this result is that the sizes of the embeddings may become arbitrarily small along the sequence, meaning $a_{i,0} \rightarrow 0$. 

As was pointed out to us by Jonny Evans, we can apply \cref{thm:B} to certain surfaces of general type studied in \cite{EvaUrz21}.
The key point in that paper is interpreting Mori's theory of flips in terms of almost toric base diagrams and finding a sequence of mutations, that uses only two vertices,  yielding an infinite sequence of partial $B_{1p_iq_i}$\-/embeddings with $p_i \rightarrow \infty$.
During the process, the symplectic form is deformed and thus one ends up with a non-canonical symplectic form on the surface of general type.
Using \cref{thm:B}, the following is a direct corollary of \cite[Theorem 1.1]{EvaUrz21}.

\begin{corollary}
    \label{thm:quinticgodeaux}
    Let $X$ be a quintic surface or a simply connected Godeaux surface.
Then there is a symplectic form $\omega$ on $X$ for which $X$ contains infinitely many one-parameter families of Lagrangian tori the members of which are pairwise inequivalent up to symplectomorphisms of $(X,\omega)$.
\end{corollary}

\subsection{Methods}
\label{sec:intro_methods}

To construct and understand the tori considered in this paper we use almost toric fibrations, abbreviated in the following by ATFs; to distiguish those tori we use the displacement energy germ.
Let us briefly discuss these methods.
For a discussion and comparison to other works and methods, and in particular the use of the count of Maslov index two $J$-holomorphic disks, we refer to \cref{sec:intro_discussion}.
In \cref{sec:howto_exotic} we apply our methods to a simple example.

By the Arnold-Liouville theorem, a compact regular fibre of a completely integrable system is a Lagrangian torus. Vianna \cite{Via16,Via17} noticed that a certain type of completely integrable systems, called \emph{almost toric fibrations}, is a rich source of exotic tori. We give an overview of almost toric fibrations in \cref{sec:atgeometry} and refer to \cite{evans2021atfs} for more details. A crucial feature of ATFs is that, on a fixed symplectic manifold, there are certain operations by which one can produce new almost toric fibrations from a given one. One such operation is called \emph{nodal slide}. A nodal slide produces a one-parameter family of almost toric fibrations on the same space, which very often produces exotic Lagrangian tori. For example, sliding a node across the base point of Clifford torus in $\mathbb{R}^4$ produces a Chekanov torus. We discuss this simple example in detail in \cref{sec:howto_exotic}.

In terms of almost toric geometry, the model spaces $B_{dpq}$ are particularly simple.
Indeed, the almost toric base diagrams of $B_{dpq}$ have $d$ nodes with coinciding eigenline, see \cref{fig:Bdpq_moment_image_alt} for two possible ATF-base diagrams that are related to each other by changing the branch cut. Subsequently sliding $d$ nodes across a given base point produces the $d+1$ Lagrangian tori in \cref{thm:A}.
The pair $(p,q)$ determines the integral affine angle between the branch cut and the boundary of the almost toric base diagram.
This is discussed in detail in \cref{sec:modelspaces}.

As mentioned before, the spaces $B_{dpq}$ are natural building blocks in the realm of almost toric fibrations.
Indeed, we note the following and refer to \cref{thm:atf_bdpq} for a precise statement.

\begin{proposition}
    \label{thm:intro_partialbdpq}
    Every vertex of an almost toric base diagram of a symplectic manifold $(X,\omega)$ yields a partial $B_{dpq}$\-/embedding into $X$. 
\end{proposition}

By iterated so-called mutations of almost toric base diagrams, one can obtain new partial $B_{dpq}$\-/embeddings using \cref{thm:intro_partialbdpq}.
This is how \cref{thm:intro_stretch} is proved.

\begin{figure}
    \centering
      \begin{tikzpicture}[scale=0.9]
        \foreach \y in {0,1,2,3} {
          \begin{scope}[shift={(4*\y-1.5,0)}]
            \fill[opacity=0.1] (0.5,1) -- (0,0) -- (-0.5+\y,-1) -- (3,-1) -- (3,1);
            \begin{scope}
              \clip (0.5,1) -- (0,0) -- (-0.5+\y,-1) -- (3,-1) -- (3,1);
              \foreach \x in {0.2,0.4,...,3.5}
                  \draw[very thin,gray] (\x+.5,1) -- (\x,0) -- (\x+\y-.5,-1);
            \end{scope}
            \draw[very thick, white] (0,0) -- (3,0);
            \draw[thick] (0.5,1) -- (0,0) -- (-0.5+\y,-1);
            \ifnum\y>0\relax\draw[dashed] (0,0) \foreach \x in {1,...,\y} { -- +({\x*1.5/(\y+1)},0) node[cross] {} };\fi
            \ifnum\y<3\relax\draw[dashed] (3,0) \foreach \x in {\y,...,2} { -- +({-(3-\x)*1.5/(4-\y)},0) node[cross] {} };\fi
            \fill (1.5,0) circle[radius=1pt] node[anchor=south] {$T^\y_{2,1}(a)$};
          \end{scope}
          \begin{scope}[shift={(4*\y,-3)}]
            \draw (0,-1) node[anchor=110] {$[e]_{T^\y_{2,1}(a)}$};
            \clip[draw] (0,0) circle[radius=1];
            \foreach \x in {-4,-3.8,...,1}
              \draw[very thin,gray] (\x+0.5,1) -- (\x,0) -- (\x-0.5+\y,-1);
            \draw[very thick, black!20] (-1,0) -- (1,0);
            \fill (0,0) circle[radius=1pt];
          \end{scope}
        }
      \end{tikzpicture}
    \caption{Upper half: Different almost toric base diagrams in which the tori $T^k_{2,1}(a)$ appear as fibres. The grey lines inside the base diagram are level sets of the displacement energy of the almost toric fibres. Lower half: Level sets of the displacement energy germs of the respective tori. 
    For easier visibility of the  level sets, the diagrams differ by a $\GL(2,ℤ)$ transformation from the usual diagrams in the paper.}
    \label{fig:germ_examples}
\end{figure}

As discussed above, the tori $T^0_{pq}, \ldots , T^d_{pq} \subset B_{dpq}$ appear as fibres of different almost toric fibrations of $B_{dpq}$.
More specifically, they lie on the branch cut line of its almost toric base diagram, and the number $k$ in the notation $T^k_{pq}$ of the tori is the number of nodes to one side of its base point, which means on the left by our conventions. See the upper half of \cref{fig:germ_examples}.
In particular, fibres $T^k_{pq}(a)$ and $T^{k'}_{pq}(a)$ with $k \neq k'$ do not both appear as fibres in the same almost toric base diagram.
Indeed, we note that the upper diagrams in \cref{fig:germ_examples} are related by a nodal slide and a change in branch cut, for better visibility.

\medskip

The invariant we use to distinguish the Lagrangian tori is the so called \textbf{displacement energy germ}.
For a compact Lagrangian $L \subset (X,\omega)$ its displacement energy germ is a germ $[e]_L \colon H^1(L;\mathbb{R}) \rightarrow \mathbb{R} \cup \{+\infty\}$, which is derived from  the displacement energy via \textbf{versal deformations}, introduced in \cite{Che96}. See \cite{brendel2020real,brendel2023local,CheSch10} for other applications of this method.
Roughly speaking, the germ $[e]_L$ measures how displacement energy behaves on infinitesimal deformations of the Lagrangian $L$ in the space of Lagrangians modulo infinitesimal Hamiltonian isotopies.
We carefully discuss versal deformations in \cref{sec:versal_deformations}. 

If the Lagrangian in question happens to be an (almost) toric fibre, then its versal deformation is simply given by varying the base point of the fibration, see \cref{sec:vd_AL}. Thus, in order to compute the germs $[e]_{T^k_{pq}(a)}$ (given in \cref{thm:main}), we compute the displacement energy of almost toric fibres in $B_{dpq}$. This is carried out in \cref{sec:upper_bound,sec:lower_bound}. See \cref{fig:germ_examples} for a sketch of the level set of these germs. Curiously enough, we do not determine the displacement energy of the tori $T^{k}_{pq}(a)$ themselves\footnote{Some of them are known to be non-displaceable, see \cref{rk:nondisplaceable}}. Indeed, it is sufficient to know $[e]_{T^k_{pq}(a)}$ on an open dense subset in order to distinguish the tori. 

In the case of the image of the tori $T^k_{pq}$ under partial $B_{dpq}$\-/embeddings, i.e.\ to prove \cref{thm:B}, the following two properties are key:

\begin{enumerate}
    \item The displacement energy germ $[e]_L$ is well-defined, even if $L$ is not monotone.
This is crucial, since, although the tori $T^k_{pq} \subset B_{dpq}$ are themselves monotone, their embedded versions into $(X,\omega)$ are not; 
    \item Let $\varphi \colon B_{dpq} \supset U \rightarrow X$ be a partial $B_{dpq}$\-/embedding.
Then for small enough tori $L \subset U$, the displacement energy germ is preserved under $\varphi$, 
    \begin{equation}
        \label{eq:locality}
        [e]_{\varphi(L)} = [e]_L \circ (\varphi\vert_L)^*.
    \end{equation}
\end{enumerate}

We say that a Lagrangian $\varphi(L)$ arising as the image of $L \subset B_{dpq}$ under a partial $B_{dpq}$\-/embedding has the \emph{locality property for the displacement energy germ} if \eqref{eq:locality} holds. Note that this property is not trivial.
Indeed, the germ $[e]_L$ is derived from the displacement energy of a family of tori in $B_{dpq}$, whereas $[e]_{\varphi(L)}$ is derived from the displacement energy of tori in $X$. The upper bound on the displacement energies of embedded tori, appearing as the neighbours of $\varphi(L)$, is proved by displacing them within the given partial $B_{dpq}$\-/embedding via the method of probes, see \cref{sec:upper_bound}. The lower bound is given by the area of $J$-holomorphic curves via Chekanov's estimate \cref{thm:chekanov}, together with an area estimate on $J$-holomorphic curves leaving the partial $B_{dpq}$\-/embedding, see \cref{sec:lower_bound}.

The locality property of the displacement energy germ was first used in \cite{chekanovschlenk2015} to distinguish embeddings of product tori and then taken up in \cite{brendel2023local} to construct exotic Lagrangian tori in Darboux charts in dimensions $\geqslant 6$.

\subsection{Discussion and comparison to other works}
\label{sec:intro_discussion}

Let us compare our results with the situation in dimensions $\geqslant 6$.
The first-named author has recently proved that in dimension six and higher, the existence of exotic tori is generic and a purely local occurence. 
\begin{theorem}\cite[Theorem D]{brendel2023local}
    \label{thm:Bre23}
    Let $(X,\omega)$ be a geometrically bounded symplectic manifold of dimension greater than or equal to six.
    Then every open set of $X$ contains infinitely many Lagrangian tori which have the same classical invariants, but are pairwise inequivalent up to symplectomorphisms of $(X,\omega)$.
\end{theorem}

The tori in \cref{thm:Bre23} are constructed by embedding exotic tori in $\mathbb{R}^{2n}$ via Darboux charts into $X$.
Although both \cref{thm:Bre23} and our main result \cref{thm:B} are proved using the same technique, i.e.\ the locality property of the displacement energy germ, there are some important differences.
Whereas in dimension six and above, there are known to be infinitely many inequivalent tori in $\mathbb{R}^{2n}$, which is due to \cite{Aur15} for monotone tori and \cite{brendel2023local} for non-monotone tori, in $\mathbb{R}^4$ it is still an open question whether there are Lagrangian tori besides product and Chekanov tori.
In fact, a partial classification result in \cite{Riz19} suggests that there are no other Lagrangian tori in $\mathbb{R}^4$, although this is still open.
This means that the approach of embedding Lagrangian tori via Darboux charts is inefficient in dimension four.
Even embedding the Chekanov torus into some four-dimensional symplectic manifold $X$ by a Darboux chart does not yield a torus which is exotic in a robust sense:
 
\begin{remark}
    Let $X = S^2 \times S^2$ be equipped with a non-monotone symplectic form.
Then there is a Darboux embedding $\varphi \colon \mathbb{R}^4 \supset U \rightarrow X$, a Chekanov torus $L \subset U$ and a product torus $L' \subset U$ such that $\varphi(L) \cong \varphi(L')$.
See also \cite[Example 5.6]{brendel2023local}.
\end{remark}

This suggests that in dimension four, one should not restrict one's attention to Darboux embeddings, but look instead at embeddings of more complicated domains containing interesting tori, such as the partial $B_{dpq}$\-/embeddings considered here.
This comes at the cost of having to construct said embeddings, for which there can be obstructions from symplectic topology, as discovered in \cite{EvaSmi18}, whereas Darboux embeddings exist everywhere. 

Most other works on exotic Lagrangian tori have exclusively studied \emph{monotone} exotic tori, see \cite{Aur15, Che96, CheSch10, EliPol97, GalMik22, Via17, Via16}.
The most commonly used invariant to distinguish Lagrangian tori is a count of the Maslov index two $J$-holomorphic disks with boundary on the Lagrangian in question.
Due to bubbling, this count a priori depends on the chosen $J$ in the case of non-monotone Lagrangian tori.
Notable exceptions in which non-monotone exotic tori were detected are \cite{FOOO12, SheTonVia19}.
In \cite{FOOO12}, the authors detect a 1-parametric family of non-displaceable tori and exoticity follows from non-displaceability in that case.
In \cite{SheTonVia19}, the authors consider an interesting invariant $\Psi(L) \in \mathbb{R}_{>0} \cup \{+\infty\}$ based on the count of \emph{minimal area} $J$-holomorphic disks as well as non-trivial input from the Fukaya category of the Lagrangian in question.
In \cite[Section 7]{SheTonVia19} the invariant $\Psi$ is used to distinguish non-monotone Vianna-type tori in $\mathbb{C}P^2$.
There is some overlap between this result and our results:
From all possible mutations of the toric moment polytope of $\mathbb{C}P^2$, we obtain partial $B_{1pq}$\-/embeddings for all Markov numbers $p$ and thus infinitely many distinct non-monotone tori in $\mathbb{C}P^2$.
The result in \cite[Section 7]{SheTonVia19} is quantitatively stronger\footnote{Although the displacement energy germ also distinguishes these tori, see \cite[Example 3.7]{brendel2023local}.}, since our results only apply to small tori near the ATF-vertices.
On the other hand, our results apply more broadly to any partial $B_{dpq}$\-/embeddings into a geometrically bounded $X$.

\subsection{Overview}

In \cref{sec:local_model}, we discuss almost toric fibrations (\cref{sec:atgeometry}), their fibres (\cref{sec:atfibres}), we introduce the model spaces $B_{dpq}$ (\cref{sec:modelspaces}) and discuss partial $B_{dpq}$\-/embeddings coming from general almost toric base diagrams (\cref{sec:atf_base_diagrams}).
In \cref{sec:vds}, we introduce the displacement energy germ.
\cref{sec:lagflux,sec:vdcotangent,sec:versal_deformations} give a full, self-contained account of the method of versal deformations.
Versal deformations of (almost) toric fibres are discussed in \cref{sec:vd_AL}. In \cref{sec:howto_exotic} we explain how to combine nodal slides with computing the displacement energy germ.
In \cref{sec:upper_bound,sec:lower_bound} we compute upper and lower bounds on the displacement energy of almost toric fibres of $B_{dpq}$.
In \cref{sec:main_thm}, these results are combined to prove Theorems \ref{thm:A} and \ref{thm:B}.
In \cref{sec:examples}, we prove \cref{thm:intro_stretch} and discuss other examples.

\subsection{Acknowledgements}
We thank Jonny Evans for pointing out to us \cite{EvaUrz21} and the example discussed in \cref{thm:quinticgodeaux}.
We thank Felix Schlenk for his constant encouragement and carefully reading an earlier draft of this paper.
JB acknowledges the support of the Israel Science Foundation grant 1102/20 and the ERC Starting Grant 757585.

\section{Local model}
\label{sec:local_model}

We use almost toric geometry to define the local model spaces.
In \cref{sec:atgeometry,sec:atfibres} we give a short overview of almost toric geometry, its basic operations, which are nodal trades, nodal slides, mutations and discuss the fibres appearing in almost toric geometry.
The reader familiar with the ATF-framework can skip this section.
In \cref{sec:local_model} we introduce our local model space $B_{dpq}$, and \cref{sec:atf_base_diagrams} describes the relation of $B_{dpq}$ with almost toric base diagrams.

\subsection{Almost toric fibrations and their base diagrams}
\label{sec:atgeometry}

Almost toric geometry is a generalization in dimension four of toric geometry.
Let us briefly discuss the latter, before moving to the almost toric case.
A symplectic toric four-manifold $(X,\omega,\mu)$ is a symplectic manifold $(X,\omega)$ equipped with a moment map $\mu \colon X \rightarrow \mathbb{R}^2$, generating an effective Hamiltonian $T^2$-action on $X$.
The image $\mu(X) = \Delta \subset \mathbb{R}^2$ is a so called Delzant polytope and classifies $(X,\omega)$ up to $T^2$-equivariant symplectomorphisms, see \cite{Del88} or \cite{Can03} for more details.
The moment map defines a Lagrangian torus fibration, or, equivalently\footnote{We use both terms interchangeably.}, a completely integrable system on $X$.
The Lagrangian torus fibration defined by a toric moment map has very special properties, namely (1) its singularities, which are located over the boundary of $\Delta$, are of elliptic-regular or of elliptic-elliptic type, and (2) the moment map defines action coordinates on the interior of the moment polytope.
Note that every Lagrangian torus fibration admits local action coordinates in the neighbourhood of a regular fibre, this is the classical Arnold-Liouville Theorem, but that these do not necessarily extend globally, see for example \cite{Dui80} or \cite{Zun96,Zun03}.

An \textbf{almost toric fibration (ATF)} is a Lagrangian torus fibration on a four-dimensional symplectic manifold whose singularities are all of elliptic\-/regular, elliptic\-/elliptic or focus\-/focus type.
Almost toric fibrations were introduced by Sy\-ming\-ton \cite{symington2002FourDF}, based on earlier work by Zung \cite{Zun96,Zun97,Zun03}.
As opposed to toric manifolds, there is no globally defined Hamiltonian torus action at play, nor is there a moment map.
The analogue of the moment map image is given by the so-called \textbf{almost toric base diagram}.
As in the case of Delzant polytopes, every almost toric base diagram defines a unique symplectic manifold, see \cite[Corollary 5.4]{symington2002FourDF} and  \cite[Theorem 8.5]{evans2021atfs}. 

For us\footnote{The general almost toric framework allows for much more generality, e.g.\ base diagrams carrying topology, non-convexity etc.\, but for our purposes the description we give here is sufficient.}, the almost toric base diagram is given by a rational convex polytope $\Delta \subset \mathbb{R}^2$ in the plane decorated with nodes and branch cuts\footnote{By a small abuse of notation, we denote by the symbol $\Delta$ the almost toric base diagram, as well as the subset $\Delta \subset \mathbb{R}^2$ without decorations.}.
Given an almost toric fibration $F \colon X \rightarrow B \subset \mathbb{R}^2$, the corresponding base diagram is computed, roughly speaking, by attempting to find global action coordinates on the locus of regular values of $F$ in the base $B$.
In the absence of focus-focus singularities, i.e.\ in the toric case, this succeeds and the action coordinates can be extended over the elliptic-type singularities and this procedure yields the moment map.
In the presence of focus-focus singularities however, this fails.
Indeed, a neighbourhood of a focus-focus singularity, whose image sits in the interior of $\im F$, carries topological monodromy, meaning that the torus bundle given by neighbouring regular fibres is non-trivial.
See e.g.\ \cite{Zun97} for more details.
This means that action coordinates are well-defined only on the universal cover of $B \setminus \{\text{nodes}\}$.
An almost toric base diagram is obtained by computing action coordinates on a fundamental domain in the universal cover, see \cite[Definition 8.3]{evans2021atfs} for more details.
The branch cut decorations, which are represented by dashed lines, of the almost toric base diagram indicate which choice of fundamental domain was made.
Equivalently, one can think of the branch cuts as curves which were removed from the regular locus of $F$ in $B$ in order to make it simply connected.
On a simply connected domain, one can compute unique, meaning unique up to the usual action of $\operatorname{GL}(2;\mathbb{Z}) \ltimes \mathbb{R}^2$, action coordinates.
The image of these action coordinates yields the interior of the almost toric base diagram.
The full base diagram is obtained after adding the following decorations: edges and vertices on the boundary represent elliptic-type singularities, as in the toric case, dashed lines represent the image of the branch cuts in action coordinates, and crosses represent nodes, i.e.\ fibres containing a focus-focus singularity.
As mentioned above, a fully decorated almost toric base diagram defines a unique symplectic manifold.

\begin{figure}
  \centering
  \begin{tikzpicture}
    \draw[thick,fill,fill opacity=0.1] (-2,0) -- (-1,-2) -- (3,-1) -- (3,1) -- (2,2) -- (-1,2) -- (-2,0);
    \draw[dashed] (-2,0) -- +(1.2,0) node[cross] {};
    \draw[dashed] (-1,-2) -- +(0.7,0.7) node[cross] {};
    \draw[dashed] (3,-1) -- ++(-0.4,0) node[cross] {} -- ++(-0.4,0) node[cross] {} -- ++(-0.4,0) node[cross] {} -- ++(-0.4,0) node[cross] {};
    \draw[dashed] (-1,2) -- ++(0,-0.7) node[cross] {} -- ++(0,-0.7) node[cross] {};
  \end{tikzpicture}
  \caption{An almost toric base diagram.
Branch cuts are drawn with dashed lines, nodes marked with crosses.}
  \label{fig:atf_example}
\end{figure}

In this paper, we will always make a special choice of almost toric base diagram.
Every node in the almost toric base diagram has a unique \textbf{eigendirection}, i.e.\ a direction in $\mathbb{R}^2$ yielding an action coordinate which is preserved under the monodromy of the given node.
Although the eigendirection is not explicitely part of the decorations of the almost toric base diagram, it can always be read off from the angle the branch cut forms at the node in question.
In the current paper, we always choose the branch cut to coincide with the eigendirection.
As a consequence, the almost toric base diagram "closes up", which is discussed in \cite[Section 7.2]{evans2021atfs}, and thus yields a convex polytope.
With this convention, there is an analogue of the moment map, given by a continuous map $\pi \colon X \rightarrow \Delta$, which we call \textbf{almost toric moment map}\footnote{This is non-standard terminology.}.
Let $\Delta_0 \subset \Delta$ be the complement of nodes and branch cuts.
Since $\Delta_0$ is simply connected, there are global action coordinates on its intersection with the regular locus, see \cite{Dui80}.
Away from the branch cut and nodes, all singularities are of toric type, i.e.\ elliptic-regular or elliptic-elliptic, meaning that the map given by action coordinates can be smoothly extended over the singularities to yield a moment map $\pi\vert_{X_0} \colon X_0 \rightarrow \Delta_0$ of a Hamiltonian $T^2$-action.
With our choice of branch cuts, this map has a continuous extension $\pi \colon X \rightarrow \Delta$.
Let us formulate the following statement for future reference.

\begin{proposition}
    \label{thm:toricmomentmap}
    The restriction $\pi\vert_{X_0} \colon X_0 = \pi^{-1}(\Delta_0) \rightarrow \Delta_0$ is a toric moment map.
\end{proposition}

Roughly speaking, the almost toric moment map is obtained by picking action coordinates on $X_0$, which is possible since it fibers over the simply-connected $\Delta_0$, and by continuous extension over the branch cuts.

One of the main features of almost toric geometry is that one can deform a given (almost) toric fibration $F \colon X \rightarrow \mathbb{R}^2$ to produce another one on the same symplectic manifold $X$.
This freedom distinguishes the almost toric from the classical toric case.
The two main operations by which one can deform an almost toric fibration are the nodal trade and the nodal slide, both of which can be handily represented by simple operations on the corresponding ATF-base diagrams.
Let us briefly discuss these operations, referring to \cite[Sections 8.2-8.3]{evans2021atfs} for details.

\begin{figure}
  \centering
  \begin{tikzpicture}
    \begin{scope}[shift={(-3,0)}]
      \begin{scope}[shift={(-1.6,0)}]
        \fill[opacity=0.1] (-1,-1) rectangle (1,1);
        \draw[thick] (-1,1) -- (-1,-1) -- (1,-1);
      \end{scope}
      \draw[<->] (-0.5,0) -- node[anchor=south] {nodal} node[anchor=north] {trade} (0.5,0);
      \begin{scope}[shift={(1.6,0)}]
        \fill[opacity=0.1] (-1,-1) rectangle (1,1);
        \draw[thick] (-1,1) -- (-1,-1) -- (1,-1);
        \draw[dashed] (-1,-1) -- (0,0) node[cross] {};
      \end{scope}
    \end{scope}
    \begin{scope}[shift={(3,0)}]
      \begin{scope}[shift={(-1.6,0)}]
        \fill[opacity=0.1] (-1,-1) rectangle (1,1);
        \draw[dashed] (-1,-0.5) -- (-0.5,-0.25) node[cross] {};
      \end{scope}
      \draw[<->] (-0.5,0) -- node[anchor=south] {nodal} node[anchor=north] {slide} (0.5,0);
      \begin{scope}[shift={(1.6,0)}]
        \fill[opacity=0.1] (-1,-1) rectangle (1,1);
        \draw[dashed] (-1,-0.5) -- (0.5,0.25) node[cross] {};
      \end{scope}
    \end{scope}
  \end{tikzpicture}
  \caption{Nodal trade and nodal slide.}
  \label{fig:nodal_trade_and_slide}
\end{figure}

The \textbf{nodal trade} takes an elliptic-elliptic singularity and transforms it into a focus-focus singularity, while merging the two families of elliptic-regular singularities into one.
In terms of the almost toric base diagram, it corresponds to replacing a toric vertex with a node and a branch cut. (See \cref{fig:nodal_trade_and_slide})

The \textbf{nodal slide} consists of moving the focus-focus singularity in a non-trivial way, in terms of action coordinates, such that the node in the base diagram moves on a line in its eigendirection. (See \cref{fig:nodal_trade_and_slide})

\begin{figure}
  \centering
  \begin{tikzpicture}
    \begin{scope}[shift={(-4,0)}]
      \draw[very thin,black!60] (-2,2) grid (3,-2);
      \fill[blue, opacity=0.1] (-2,2) rectangle (3,0);
      \draw[thick,fill,fill opacity=0.1] (-2,0) -- (-1,-2) -- (3,-1) -- (3,1) -- (2,2) -- (-1,2) -- (-2,0);
      \draw[dashed] (-2,0) -- +(1.2,0) node[cross] {};
      \draw[dashed] (-1,-2) -- +(0.7,0.7) node[cross] {};
      \draw[dashed] (3,-1) -- ++(-0.4,0) node[cross] {} -- ++(-0.4,0) node[cross] {} -- ++(-0.4,0) node[cross] {} -- ++(-0.4,0) node[cross] {};
      \draw[dashed] (-1,2) -- ++(0,-0.7) node[cross] {} -- ++(0,-0.7) node[cross] {};
    \end{scope}
    \draw[<->] (-0.5,0) -- (0.5,0);
    \begin{scope}[shift={(4,0)}]
      \draw[very thin,black!60] (-3,-2) grid (3,2);
      \fill[blue, opacity=0.1] (-3,2) rectangle (3,0);
      \draw[thick,fill,fill opacity=0.1] (-1,-2) -- (3,-1) -- (3,0) -- (2,1) -- (0,2) -- (-3,2) -- (-1,-2);
      \draw[dashed] (3,0) -- (-0.8,0) node[cross] {};
      \draw[dashed] (-1,-2) -- +(0.7,0.7) node[cross] {};
      \draw[dashed] (3,-1) -- ++(-0.4,0) node[cross] {} -- ++(-0.4,0) node[cross] {} -- ++(-0.4,0) node[cross] {} -- ++(-0.4,0) node[cross] {};
      \draw[dashed] (-3,2) -- ++(0.7,-0.7) node[cross] {} -- ++(0.7,-0.7) node[cross] {};
    \end{scope}
  \end{tikzpicture}
  \caption{Changing the branch cut: Here we change the horizontal branch cut on the left, applying the corresponding shear transform (in this case $\smqty(1 & -1\\ 0 &1)$) to the top half of the plane.}
  \label{fig:changing_the_branch_cut}
\end{figure}

The third operation is called \textbf{changing the branch cut}, see \cite[Sections 8.4]{evans2021atfs} for more details.
It corresponds to making a different choice of branch cut to produce the almost toric base diagram.
Since, in the context of the present paper, we only consider branch cuts which coincide with the eigenline of a given node, there are only two choices of branch cuts, and the \textit{change in branch cut}-operation is a switch from one to the other.
Under such a switch, the almost toric base diagram undergoes a piece-wise linear transformation: apply the identity to one of the halves of the base diagram bounded by the eigenline and an integral shear preserving the eigenline to the other half.
The branch cut is still contained in the eigenline, but switches sides. (See \cref{fig:changing_the_branch_cut})

\begin{proposition}
    \label{thm:change_branchcut}
    Let $\Delta \subset \mathbb{R}^2$ be an almost toric base diagram containing a node $n \in \Delta$, lying at the end of a branch cut.
Up to translation, we assume that $n = (0,0) \in \mathbb{R}^2$.
Furthermore, let $v \in \mathbb{Z}^2$ be the primitive vector determining the eigenline of the node $n$ pointing away from its branch cut at $n$.
Then the almost toric base diagram $\Delta'$ after a change in branch cut at $n$ is obtained from $\Delta$ by applying the piece-wise linear map 
    \begin{equation}
    \label{eq:half-shear}
        \overline{S}_v(x) =
        \begin{cases}
            S_v(x) = x + \det(x,v)v & \qif* \det(v,x) \geqslant 0 \;, \\
            x & \qif* \det(v,x) < 0 \;.
        \end{cases}
    \end{equation}
    Let $\pi$ be an almost toric moment map with image $\Delta$.
Then $\pi' = \overline{S}_v \circ \pi$ is the corresponding almost toric moment map after changing the branch cut.
\end{proposition}

The map $\overline{S}_v$ is linear on the two half-planes bounded by the eigenline of $n$ and since $v$ is an eigenvector of $S_v$, it is continuous.
See \cref{fig:changing_the_branch_cut} for an illustration, or \cite[Example 8.15]{evans2021atfs} for another example.

Note that there is a difference between nodal trade and nodal slide on the one hand, and the change in branch cut operation on the other hand.
The first two operations represent a change in the underlying almost toric fibration on $X$, whereas the change in branch cut does not.
The change in branch cut merely corresponds to a different way of representing the almost toric fibration by a base diagram.

Together, these three operations add up to an easy-to-use visual calculus on almost toric base diagrams, all of which represent different almost toric fibrations on the same manifold.
The combination of nodal slides and changes in branch cut is often called a \textbf{mutation}.
For example, one can start with a toric manifold, apply nodal trades at its vertices and then perform a series of mutations.
This was used in symplectic topology to great effect by Vianna~\cite{Via16} to exhibit infinitely many almost toric fibrations on $\mathbb{C}P^2$.
The set of almost toric fibrations obtained in this way is in bijection with the set of Markov triples and each almost toric fibration has an exotic Lagrangian torus as monotone fibre.
In \cref{sec:stretch_edge} we use mutations to show that any (almost) toric manifold with (almost) toric base diagram contained in $ℝ²$ exhibits infinitely many different almost toric fibrations.

\subsection{Almost toric fibres}
\label{sec:atfibres}

Let $F \colon X \rightarrow B \subset \mathbb{R}^2$ be an almost toric fibration with an almost toric moment map $\pi \to \Delta$.
A fibre of $F$ is called \textbf{almost toric fibre}.
For every $x \in \Delta$, we denote by $T(x) ≔ π^{-1}(x) \subset X$.
If $x \in \partial \Delta$, then $T(x)$ is a point or an isotropic circle.
If $x$ is a node, then $T(x)$ is a Lagrangian Whitney sphere, i.e.\ a Lagrangian immersion of a $2$-sphere with one transverse self-intersection.
If $x$ is neither a node, nor contained in the boundary, then $T(x)$ is a Lagrangian torus and we call such a torus a \textbf{regular ATF-fibre}.

\begin{remark}
    \label{rk:pinchedtorus}
    A Lagrangian Whitney sphere living over the node of an ATF-base diagram can be interpreted as a limit of regular fibres, i.e.\ Lagrangian tori, by viewing it as a Lagrangian torus which is "pinched" along a curve on the torus.
The homology class of this curve determines the topological monodromy of the torus bundle in a neighbourhood of the node.
\end{remark}

Almost toric fibres are left unaffected by nodal slides, provided they are not contained in the segment on which the nodal slide is supported\footnote{By this we mean the line segment obtained as the union of points across which the node moves during the nodal slide.}:

\begin{lemma}
    \label{thm:nodal_slide}
    Let $\Delta, \Delta'$ be two almost toric base diagrams which are related by nodal slides\footnote{This implies that the underlying sets $\Delta, \Delta' \subset \mathbb{R}^2$ coincide.} that are supported in the set $\Sigma$.
Let $X,X'$ be the symplectic manifolds corresponding to $\Delta,\Delta'$ and denote by $T(x) \subset X$ and $T'(x) \subset X$ their respective ATF fibres.
Then for every $x \in \Delta \setminus \Sigma$, there is a symplectomorphism $\psi \colon X \rightarrow X'$ with $\psi(T(x)) = T'(x)$.
\end{lemma}

\begin{proof}
    This follows from the proof of \cite[Theorem 8.10]{evans2021atfs}, by taking the set $K \subset \Delta$ therein small enough so that $x \notin K$.
\end{proof}

\begin{remark}
    \label{rk:slides_ray}
    The claim of \cref{thm:nodal_slide} fails for points which are contained in a segment on which a nodal slide is supported, even if both points correspond to regular almost toric fibres.
In fact, this is one of the main sources to construct exotic Lagrangian tori.
This approach was pioneered by Vianna \cite{Via16,Via17}.
The simplest example in which this occurs is $\mathbb{R}^4 = \mathbb{C}^2$.
Let $T_{\text Cl}(a) = S^1(a) \times S^1(a) \subset \mathbb{C} \times \mathbb{C}$ be the Clifford torus.
It is the toric fibre over the base point $(a,a)$ in the standard toric structure on $\mathbb{R}^4$.
To obtain an almost toric fibration with one focus-focus singularity on $\mathbb{R}^4$, perform a nodal trade at the vertex of the toric structure.
By a nodal slide, move the node across $(a,a)$ to obtain the Chekanov torus $T_{\text Ch}(a)$ over the point $(a,a)$.
See \cref{sec:howto_exotic} for more details on the construction of the Chekanov torus, and a sketch how to distinguish it from the Clifford torus.
\end{remark}


\subsection{Model spaces}
\label{sec:modelspaces}

Let $d,p,q \in \mathbb{N}$ be integers such that $d,p≥1$ and $p,q$ are coprime.\footnote{Here, we consider the pair $(1,0)$ as coprime.}
Let $\Delta_{dpq}$ be the almost toric base diagram obtained by decorating the right half-plane
$$\Delta_{dpq} = \{ (x,y) \in \mathbb{R}^2 \, \vert \, x ≥ 0 \}$$
with $d$ distinct nodes contained in the ray,
\begin{equation}
  \label{eqn:eigenline}
  R = \{\alpha (p,q) \in \Delta_{dpq} \, \vert \, \alpha > 0 \}
\end{equation}
and with eigendirection $(p,q)$.
For a branch cut contained in $R$ and to the right of the nodes, this yields the almost toric base diagram depicted in \cref{fig:Bdpq_moment_image}.

\begin{figure}
\centering
\begin{tikzpicture}
  \draw[ultra thick,opacity=0.4,text opacity=1,red] (0,0) -- node[pos=0.38,anchor=north] {$R$} (4,2);
  \draw[thick] (0,-1) -- (0,2);
  \draw[fill,opacity=0.1] (0,-1) rectangle (4,2);
  \draw[dashed] (1,0.5) node[cross] {} -- (2,1) node[cross] {} -- (3,1.5) node[cross] {} -- (4,2);
\end{tikzpicture}   
\caption{The almost toric base diagram $Δ_{dpq}$ for $B_{dpq}$.}
\label{fig:Bdpq_moment_image}
\end{figure}

\begin{definition}
    \label{def:bdpq}
    Let $B_{dpq}$ be the symplectic manifold having $\Delta_{dpq}$ as almost toric base diagram.
\end{definition}

We think of $q$ as an element of $ℤ_p/{±1}$, as different choices of representative for $q$ are related by a $\GL(2,ℤ)$ transformation, giving a symplectomorphism of the corresponding symplectic manifolds in \cref{def:bdpq}.

Such a symplectic manifolds exists, see \cite[Section 7.4]{evans2021atfs} and is thus unique by \cite[Theorem 8.5]{evans2021atfs}. 

\begin{remark}
    The symplectic manifold $(B_{dpq}, \omega)$ is exact.
    Indeed, \cite[Lemma 7.11]{evans2021atfs} shows that there is a set of generators of $H_2(B_{dpq})$ represented by Lagrangian spheres, meaning that $[\omega] = 0 \in H^2(B_{dpq};\mathbb{R})$.
The space $B_{dpq}$ can be realized as the Milnor fibre of a smoothing of certain cyclic quotient singularities.
For more details on this, see \cite[Section 7.4]{evans2021atfs} or \cite{Eva19}.
\end{remark}

Note that $\Delta_{dpq}$ depends on $d$ parameters $n_1>\ldots>n_d > 0$ which correspond to the $x$-coordinate of the position of the nodes.
The symplectic manifold in \cref{def:bdpq} is independent of the position of the nodes, which is why we suppress the dependency on the $n_i$ in the notation.
Indeed, any configuration of $d$ nodes on a common eigenline is related to any other such configuration by nodal slide.
By \cite[Theorem 8.10]{evans2021atfs}, this means that the space $B_{dpq}$ is well-defined up to symplectomorphism.

We turn to the almost toric fibres of $B_{dpq}$.
For every $x \notin R$, we denote the corresponding almost toric fibre by $T(x) \subset B_{dpq}$.
This definition is independent of the position of the nodes in $\Delta_{dpq}$ by \cref{thm:nodal_slide}.
In case $x \in R$, the definition depends on how many nodes are to the right and to the left of $x$:

For every $a > 0$ and $k \in \{0,\ldots,d\}$, let $x_a = \left( a,\frac{aq}{p} \right) \in R$ and $\Delta_{dpq}$ be an almost toric base diagram as above for which $k$ of the $d$ nodes are to the left of the point $x_a$ and that $x_a$ is not a node (As in \cref{fig:our_tori}).

\begin{figure}
  \centering
  \begin{tikzpicture}
    \begin{scope}[shift={(-5,0)}]
      \draw[fill,opacity=0.1] (0,-1) rectangle (4,2);
      \draw[thick] (0,-1) -- (0,2);
      \draw[dashed] (1,0.5) node[cross] {} -- (2,1) node[cross] {} -- (3,1.5) node[cross] {} -- (4,2);
      \draw[black!60,text=black] (1.5,-1) -- (1.5,2.1) node[anchor=south] {$x_1 = a$};
      \draw[fill] (1.5,0.75) circle[radius=1pt] node[anchor=north west] {$x_a$};
      \draw (2,-1) node[anchor=north] {$π^{-1}(x_a) = T^1_{pq}(a)$};
    \end{scope}
    \begin{scope}[shift={(0,0)}]
      \draw[fill,opacity=0.1] (0,-1) rectangle (4,2);
      \draw[thick] (0,-1) -- (0,2);
      \draw[dashed] (0.5,0.25) node[cross] {} -- (1,0.5) node[cross] {} -- (2.5,1.25) node[cross] {} -- (4,2);
      \draw[black!60,text=black] (1.5,-1) -- (1.5,2.1) node[anchor=south] {$x_1 = a$};
      \draw[fill] (1.5,0.75) circle[radius=1pt] node[anchor=north west] {$x_a$};
      \draw (2,-1) node[anchor=north] {$π^{-1}(x_a) = T^2_{pq}(a)$};
    \end{scope}
  \end{tikzpicture}
  \caption{Modifying $Δ_{dpq}$ by a nodal slide for \cref{def:our_tori}. The type of the Lagrangian torus changes when moving the node across its base point.}
  \label{fig:our_tori}
\end{figure}

\begin{definition}
  \label{def:our_tori}
    Let $a>0$ and $k \in \{0,\ldots,d\}$.
We denote by $T^k_{pq}(a) = T(x_a)$ the regular almost toric fibre of a fibration whose almost toric base diagram has $k$ of the $d$ nodes to the left of $x_a$. 
\end{definition}

Again, by \cref{thm:nodal_slide}, this definition does not depend on the precise position of the nodes, only on the natural number $k$, i.e.\ the number of nodes to the left of $x_a$.
In \cref{sec:main_thm}, we show that there is no symplectomorphism of $B_{dpq}$ mapping $T^k_{pq}(a)$ to $T^{k'}_{pq}(a)$ if $k \neq k'$.

\begin{definition}
    \label{def:partial_embedding}
    A \textbf{partial $B_{dpq}$\-/embedding} into a symplectic manifold $(X,\omega)$ is a symplectic embedding $φ\colon B_{dpq} ⊃ U → (X,ω)$, where $U$ 
    \begin{enumerate}
        \item is connected, 
        \item contains a set of the form $\pi^{-1}(W)$, where $W \subset \Delta_{dpq}$ is a neighbourhood of a line segment containing the origin $(0,0) \in \Delta_{dpq}$ and all nodes.
 See \cref{fig:partial-Bdpq-embedding}.   
    \end{enumerate}
\end{definition}

\begin{remark}
  In the introduction we used a slightly different definition of a partial $B_{dpq}$\-/embedding, namely defining a partial $B_{dpq}$\-/embedding as an embedding of a neighbourhood of the Lagrangian skeleton $S$ of $B_{dpq}$, as described in \cite[Remark 7.10]{evans2021atfs}.

  Indeed, the two are equivalent:
  Obviously \cref{def:partial_embedding} gives a neighbourhood of the Lagrangian skeleton.
  For the other direction, we need to construct an almost toric moment map satisfying 2.\ in \cref{def:partial_embedding}.
  Let $L$ be the lens space $L(dp²,dpq-1)$, and $CL$ the cone over it.
  $B_{dpq} ∖ S$ is symplectomorphic to $C L ∖ \{ ⋆\}$, where $⋆$ is the orbifold point in $CL$.
  $CL$ has a toric moment map which is smooth except at $⋆$, which can be pulled back to $B_{dpq}$ and perturbed slightly to give an almost toric moment map with the desired properties.
  See \cite{Eva19} for some more details.
\end{remark}

\begin{figure}
    \centering
    \begin{tikzpicture}
  \draw[thick] (0,-1) -- (0,2);
  \clip (0,-1) rectangle (4,2);
  \fill[opacity=0.1] (0,-1) rectangle (4,2);
  \fill[opacity=0.4, text opacity=1, blue] (0,-0.5) .. controls +(1,0.5) and +(0,-0.2) .. node[anchor=north] {$W$} (3.5,1.75) .. controls +(0,0.2) and +(1,0.5) .. (0,0.5);
  \draw[dashed] (1,0.5) node[cross] {} -- (2,1) node[cross] {} -- (3,1.5) node[cross] {} -- (4,2);
\end{tikzpicture}  
    \caption{$W$ in the definition of a partial $B_{dpq}$ embedding.}
    \label{fig:partial-Bdpq-embedding}
\end{figure}

\subsection{Almost toric base diagrams revisited}
\label{sec:atf_base_diagrams}

Let $π:X → Δ$ be an almost toric moment map.
In \cref{sec:atgeometry} we required that the branch cut of a node in $Δ$ coincides with its eigendirection.
This allows us to give a more detailed description of $Δ$.

\begin{figure}
  \centering
  \begin{tikzpicture}[scale=2]
      \draw[fill,fill opacity=0.1,thick] (-1,2) -- (-1,1) -- (0,0) -- (2,1) -- +(0.66,1);
      \draw[dashed] (0,0) -- +(0,0.66) node[cross] {} (0,0) -- +(0.66,0.66) node[cross] {};
%      \draw[dashed] (-1,1) -- +(0.5,0) node[cross] {};
      \draw[dashed] (2,1) -- +(0,0.66) node[cross] {};
  \end{tikzpicture}
  \caption{In our terminology, this almost toric base diagram has three vertices, one Delzant-vertex, one isolated ATF-corner and two non-isolated ATF-corners (meeting at the lower vertex).}
  \label{fig:atf_example2}
\end{figure}

$Δ$ is a rational not necessarily compact polygon\footnote{An intersection of half-spaces of the form $H_{v,c} = \{x ∈ ℝ² | ⟨x,v⟩+c > 0\}$ with $v ∈ ℤ², c ∈ ℝ$.} with two types of vertices: Either a Delzant-vertex $x ∈ ∂Δ$, i.e.\ the primitive vectors $u_1,u_2$ pointing along the two edges emerging at the vertex form a $ℤ$-basis of $ℤ²$, with no branch cut intersecting $∂Δ$ at $x$. See e.g.\ \cref{fig:atf_example2}.
Or $x$ is the intersection of one or multiple branch cuts with $∂Δ$:

\begin{definition}
  \label{def:atf_corner}
  An \textbf{ATF-corner} of $Δ$ is a pair $(x,dv)$ consisting of a vertex $x ∈ ∂Δ$ and a branch cut intersecting $x$.
  By $v ∈ ℤ²$, we denote the primitive vector along the chosen branch cut which points from $x$ into the interior of $\Delta$.
  By $d \in \mathbb{N}$, we denote the number of nodes on that branch cut.
An ATF-corner $(x,dv)$ is \textbf{isolated} if it is the only ATF-corner at the vertex $x$. 
\end{definition}

Let $(x,dv)$ be an ATF-corner of $Δ$ and $u_1,u_2$ be the primitive vectors pointing along the edges emerging from $x$.
Using \cref{thm:change_branchcut}, we may perform a change of branch cut at each node belonging to $(x,dv)$, thus obtaining the almost toric base diagram $Δ' = \overline{S}_{dv}Δ$.
We may assume that $u_1$ lies in the fixed half plane of $\overline{S}_{dv}$.
If $(x,dv)$ is isolated, then in $Δ'$ there is no branch cut intersection with $∂Δ'$ at $x$, so either $u_1 = -S_{dv}u_2$ or $u_1$ and $S_{dv}u_2$ form a Delzant vertex.
By a nodal trade we can assume that the last case does not appear.
The case for non-isolated ATF-corners at $x ∈ ∂Δ$ is similar, if we change the branch cut at all ATF-corners at $x$, we should map $u_1,u_2$ onto parallel vectors, such that the vertex $x ∈ ∂Δ$ is mapped to the interior of an edge.
Note that we can always \textbf{isolate} an ATF-corner at $x$ by changing the branch cut for all other ATF-corners at $x$.

Performing a change of branch cut for all nodes in $Δ_{dpq}$ we get a different almost toric base diagram $Δ'_{dpq}$ for $B_{dpq}$ with an ATF-corner $(0,d(p,q))$, see \cref{fig:Bdpq_moment_image_alt}.
By a change of basis, any isolated ATF-corner $(x,dv)$ can be locally mapped by an element of $\GL(2,ℤ)$ to $Δ'_{dpq}$ for an appropriate choice of $p,q$.

\begin{figure}
\centering
\begin{tikzpicture}
  \begin{scope}[shift={(-5,0)}]
    \draw[thick] (0,-1) -- (0,2);
    \draw[fill,opacity=0.1] (0,-1) rectangle (4,2);
    \draw[dashed] (1,0.5) node[cross] {} -- (2,1) node[cross] {} -- (3,1.5) node[cross] {} -- (4,2);
    \draw (2,-1) node[anchor=north] {$Δ_{dpq}$};
  \end{scope}
  \begin{scope}[shift={(0,0)}]
    \fill[opacity=0.1] (0,2) -- (0,0) -- (4,1.3) -- (4,2);
    \draw[thick] (0,2) -- (0,0) -- (4,1.3);
    \draw[dashed] (0,0) -- (1,0.5) node[cross] {} -- (2,1) node[cross] {} -- (3,1.5) node[cross] {};
    \draw (2,-1) node[anchor=north] {$Δ'_{dpq}$};
  \end{scope}
\end{tikzpicture}   
\caption{Changing the branch cut in $Δ_{dpq}$ to get an ATF-corner.}
\label{fig:Bdpq_moment_image_alt}
\end{figure}

\begin{definition}
  \label{def:atf_corner_type}
  We say the ATF-corner $(x,dv)$ is of \textbf{type $(d,p,q)$}, if (perhaps after isolating it) it locally maps via a $\GL(2,ℤ)$ transformation into $Δ'_{dpq}$. More precisely, there is an integral affine bijection $A\colon U → V$ where $U ⊂ Δ$ is a neighbourhood of the branch cut of $(x,dv)$ and $V ⊂ Δ'_{dpq}$ is a neighbourhood of the branch cut of $(0,d(p,q))$.
\end{definition}

In this sense the spaces $B_{dpq}$ are the "local models" for any almost toric fibration, as we can obtain the total space $X$ by glueing together different $B_{dpq}$ models.

\begin{lemma}
  \label{thm:atf_bdpq}
  If $Δ$ has an ATF-corner of type $(d,p,q)$, then there is a partial $B_{dpq}$\-/embedding into $X$.
\end{lemma}

\begin{remark}
  \label{rem:atf_corner_type_calc}
  We can calculate the type of an ATF-corner $(x,dv)$ as follows: Take $u_1$ to be the primitive vector pointing from $x$ along $∂Δ$ such that $\interior{Δ}$ lies to the left of $u_1$, and $u_2$ such that $u_1,u_2$ is a positively oriented $ℤ$-basis of $ℤ²$.
Then $p=\det(u_1,v)$ and $q = \det(u_2,v)$.
\end{remark}

\section{Versal deformations \& nearby Lagrangians}
\label{sec:vds}

In this section we give a self contained introduction to versal deformations.
Versal defomations were previously used in \cite{brendel2020real,brendel2023local,CheSch10} and introduced in \cite{Che96}.

\subsection{Lagrangian flux}
\label{sec:lagflux}

The goal of this subsection is to introduce the Lagrangian flux.
This notion is described in \cite[Section 2.4]{evans2021atfs} in the context of Lagrangian torus fibrations, and the proofs in this section are similar to the exposition in \cite[Section 10.2]{McDuffSalamonSympTop}, which introduces the notion of symplectic flux.

Let $\symcal{L}$ the space of Lagrangians in $X$ equipped with the $\symcal{C}^1$-topology.
See \cite{ono2008LagrangianFlux} for more details on the $\symcal{C}^1$-topology on the space of Lagrangians. 
For the remainder of this section we fix a compact Lagrangian $L_0 ⊂ (X,ω)$.

\begin{definition}
  A \textbf{Lagrangian isotopy} based at $L_0$ is a map $\Lambda \colon [0,1] \rightarrow \symcal{L}, t \mapsto \Lambda_t$ with $\Lambda_0 = L_0$ such that \ there is a smooth map $[0,1] \times L_0 \rightarrow X$ which maps $\{t\} \times L_0$ to $\Lambda_t$.

  Note that we can always find a smooth isotopy $φ \colon [0,1] × X → X$ such that\ $φ_t(L_0) = Λ_t$.
  In this case we say that \textbf{$Λ$ is generated by $φ$}.
\end{definition}

By $\symcal{L}_{L_0} ⊂ \symcal{L}$, we denote the set of Lagrangians which are Lagrangian isotopic to $L_0$.
Denote by $\widetilde{\symcal{L}}_{L_0}$ the universal cover of $\symcal{L}_{L_0}$, that is the space of Lagrangian isotopies of $L_0$ up to endpoint preserving isotopies.
Using Weinstein's Lagrangian neighbourhood theorem, one can check that $\symcal{L}_{L_0}$ is locally simply connected, showing that $\widetilde{\symcal{L}}_{L_0} \rightarrow \symcal{L}_{L_0}$ is indeed the universal cover.

\begin{definition}
  \label{def:flux_map}
  Let $Λ \colon ([0,1],0) → (\symcal{L}_{L_0},L_0)$ be a Lagrangian isotopy.
Its \textbf{(Lagrangian) flux} is the map
$$    H_1(L_0) → ℝ, \quad    ξ ↦  ∫_{C_ξ} ω, $$
where $C_ξ$ is a cylinder swept out under $\Lambda$ by a representative of $ξ$ in $L_0$.
We call $C_ξ$ a \textbf{flux cylinder of $ξ$ over $Λ$}.
This map is well-defined, i.e. independent of the choice of $C_ξ$, and independent under endpoint preserving isotopies of $Λ$, see \cite[Lemma 6.1]{Sol13}.

  Using $\Hom(H_1(L_0),ℝ) = H^1(L_0;ℝ)$ this yields a well defined map
  \[ \Flux \colon \widetilde{\symcal{L}}_{L_0} → H^1(L_0;ℝ) \; ,\]
  called the \textbf{flux map}.
\end{definition}

\begin{lemma}
  \label{thm:hamiltonian_flux}
  A Lagrangian isotopy $Λ$ is generated by a Hamiltonian isotopy if and only if  $\Flux(Λ_s|_{s ∈ [0,t]}) = 0$, $∀t ∈ [0,1]$.
\end{lemma}

\begin{proof}
It is shown in \cite[Corollary 6.4]{Sol13} that the second condition is equivalent to $Λ$ being an exact Lagrangian isotopy.
This in turn is equivalent to $Λ$ being generated by a Hamiltonian isotopy, see e.g.\ \cite[Exercise 6.1.A]{Pol01}.
\end{proof}

Let $\symcal{V} \subset \symcal{L}_{L_0}$ be a simply-connected neighbourhood of $L_0$.
Then we define the \textbf{local flux map on $\symcal{V}$} by setting 
\begin{equation}
    \label{eq:localflux}
    \Flux_{\symcal{V}} = \Flux \vert_{\symcal{V_0}}, 
\end{equation}
where we identify $\symcal{V}$ with its lift $\symcal{V_0} ⊂ \widetilde{\symcal{L}}_{L_0}$ containing the constant loop at $L_0$.

\subsection{\texorpdfstring{$T^* L_0$}{T*L} and graphs of 1-forms} 
\label{sec:vdcotangent}

Let us look at the case $(X,ω)=(T^* L_0,d λ)$, where $L_0 ⊂ T^* L_0$ denotes the zero section and $λ$ is the tautological 1-form.
Recall from \cite{McDuffSalamonSympTop} that for any $α ∈ Ω^1(L_0)$, the graph $Γ_α$ of $α$ is Lagrangian if and only if $d α=0$.

\begin{lemma}
  \label{thm:graph_flux}
  Let $α ∈ Ω^1(L_0)$ be closed and $Λ_t$ be a Lagrangian isotopy from the zero section $L_0$ to the graph $Γ_α$ of $α$.
Then $\Flux(Λ_t) = [α]$.
\end{lemma}
\begin{proof}
  Let $ξ$ be a 1-cycle in $L_0$, $C_ξ$ the flux cylinder over $Λ$ and $\varphi_t \colon T^*L_0 \rightarrow T^*L_0$ an isotopy generating $\Lambda$.
Then $∂C_ξ = (\varphi_1\vert_{L_0})_* ξ - ξ$, on the level of homology.

The maps $(\varphi_1\vert_{L_0})_*, \alpha_* \colon H_1(L_0) \rightarrow H_1(\Gamma_{\alpha})$ agree:
The bundle projection induces an isomorphism $\pi_* \colon H_1(Γ_α) \rightarrow H_1(L_0)$ and $\alpha_* = (\pi_*)^{-1}$. Furthermore, the family of maps $\pi \circ \varphi_t\vert_{L_0}$ induces the identity on homology for every $t$, since it does so at $t=0$.

We conclude that $∂C_ξ = α_* ξ - ξ$ and compute
  \[⟨\Flux(Λ_t),ξ ⟩ = ∫_{C_ξ} dλ = ∫_{∂C_ξ} λ = ∫_{α_* ξ}λ - ∫_{ξ} λ = ∫_{ξ} α^* λ = ∫_{ξ} α = ⟨α,ξ⟩ \;.\]
\end{proof}

\begin{lemma}
  \label{thm:graph_hamiltonian_isotopic}
  Let $\alpha,\beta \in  \Omega^1(L_0)$ be closed $1$-forms.
Their graphs $\Gamma_{\alpha}, \Gamma_{\beta}$ are Hamiltonian isotopic if and only if $[\alpha] = [\beta]$.
\end{lemma}
\begin{proof}
If $[\alpha] = [\beta]$, the linear isotopy $\Lambda_t = Γ_{(1-t)α + t β}$ is a Lagrangian isotopy with $\Flux(Λ_s|_{s ∈ [0,t]}) = 0$ for all $t \in [0,1]$.
Therefore $\Lambda$ is generated by a Hamiltonian isotopy by \cref{thm:hamiltonian_flux}.

  Assuming that the graphs $Γ_α$ and $Γ_β$ are Hamiltonian isotopic, we can extend a Lagrangian isotopy from $L_0$ to $Γ_α$, for example given by $Γ_{tα}$, by the Hamiltonian isotopy from $Γ_α$ to $Γ_β$ to get a Lagrangian isotopy $Λ_t$ from the zero section to $Γ_β$.
By \cref{thm:hamiltonian_flux} adding the Hamiltonian part does not change the flux map, so $[α] = \Flux(Λ_t) = [β]$, by \cref{thm:graph_flux}.
\end{proof}

Recall that $\symcal{L}_{L_0}$ denotes the space of Lagrangians isotopic to $L_0$ (here it is the zero-section $L_0 \subset T^*L_0$).
Let $\symcal{L}_Γ ⊂ \symcal{L}_{L_0}$ be the subspace of graphs of closed 1-forms.
Recall also that, a priori, the flux map is defined on the universal cover of~$\symcal{L}_{L_0}$.

\begin{corollary}
  \label{thm:cotangent_classification}
  The subspace $\symcal{L}_Γ$ contains a neighbourhood of $L_0 \in \symcal{L}_{L_0}$ (by the definition of the $\symcal{C}^1$-topology) and therefore $\Flux$ yields a well-defined (by \cref{thm:graph_flux}) map
\[ \Flux_Γ \colon \symcal{L}_Γ → H^1(L_0;ℝ), \]
which classifies elements in $\symcal{L}_Γ$ up to Hamiltonian isotopy (by \cref{thm:graph_hamiltonian_isotopic}).\footnote{In fact Ono \cite[Proposition 2.3]{ono2008LagrangianFlux} allows to replace $\symcal{L}_Γ$ by $\symcal{L}_{L_0}$ in this statement in the case of the cotangent bundle.
We do not need this stronger statement for our purposes.}
\end{corollary}

\subsection{Versal deformations}
\label{sec:versal_deformations}

Let us return to the case of a general symplectic manifold $(X,\omega)$.
Then $L_0$ admits an embedding of a Weinstein-neighbourhood $φ\colon T^*L_0 \dashrightarrow X$, where "$\dashrightarrow$" means that the map is only defined near the zero-section, which means that we can hope to prove a local result analogous to \cref{thm:cotangent_classification}.
Since the proof of \cref{thm:graph_hamiltonian_isotopic} relies on a linear interpolation of $1$-forms, we introduce the following notion.

\begin{definition}
    A neighbourhood $\symcal{U} \subset \symcal{L}_{L_0}$ of $L_0$ is called \textbf{Weinstein convex} if there is a Weinstein chart $φ\colon T^*L_0 \dashrightarrow X$ of $L_0$ such that every $L ∈ \symcal{U}$ can be written as $φ(Γ_α)$ for some closed 1-form $α ∈ Ω¹(L_0)$, and $\symcal{U}$ is convex with respect to the linear structure inherited from $Ω^1(L_0)$ via $φ$.
    Such a pair $(\symcal{U},φ)$ is called \textbf{Weinstein convex pair}.
\end{definition}

By the definition of the $C^1$-topology on $\symcal{L}_{L_0}$, every neighbourhood of $L_0$ in $\symcal{L}_{L_0}$ contains a Weinstein convex neighbourhood.
Note that Weinstein convex sets are simply connected.
Hence, the local flux map \eqref{eq:localflux} makes sense on them.

\begin{proposition}
  \label{thm:local_classification}
  Let $\symcal{U}$ be Weinstein convex.
  The map $\Flux_{\symcal{U}}$ classifies $\symcal{U}$ up to Hamiltonian isotopies contained in $\symcal{U}$.
  By this we mean that $L_1, L_2 \in \symcal{U}$ are Hamiltonian isotopic by a Hamiltonian isotopy through $\symcal{U}$ if and only if $\Flux_{\symcal{U}}(L_1) = \Flux_{\symcal{U}}(L_2)$.
\end{proposition}
\begin{proof}
  This is essentially \cref{thm:cotangent_classification}.
The fact that $\symcal{U}$ is convex guarantees that the linear Hamiltonian isotopy of \cref{thm:graph_hamiltonian_isotopic} between $L_1$ and $L_2$ is completely contained in $\symcal{U}$.
\end{proof}

A versal deformation is a continuous "local section of the flux map":

\begin{definition}
  \label{def:versal_deformation}
  A continuous map $v_{L_0} \colon H^1(L_0;ℝ) \dashrightarrow \symcal{L}_{L_0}$,\footnote{The $\dashrightarrow$ denotes that it is only defined on some neighbourhood of $0$} is called \textbf{versal deformation of $L_0$} if for every simply connected neighbourhood $\symcal{U} ⊂ \symcal{L}_{L_0}$ of $L_0$ there exists an open neighbourhood $V$ of $0 ∈ H^1(L_0;ℝ)$ with $\Flux_{\symcal{U}} ∘ v_{L_0}|_V = \id$.
\end{definition}

By continuity of $v_{L_0}$, the neighbourhood $V$ can be chosen small enough for $v_{L_0}(V)$ to be contained in $\symcal{U}$.
Therefore, this definition makes sense.

\begin{remark}
  \label{rem:lazy_vd}
  It is sufficient that the condition in \cref{def:versal_deformation} is satisfied for one simply connected neighbourhood $\symcal{U} ⊂ \symcal{L}_{L_0}$:
  If $\symcal{V}$ is any other simply connected neighbourhood of $L_0$, then, since $\symcal{L}_{L_0}$ is locally simply connected, there is a simply connected neighbourhood $\symcal{W} ⊂ \symcal{U} ∩ \symcal{V}$, and, since $v_{L_0}$ is continuous, restricting $V$ appropriately gives the result.
\end{remark}

\begin{lemma}
  \label{thm:vd_existence}
  A versal deformation exists.
\end{lemma}
\begin{proof}
  Let $(\symcal{U},φ)$ be a Weinstein convex pair of $L_0$ and $α_1,…,α_d ∈ Ω^1(L_0)$ be a set of closed $1$-forms inducing a basis of $H¹(L_0;ℝ)$.
Set 
  \[
        v_{L_0}(b) = \varphi( \Gamma_{b_1[\alpha_1] + \ldots + b_d[\alpha_d]} ), \quad
        b = \sum_{i=1}^d b_i [\alpha_i] \in H^1(L_0; \mathbb{R}),
  \]
  where we have chosen a small enough domain for this definition to make sense.

  Now $\symcal{U}$ is simply connected, and by \cref{thm:graph_flux} we have $\Flux_{ \symcal{U}} ∘ v_{L_0} = \id$.
  So by \cref{rem:lazy_vd}, $v_{L_0}$ is a versal deformation.
\end{proof}

\begin{lemma}
  \label{thm:vd_hamiltonian_isotopy}
  If $v_{L_0}, v_{L_0}'$ are two versal deformations, there is a neighbourhood $V ⊂ H^1(L_0;ℝ)$ of $0$, such that $∀ α ∈ H^1(L_0;ℝ)$ the two Lagrangians $v_{L_0}(α)$ and $ v_{L_0}'(α)$ are Hamiltonian isotopic.
\end{lemma}
\begin{proof}
  Let $\symcal{U}$ be simply connected and $V$ such that $\Flux_{ \symcal{U}} ∘ v_{L_0}|_V = \Flux_{ \symcal{U}} ∘ v_{L_0}'|_V = \id$.
  Additionally shrinking $V$ we may assume that $\symcal{U}$ is Weinstein convex.
  Then for $α ∈ V$, by \cref{thm:local_classification} the result follows since $\Flux_{ \symcal{U}}(v_{L_0}(α)) = \Flux_{ \symcal{U}}(v_{L_0}'(α))$.
\end{proof}

Colloquially we might say that a versal deformation parametrizes all nearby Lagrangians up to local Hamiltonian isotopy by a neighbourhood of zero in $H^1(L_0;ℝ)$.

Let $I \colon \symcal{L} → A$ be a symplectic invariant of Lagrangian submanifolds, meaning that $I(φ(L)) = I(L)$ for all $φ \in \operatorname{Symp}(X,\omega)$.
Any versal deformation $v_{L_0}$ gives rise to a function $I \circ v_{L_0}$.
By \cref{thm:vd_hamiltonian_isotopy} and symplectic invariance of $I$, the germ of this function is independent of the choice of versal deformation.

\begin{definition}
    \label{def:invariant_germs}
    Let $L_0 \subset X$ be a compact Lagrangian, $v_{L_0}$ a versal deformation thereof and $I$ a symplectic invariant of Lagrangian submanifolds.
By abuse of terminology, the germ of $I \circ v_{L_0}$ at $0 \in H^1(L_0;\mathbb{R})$ is called the \textbf{germ of $I$ at $L_0$}.
It is denoted by 
    \[
    [I]_{L_0} \colon H^1(L_0;ℝ) \dashrightarrow A \; .
  \]
\end{definition}

\begin{proposition}
  \label{thm:invariant_germs}
  If $φ$ is a symplectomorphism, then
  \[
    [I]_{φ(L_0)} = [I]_{L_0} ∘ φ^* \; ,
  \]
  where $φ^*$ denotes the induced map on cohomology.

  Consequently, if there is no isomorphism $Φ \colon H^1(L';ℤ) → H^1(L;ℤ)$ such that $[I]_L ∘ Φ = [I]_{L'}$ there is no symplectomorphism $φ$ with $φ(L) = L'$.
\end{proposition}

\begin{proof}
  Let $v$ be a versal deformation of $L_0$.
  Then $v_φ = φ ∘ v ∘ φ^*$ is a versal deformation of $φ(L_0)$.
  We have the following commutative diagram:
  \[\begin{tikzcd}[column sep=tiny]
  H^1(L_0;ℝ) \dar{v} & & H^1(φ(L_0);ℝ) \dar{v_φ} \ar[ll, swap, "φ^*"] \\
  \symcal{L} \ar[rr, "φ"] \ar[dr, swap, "I"] & & \symcal{L} \ar[dl, "I"] \\
                                     & A &
    \end{tikzcd}\]
  where the top square commutes by definition of $v_φ$, and the bottom triangle commutes since $I$ is invariant under symplectomorphisms.
\end{proof}

\subsection{Versal deformations of (almost) toric fibres}
\label{sec:vd_AL}

Let $\mu \colon U \rightarrow \mathbb{R}^n$ be the moment map of an effective Hamiltonian $T^n$-action defined on a subset $U \subset (X,\omega)$ of a symplectic manifold.
Such a local moment map can be constructed, for example, in the neighbourhood $U$ of a regular fibre of a completely integrable system by the Arnold--Liouville theorem.
In that case, $\mu$ corresponds to action coordinates.
Let $L = \mu^{-1}(x_0)$ be a regular fibre of $\mu$.
Since $L$ is diffeomorphic to a torus and $H^1(L;\mathbb{R}) \cong \mathbb{R}^n$, we expect an $n$-dimensional versal deformation.
It is therefore natural to look at neighbouring fibres, i.e.\ Lagrangian tori of the form $\mu^{-1}(x_0 + a)$ for small $a \in \mathbb{R}^n$.
By \cref{def:versal_deformation} neighbouring Lagrangians in a versal deformation are parametrized by their Lagrangian flux.
In fact, the local moment map coincides with the flux map, restricted to fibres $\mu^{-1}(x)$, see for example \cite[Lemma 2.15]{evans2021atfs}.
In the language of versal deformations, this observation yields the following.

\begin{proposition}
\label{thm:VDtoricfibre}
    Let $L = \mu^{-1}(x_0)$ be a regular fibre of a (locally defined) toric moment map $\mu$.
Then
    \begin{equation}
        \label{eq:VDtoricfibre}
        v_{L} \colon H^1(L;\mathbb{R}) \cong \mathbb{R}^n \dashrightarrow \symcal{L}_L, \quad
        v_{L}(a) = \mu^{-1}(x_0 + a)
    \end{equation}
    is a versal deformation of $L$. 
\end{proposition}

The components $\mu_i$ of the moment map $\mu$ generate $n$ closed orbits in $L$, which yield a natural identification $H_1(L) \cong \mathbb{Z}^n \subset \mathbb{R}^n$.
Dually, we obtain an identification $H^1(L;\mathbb{R}) \cong \mathbb{R}^n$ used in \eqref{eq:VDtoricfibre}.
For the sake of completeness, we include a proof of \cref{thm:VDtoricfibre}.

\begin{proof}
    Let $\symcal{U}$ be a simply connected neighbourhood of $L \in \symcal{L}_{L}$.
    Pick an open convex neighbourhood $V \subset \operatorname{im} \mu$ of $x_0$ such that $\mu^{-1}(x) \in \symcal{U}$ for all $x \in V$.
    By \cref{def:versal_deformation}, it suffices to show $\operatorname{Flux}_{\symcal{U}} \circ v_L\vert_{V} = \id$ to prove that \eqref{eq:VDtoricfibre} defines a versal deformation.
    Let $a \in H^1(L;\mathbb{R}) \cong \mathbb{R}^n$ such that $x_0 + a \in V$.
Then 
    \begin{equation}
        \operatorname{Flux}_{\symcal{U}} ( v_L\vert_{V} (a))
        = \operatorname{Flux}_{\symcal{U}} (\mu^{-1}(x_0 + a))
        = \operatorname{Flux} \{t \mapsto \mu^{-1}(x_0 + ta) \}_{t \in [0,1]}.
    \end{equation}
    The Lagrangian isotopy $\Lambda = \{t \mapsto \mu^{-1}(x_0 + ta) \}_{t \in [0,1]}$ is contained in $\symcal{U}$ by the convexity and the choice of $V \subset \operatorname{im} \mu$.
    The last equality follows from the definition \eqref{eq:localflux} of $\operatorname{Flux}_{\symcal{U}}$ and the fact that we can homotope any given Lagrangian isotopy in $\symcal{U}$ with endpoints $L$ and $\mu^{-1}(x_0 + a)$ to $\Lambda$ by the fact that $\symcal{U}$ is simply connected. 

    Let $ξ \in H_1(L)$, then we define the following flux cylinder (as in \cref{def:flux_map}) of $\xi$ over $\Lambda$, 
    \begin{equation}
        C_{\xi} \colon [0,1] \times S^1 \rightarrow X, \quad
        (t,s) \mapsto φ_s(\gamma(t)),
    \end{equation}
    where $\gamma \colon [0,1] \rightarrow X$ is a smooth path satisfying $\mu(\gamma(t)) = x_0 + ta$ and $φ_s$ is the flow of the $S^1$-moment map $H_{\xi} = \langle \mu , \xi \rangle$.
    This expression makes sense under the identification $H_1(L) \cong \mathbb{Z}^n$ via orbits of the moment map, and implies that $[\partial C_{\xi} \cap L] = \xi$.
    We have $C_{\xi}(\{t\} \times S^1) \subset \Lambda_t$ showing that $C_{\xi}$ defines a flux cylinder with the desired properties.
    Denoting the Hamiltonian vector field of $H_{\xi}$ by $X_{\xi}$, we compute
    \begin{align*}
        \langle \operatorname{Flux} \Lambda , \xi \rangle
        &= \int_{C_{\xi}} \omega \\
        &= \int_0^1 \int_0^1 \omega\qty(\qty(X_{\xi} \circ φ_s \circ \gamma)(t) , \qty(φ_s)_*\dot{\gamma}(t) ) ds \, dt \\
        &= \int_0^1 \int_0^1 dH_{\xi}\vert_{φ_s(\gamma(t))} (φ_s)_*\dot{\gamma}(t) ds\, dt \\
        &= \int_0^1 dH_{\xi}\vert_{\gamma(t)} (\dot{\gamma}(t))dt \\
        &= \int_0^1 \frac{d (H_{\xi} \circ \gamma)}{dt} (t) dt \\
        &= H_{\xi}(\gamma(1)) - H_{\xi}(\gamma(0)) \\
        &= \langle \mu(\gamma(1)) - \mu(\gamma(0)), \xi \rangle \\
        &= \langle a , \xi \rangle,
    \end{align*}
which proves the claim.
\end{proof}


In this paper we are mainly interested in the case where $\mu$ is obtained as the restriction of an almost toric moment map, see \cref{thm:toricmomentmap}. 

\begin{corollary}
    \label{thm:VDatffibres}
    Let $\pi \colon X \rightarrow \Delta$ be an almost toric moment map of an almost toric fibration.
    Let $x_0 \in \operatorname{int}\Delta$ be a point which is not a node, nor lies on a branch cut.
    Then $\nu_L(a) = \pi^{-1}(x_0 + a)$, which is defined for small enough $a$, is a versal deformation of the almost toric fibre $L = \pi^{-1}(x_0)$.
\end{corollary}


\subsection{How to distinguish tori using the displacement energy germ}
\label{sec:howto_exotic}

Since this will be the main technique in the proof of \cref{thm:A,thm:B}, let us briefly outline how to combine almost toric fibrations with versal deformations to distinguish Lagrangian tori. 

Let $L \subset (X,\omega)$ be a Lagrangian torus which we suspect to be exotic and let $I(\cdot)$ be a symplectic invariant of Lagrangian submanifolds as in the discussion surrounding \cref{def:invariant_germs}.
All exotic tori known to the authors have the property that most neighbouring tori are themselves Hamiltonian isotopic to standard (non-exotic) tori, e.g.\ product tori in $\mathbb{R}^{2n}$ and toric fibres in toric manifolds.
Therefore, the germ $[I]_L$ can be computed on an open dense set of the origin of $H^1(L;\mathbb{R})$ in the following two steps: 
\begin{enumerate}
    \item[(1)] compute $I(\cdot)$ on the standard tori of $X$, 
    \item[(2)] identify which standard torus a given member $\nu_L(a)$ of the versal deformation is Hamiltonian isotopic to. 
\end{enumerate}
We called this property the \textit{instability of the exotic torus $L$} in \cite{brendel2023local} and refer to \cite[Sections 1.6, 5.1]{brendel2023local} for a further discussion of instability.
In our case, we use the displacement energy $I(\cdot) = e(\cdot)$ as an invariant to distinguish Lagrangian tori, see \cref{sec:lower_bound} for a discussion of $e(\cdot)$.
Since $e(\cdot) \in \mathbb{R} \cup \{+\infty\}$, we obtain a germ $[e]_L \colon H^1(L;\mathbb{R}) \cong \mathbb{R}^n \dashrightarrow \mathbb{R} \cup \{+\infty\}$. 

\begin{definition}
    \label{def:deg_equiv}
    Let $L,L' \subset (X,\omega)$ be Lagrangian tori.
We say that their displacement energy germs $[e]_L,[e]_{L'}$ are \textbf{equivalent}, written $[e]_L \cong [e]_{L'}$, if there is an isomorphism 
    \begin{equation}
        \label{eq:phi_isomorphism}
        Φ \colon H^1(L';\mathbb{Z}) \rightarrow H^1(L;\mathbb{Z}),
    \end{equation}
    such that $[e]_L \circ Φ$ and $[e]_{L'}$ agree on an open neighbourhood of zero in $H^1(L';\mathbb{R})$.
    
    If they agree only on an open dense set intersecting each neighbourhood of $0$, we say they are \textbf{roughly equivalent}, and write $[e]_L \sim [e]_{L'}$.
\end{definition}

Note that $[e]_L \nsim [e]_{L'}$ implies $[e]_L \ncong [e]_{L'}$.

In examples, we work with identifications $H^1(L';\mathbb{R}) \cong H^1(L;\mathbb{R})\cong \mathbb{R}^n$ induced by a choice of basis $H_1(L) \cong H_1(L') \cong \mathbb{Z}^n$, in which case the isomorphism \eqref{eq:phi_isomorphism} corresponds to an automorphism $Φ \in \operatorname{GL}(n;\mathbb{Z})$.
The following is an immediate consequence of \cref{thm:invariant_germs}.

\begin{proposition}
    \label{thm:not_equiv}
     Let $L,L' \subset X$ be Lagrangian tori with $[e]_L \ncong [e]_{L'}$.
Then there is no symplectomorphism of $X$ mapping $L$ to $L'$. 
\end{proposition}

Computing the displacement energy germ is particularly easy for almost toric fibres.
Firstly because every regular almost toric fibre has a natural versal deformation by \cref{thm:VDatffibres} and secondly because in an almost toric fibration, it is particularly easy to identify which standard torus a versal deformation is Hamiltonian isotopic to.
Compare step (2) in the above outline.
Let us illustrate this by means of the basic example of the Chekanov torus in $\mathbb{R}^4 = \mathbb{C}^2$.

Let $μ\colon ℂ² → Δ ⊂ ℝ²$ be the standard moment map on $ℂ$ given by $μ(z_1,z_2)=\qty( \pi\abs{z_1}^2, \pi\abs{z_2}^2)$, with the moment polytope $Δ ⊂ ℝ²$ being the upper right quadrant.
Its toric fibres are the so-called product tori, meaning products of standard circles in the plane.
Using similar techniques as in \cref{sec:upper_bound,sec:lower_bound} we find that the displacement energy of product tori is
\begin{equation}
    \label{eq:DE_prodtori}
        e(T(x)) = \min\{x_1,x_2\}, \quad
        x = (x_1,x_2) ∈ \interior(\Delta).
\end{equation}
This yields the answer to Step (1) in the above outline.

Let $x_0>0$.
As a warm-up to the case of the Chekanov torus, let us compute the displacement energy germs of the product tori $T_{1,1}^1(x_0) = T(x_0,x_0)$ and $T = T(x_0,x_2)$ with $x_2 > x_0$.
The former is the monotone Clifford torus, the notation $T^1_{1,1}$ of which is coherent with the one used in \cref{def:our_tori}, and the latter is a non-monotone product torus.
We use \cref{thm:VDtoricfibre} to find that $b \mapsto T(x+b)$ is a versal deformation of $T(x)$ for any $x \in \interior \Delta$.
Together with \eqref{eq:DE_prodtori}, this yields the displacement energy germs
\begin{equation}
    \label{eq:babyDEG1}
    [e]_{T^1_{1,1}}(b) = x_0 + \min\{ b_1,b_2 \}, \quad
    [e]_{T}(b) = x_0 + b_1,
\end{equation}
where $b \in H^1(T;\mathbb{R}) \cong H^1(T^1_{1,1};\mathbb{R}) \cong \mathbb{R}^2$ using the obvious identifications.
By \cref{thm:invariant_germs}, this shows that $T$ and $T_{1,1}^1$ are distinct up to symplectomorphism of the ambient space\footnote{This also follows from the fact that $T^1_{1,1}$ is monotone, whereas $T$ is not.}, although they both have displacement energy $x_0 > 0$.
See \cref{fig:babys_first_vd} for the level sets of $x \mapsto e(T(x))$ of the corresponding germs.

\begin{figure}
  \centering
  \begin{tikzpicture}
    \begin{scope}[shift={(-1.5,-1.5)}]
      \fill[opacity=0.1] (0,3) rectangle (3,0);
      \draw[thick] (0,3) -- (0,0) -- (3,0);
      \fill (1,1) circle[radius=1pt] node[anchor=west] {$T^1_{1,1}$}
        (1,2) circle[radius=1pt] node[anchor=south] {$T$};
      \foreach \x in {0.2,0.4,...,3}
        \draw[very thin, black!60] (\x,3) -- (\x,\x) -- (3,\x);
    \end{scope}
    \begin{scope}[shift={(3,0)}]
      \draw (0,-1) node[anchor=north] {$[e]_{T}$};
      \clip[draw] (0,0) circle[radius=1];
      \foreach \x in {-1,-0.8,...,1}
        \draw[very thin, black!60] (\x,1) -- (\x,-1);
      \fill (0,0) circle[radius=1pt];
    \end{scope}
    \begin{scope}[shift={(6,0)}]
      \draw (0,-1) node[anchor=north] {$[e]_{T^1_{1,1}}$};
      \clip[draw] (0,0) circle[radius=1];
      \foreach \x in {-1,-0.8,...,1}
        \draw[very thin, black!60] (\x,1) -- (\x,\x) -- (1,\x);
      \fill (0,0) circle[radius=1pt];
    \end{scope}
  \end{tikzpicture}
  \caption{Distinguishing the tori $T$ and $T^1_{1,1}$}
  \label{fig:babys_first_vd}
\end{figure}

Let $\pi \colon \mathbb{C}^2 \rightarrow \Delta$ be the almost toric moment map obtained from the toric case discussed above by performing a nodal trade at the vertex of $\Delta$.
One way of defining the Chekanov torus $T^0_{1,1}(x_0) \subset \mathbb{C}^2$, where $x_0 > 0$ is the area parameter, is as almost toric fibre $\pi^{-1}(x_0,x_0)$.
Note that this definition works for any $x_0 >0$, as using a nodal slide one can arrange for the position of the node to be $(y,y)$ with $y > x_0$.
Let $x \in \interior\Delta$ be a point not contained in the branch cut.
Then, by \cref{thm:nodal_slide}, we find that $\pi^{-1}(x)$ can be mapped by a symplectomorphism to $T(x)$.
Therefore $e(\pi^{-1}(x)) = \min \{x_1,x_2\}$ for such almost toric fibres.
This corresponds to Step (2) in the outline above.
See the upper middle diagram in \cref{fig:babys_second_vd} for the level sets of $x \mapsto e(\pi^{-1}(x))$.
The displacement energy of the Chekanov tori on the branch cut cannot be determined in this way, as they are not symplectomorphic to product tori.
In order to apply \cref{thm:VDatffibres}, we use \cref{thm:change_branchcut} to change the branch cut in order for the Chekanov tori not to lie on the branch cut.
We find
\begin{equation}
    \label{eq:babyDEG2}
    [e]_{T^0_{1,1}}(b) \sim x_0 + b_1,
\end{equation}
by which we mean equality on the open dense subset obtained as the complement of the line formed by Chekanov tori, see \cref{def:deg_equiv} and \cref{fig:babys_second_vd}.
This proves that $T^0_{1,1}$ is exotic, meaning that it cannot be mapped to a product torus by a symplectomorphism.
Indeed, $T^0_{1,1}$ is monotone and hence distinct from any $T(x)$ with $x_2 > x_1$.
The displacement energy germs \eqref{eq:babyDEG1} and \eqref{eq:babyDEG2} together with \cref{thm:not_equiv} show that $T^0_{1,1}$ and $T^1_{1,1}$ are distinct. 

\begin{figure}
  \centering
  \begin{tikzpicture}
    \begin{scope}[shift={(-2,-1.5)}]
      \fill[opacity=0.1] (0,3) rectangle (3,0);
      \draw[thick] (0,3) -- (0,0) -- (3,0);
      \foreach \x in {0.2,0.4,...,3}
        \draw[very thin, black!60] (\x,3) -- (\x,\x) -- (3,\x);
    \end{scope}
    \draw[->] (1.5,0) -- node[anchor=south] {nodal} node[anchor=north] {trade} (2.5,0);
    \begin{scope}[shift={(3,-1.5)}]
      \fill[opacity=0.1] (0,3) rectangle (3,0);
      \foreach \x in {0.2,0.4,...,3}
        \draw[very thin, black!60] (\x,3) -- (\x,\x) -- (3,\x);
      \draw[white,very thick] (0,0) -- (2,2);
      \draw[thick] (0,3) -- (0,0) -- (3,0);
      \draw[dashed] (0,0) -- (2,2) node[cross] {};
    \end{scope}
    \draw[->] (6.5,0) -- node[anchor=south] {changing the} node[anchor=north] {branch cut} (8,0);
    \begin{scope}[shift={(8.5,-1.5)}]
      \fill[opacity=0.1] (0,3) rectangle (3,-1);
      \foreach \x in {0.2,0.4,...,3}
        \draw[very thin, black!60] (\x,3) -- (\x,-1);
      \draw[white,very thick] (0,0) -- (2,2);
      \draw[thick] (0,3) -- (0,-1);
      \draw[dashed] (2,2) node[cross] {} -- (3,3);
      \fill (1,1) circle[radius=1pt] node[anchor=west] {$T^0_{1,1}$};
    \end{scope}
    \begin{scope}[shift={(4.75,-3)}]
      \draw (0,-1) node[anchor=north] {$[e]_{T^0_{1,1}}$};
      \clip[draw] (0,0) circle[radius=1];
      \foreach \x in {-1,-0.8,...,1}
        \draw[very thin, black!60] (\x,1) -- (\x,-1);
      \draw[very thick,black!30] (-1,-1) -- (1,1);
      \fill (0,0) circle[radius=1pt];
    \end{scope}
  \end{tikzpicture}
  \caption{Constructing the Chekanov torus $T^0_{1,1}$.}
  \label{fig:babys_second_vd}
\end{figure}

For further examples of distinguishing Lagrangian tori using versal deformations see \cite{Che96,CheSch10,chekanovschlenk2015,brendel2020real,brendel2023hamiltonian,brendel2023local}.
For a detailed expository introduction to the Chekanov torus, see \cite{Bre22}.

\section{Upper bound on displacement energy: probes}
\label{sec:upper_bound}

Let $T(x)$ in $B_{dpq}$ be a regular almost toric fibre with $x \in \Delta_{dpq} \setminus R$, with $R$ being the eigenline of the mondromy as in \eqref{eqn:eigenline}.
We use the method of probes to compute an upper bound on the displacement energy of $T(x)$.
Probes were introduced by McDuff \cite{mcduff2011displacing} to prove the displaceability of toric fibres, see also \cite{AbrBorMcD14}.
In \cite{brendel2020real}, they were used to compute an upper bound on the displacement energy of toric fibres.

Our main observation is that, away from nodes and branch cuts, almost toric systems are toric, compare also \cref{thm:toricmomentmap}, and thus the method of probes applies.
For basic definitions and statements about probes, we refer to \cite{mcduff2011displacing}, especially \cite[Definition 2.3, Lemma 2.4]{mcduff2011displacing}.

Recall $Δ_{dpq}$ from \cref{fig:Bdpq_moment_image}.


\begin{lemma}
    \label{thm:upper_bound}
    Let $x \in \interior \Delta_{dpq} \setminus R$.
Then the displacement energy of the regular almost toric fibre $T(x)$ satisfies
    \[ e(T(x))\leq x_1, \]
    where $x_1$ is the first component of $x \in \Delta_{dpq} \subset \mathbb{R}^2$.
\end{lemma}


\begin{proof}
We will use the probe $P = \{(s,x_2) \, \vert \, s ≥ 0\} \subset \Delta_{dpq}$, where $x_2$ is the second component of $x \in \Delta_{dpq}$.
It intersects the boundary $∂ \Delta_{dpq}$ integrally transversally in the sense of \cite[Section 2.1]{mcduff2011displacing}.
However, note that $P$ may intersect nodes or the branch cut, depending on the position of nodes in $\Delta_{dpq}$.
Since $x ∉ R$, we can, by \cref{thm:nodal_slide}, carry out a nodal slide such that $P$ is disjoint from the nodes and the branch cut.
By \cref{thm:toricmomentmap}, the almost toric moment map is toric on the preimage of a neighbourhood of $P$ and thus $P$ is a probe of infinite length.

By \cite[Lemma 2.4]{mcduff2011displacing}, the almost toric fibre $T(x)$ is displaceable.
To compute the upper bound on displacement energy, we follow the same line of argument as in \cite[Proposition 3.4]{brendel2020real}.
Let us give a brief outline for the reader's convenience.
We can view $\pi^{-1}(P)$ as the level set $\pi_2^{-1}(x_2)$ and note that $\pi_2$ generates a free Hamiltonian $S^1$-action on the preimage of a neighbourhood of $P$, which is disjoint from the nodes and branch cut.
Therefore, we can perform symplectic reduction to obtain a symplectic quotient $\pi_2^{-1}(x_2)/S^1$.
This symplectic quotient is a copy of $\mathbb{R}^2$ equipped with the standard symplectic form.
The Lagrangian torus $T(x)$ is contained in $\pi_2^{-1}(x_2)$ and invariant under the $S^1$-action by which we reduce.
One can check that it projects to a circle $C \subset \pi_2^{-1}(x_2)/S^1$ which encloses symplectic area $x_1$ in the reduced space.
This circle has displacement energy $e(C) = x_1$, and since any Hamiltonian diffeomorphism displacing $C$ with energy $e$ lifts to a Hamiltonian diffeomorphism displacing $T(x)$ with energy $e$ by \cite[Lemma 3.1]{brendel2020real}, we can conclude.
\end{proof}

\begin{remark}
    \label{rk:nondisplaceable}
    The above argument fails for some almost toric fibres over the ray $R$, namely for all\footnote{With the exception of the case $p=q=k=1$, which corresponds to the Chekanov torus and is displaceable by a probe.} $T^k_{pq}(a)$ with $k > 0$.
In fact, the tori $T^k_{pq}$ have been shown to have non-vanishing Lagrangian Floer homology, which implies that they are non-displaceable, by Lekili--Maydanskiy \cite{LekMay14} in the following two cases (see also \cref{rk:lekili}):
    \begin{enumerate}
        \item $p = q = 1$, arbitrary $d$, and $k > 1$;
        \item $d = 1$, arbitrary $p,q$, and $k = 1$.
    \end{enumerate}
    Indeed, for the first claim, note that $B_{d,1,1}$ appears as Milnor fibre of the smoothing of the $A_{d-1}$-singularity and thus \cite[Proposition 2.20]{LekMay14} implies the claim.
For the second claim, see \cite[Proposition 3.6]{LekMay14}.
In the special case $B_{2,1,1} \cong T^*S^2$ of 1., the torus $T_{1,1}^2(a)$ corresponds to the so-called \emph{Polterovich torus}, which had been shown to be non-displaceable earlier by Albers--Frauenfelder \cite{AlbFra08}.
\end{remark}

In light of this remark it seems reasonable to conjecture that all $T^k_{pq}(a) \subset B_{dpq}$ with $k > 0$ (with the exception of $p=q=k=1$) are non-displaceable.


\begin{proposition}
\label{thm:upper_bound_embedded}
  Let $φ\colon B_{dpq} ⊃ U → (X,ω)$ be a partial $B_{dpq}$\-/embedding.
Then there exists a neighbourhood $V \subset \Delta_{dpq}$ of the origin such that for all $x \in V$, we have $e(φ(T(x))) \leq x_1$.
\end{proposition}

\begin{proof}
    We displace $T(x)$ by a Hamiltonian diffeomorphism with support in $U \subset B_{dpq}$.
The proof is essentially the same as in \cref{thm:upper_bound}, with the exception that the probe is not infinitely long.
By \cref{def:partial_embedding}, the set $U$ contains the preimage $\pi^{-1}(W)$ of a neighbourhood $W$ of a line segment containing the origin and all nodes.
We consider all horizontal probes contained in $W$ and let $V$ be the set of points which are displaceable by such probes.
Recall from \cite[Section 2.1]{mcduff2011displacing} that this set consists of all points lying on the left half of a probe of this type.
Thus $V$ is a non-empty neighbourhood of the origin.
The displacement energy is estimated by the same argument as in the proof of \cref{thm:upper_bound}.
\end{proof}

\section{Lower bound on displacement energy: minimal J-holomorphic curves}
\label{sec:lower_bound}

We want to use a classical theorem by Chekanov \cite{chekanov1998}, that gives a lower bound on the displacement energy of Lagrangian submanifolds in certain symplectic manifolds.
To state the theorem we recall the central notions contained in the theorem.

Let $(X,\omega)$ be a symplectic manifold.
Define $\symcal{H}(X) ≔ \symcal{C}^\infty_c(X\times[0,1],\mathbb{R})$, the space of compactly supported, time-dependent Hamiltonian functions on $X$.
For $H \in \symcal{H}(X)$ let
\[
    \norm{H} ≔ \int_0^1 \left(\sup_{x \in X} H_t(x) - \inf_{x \in X} H_t(x) \right) dt
\]
be the \textbf{Hofer norm of $H$}. 

\begin{definition}
\label{def:displacement_energy}
    For a subset $A \subseteq X$ of a symplectic manifold $(X,\omega)$ define the \textbf{displacement energy} of $A$ to be 
    \[e(A) ≔ \inf\qty{\norm{H} \mid H \in \symcal{H}(X) \text{ such that } φ^H_1(A) \cap A = \emptyset },\]
    where $φ^H_1$ denotes the Hamiltonian diffeomorphism generated by $H$ and the infimum over the empty set is defined to be infinity.
\end{definition}

Chekanov's theorem only holds for a specific class of symplectic manifolds, namely geometrically bounded ones.

\begin{definition}
    \label{def:geobdd}
    Let $(X,\omega)$ be a symplectic manifold.
We call an almost complex structure $J$ on $(X,\omega)$ \textbf{geometrically bounded}\footnote{This is non-standard terminology.
We do not use the word \textit{tame} in order to avoid confusion with the notion of $\omega$-tame.} if there is a Riemannian metric $g$ on $X$ such that 
    \begin{enumerate}
        \item $g$ is complete,
        \item there are constants $c_1,c_2 > 0$ such that $\omega(JV,V) ≥ c_1 \norm{V}_g^2$ and $\abs{\omega(V,W)} ≤ c_2 \norm{V}_g \norm{W}_g$ for all tangent vectors $V,W$, and
        \item the sectional curvature of $g$ is bounded from above and the injectivity radius is bounded from below.
    \end{enumerate}
    Denote the space of such almost complex structures by $\symcal{J}_{\text{geo}}(X,\omega)$.
    The symplectic manifold $(X,\omega)$ is called \textbf{geometrically bounded} if there is a geometrically bounded $J$. 
\end{definition}

\begin{remark}
  \label{rem:Bdpq_geometrically_bounded}
    Closed symplectic manifolds are geometrically bounded, and the same holds for a large class of symplectic manifolds that look standard at infinity, i.e.\ cotangent bundles of compact symplectic manifolds and symplectizations of compact contact manifolds.
For more details on this notion see also \cite[Chapter X, Definition 2.2.1]{AudLaf94}.
In particular, $B_{dpq}$ is geometrically bounded because outside a compact subset it is symplectomorphic to one end of the symplectization of a certain lens space.
For more details see \cite{Eva19} and \cite{evans2021atfs}.
\end{remark}

\begin{remark}
  \label{rem:J_compactly_perturbed}
  It follows from the definition that if $J_0 \in \symcal{J}_\text{geo}(X,ω)$ is a geometrically bounded almost complex structure, $K ⊂ M$ compact, and $J$ is a tame almost complex structure such that $J = J_0$ on $M ∖ K$, then $J$ is also geometrically bounded.
\end{remark}

With these definitions in place we define the two quantities that play a crucial role in Chekanov's theorem.

\begin{definition}
    Suppose that $L$ is a compact Lagrangian submanifold in a symplectic manifold $(X,\omega)$ that is geometrically bounded.
Furthermore, let $J \in \symcal{J}_{\text{geo}}(X,\omega)$ be a geometrically bounded almost complex structure.
Define
    \begin{align*}
      \sigma_D(X,L,J) &≔ \inf \qty{ \int_{D} u^* \omega \;\middle|\, \parbox{15em}{\centering $u\colon(D,\partial D)\to(X,L)$\\non-constant $J$-holomorphic disc} } \\
      \sigma_S(X,J) &≔ \inf \qty{ \int_{S^2} u^* \omega \,\middle|\, \parbox{15em}{\centering $u\colon S^2 \to X$\\ non-constant $J$-holomorphic sphere} } \; .
    \end{align*}
    These two quantities may be equal to infinity, if the infimum is taken over an empty set.
We have that $\sigma_D, \sigma_S > 0$ in the case that $X$ is geometrically bounded. This is proven, for example, in \cite[Proposition 4.3.1 (ii)]{sikorav1994}.
\end{definition}


\begin{theorem}[Chekanov 1998 \cite{chekanov1998}]
  \label{thm:chekanov}
  Let $L$ be a compact Lagrangian submanifold of a geometrically bounded symplectic manifold $(X,ω)$.
For every geometrically bounded almost complex structure $J$, the displacement energy satisfies
  \[e(L) ≥ \min\qty{σ_D(X,L,J),σ_S(X,J)}.\]
\end{theorem}

Let $(M,ω,J)$ be a geometrically bounded connected symplectic manifold with geometrically bounded almost complex structure $J$, denote by $g$ a Riemannian metric as in \cref{def:geobdd}, and let $u\colon Σ → M$ be a J-holomorphic curve, where $Σ$ is a compact Riemann surface.

Then Gromov's Monotonicity Lemma (e.g.\ \cite[Proposition 4.3.1 (ii)]{sikorav1994}) gives us the following statement:

\begin{lemma}[Monotonicity]
  \label{thm:monotonicity}
  There exist constants\footnote{Typically, $r_0$ will be the lower bound on the injectivity radius in \cref{def:geobdd}.
If $J$ is chosen $ω$-compatible, we can choose $C=π/4$.} $C>0, r_0>0$, that depend only on $(M,ω,J)$, such that for all $x ∈ \im(u)$, $B_r(x)$ an open ball with respect to $g$ with $r<r_0$ and $u(∂Σ) ⊂ M ∖ B_r(x)$, we have
  \[∫_u ω ≥ C r² \; .\]
\end{lemma}

As a simple corollary we get that a $J$-curve crossing a certain distance, measured with respect to the Riemannian metric $g$, also must have a certain amount of area:

\begin{corollary}
  \label{thm:small_buffer}
  Suppose that $A^+, A^- ⊂ M$ are non-empty, that $Σ$ is a connected Riemann surface with $∂Σ = ∂Σ^+ ⊔ ∂Σ^-$, with both $∂Σ^±$ non-empty, and that $u\colon Σ → M$ is a $J$-holomorphic curve with $u(∂Σ^±) ⊂ A^±$.
  
  Let $δ=d(A⁺,A⁻)$, where $d$ denotes the metric induced by $g$, $N=\left\lfloor \frac{δ}{2r_0} \right\rfloor$ and $δ_r = δ-2r_0 N$.
  Then
  \[∫_u ω ≥ C(Nr_0^2+\frac{δ_r^2}{4}) \; .\]
\end{corollary}

\begin{proof}
  Pick a path $γ$ from $∂Σ^-$ to $∂Σ^+$.
  We want to place pairwise disjoint balls on $γ$.
  We have that $d((u ∘ γ) (1),A^-) ≥ δ$, so by the intermediate value theorem for each $0 ≤ n < N$ there is a $t_n ∈ [0,1]$ s.t.\ $d((u ∘ γ) (t_n),A^-) = (2n+1)r_0$.
  Also there is a $t_N$ such that $d((u ∘ γ) (t_N),A^-) = 2Nr_0 + δ_r/2$.
  Picking $x_n = (u ∘ γ)(t_n)$ for $0 ≤ n ≤ N$ and using the triangle inequality we have that $\{B_{r_0}(x_n) \mid 0 ≤ n < N\} \cup \{B_{δ_r/2}(x_N)\}$ are pairwise disjoint.
  See \cref{fig:small_buffer}.
  Applying \cref{thm:monotonicity} to each $B_r(x_n)$ we get the desired result.
\end{proof}

\begin{figure}
  \centering
  \begin{tikzpicture}
    \draw[thick] (-2,0) node[anchor=east] {$A⁻$} -- (2,0);
    \draw (-2,0.5) -- (2,0.5) node[anchor=west] {$r_0$};
    \draw (-2,1.5) -- (2,1.5) node[anchor=west] {$3r_0$};
    \draw (-2,2.4) -- (2,2.4) node[anchor=175] {$4r_0 + δ_r/2$};
    \draw[dashed] (-2,2.8) -- (2,2.8) node[anchor=-175] {$d(A⁻,A⁺)$};
    \draw[thick] (-2,3) node[anchor=east] {$A⁺$} .. controls +(1,-0.86) and +(-1,0.4) .. coordinate[pos=0.7](A) (2,4);
    \draw[purple] (-1,0) .. controls +(0.2,2) and +(0.4,-3) .. node[pos=0.93,anchor=west] {$γ$} (A);
    \draw (-0.9,0.5) circle[radius=0.5] (0.1,1.5) circle[radius=0.5] (0.85,2.4) circle[radius=0.4];
  \end{tikzpicture}
  \caption{Placing disjoint balls on $u$ between $A⁻,A⁺$}
  \label{fig:small_buffer}
\end{figure}

\begin{proposition}
  \label{thm:displacement_energy} 
  Take $X = B_{dpq}$ and let $L = T(x)$ be an almost toric fibre (with respect to the almost toric structure described in \cref{sec:modelspaces}) with $x \notin R$, where $R$ is defined in \eqref{eqn:eigenline}.
Then we have
    \[
        e(T(x)) = x_1.
    \]
\end{proposition}
\begin{proof}
    Recall that, as a set, we have $\Delta_{dpq} = \mathbb{R}_{≥0} \times \mathbb{R}$.
    Without any nodes, this is the toric moment image of $ℂ × T^* S^1$ under the moment map
  \begin{align*}
    μ_0 \colon ℂ × T^* S^1 &→ \mathbb{R}_{≥ 0} \times \mathbb{R}\\
    (z,p,θ) &↦ (π\abs{z}^2, p) \; ,
  \end{align*}
  where $ℂ × T^* S^1$ is equipped with the symplectic structure $ω_0 = ω_ℂ ⊕  ω_{T^*S¹}$, the two direct summands being the standard symplectic structures on $ℂ$ and $T^*S¹$ respectively.
We also equip $ℂ × T^*S¹$ with the complex structure $J_0 = i \oplus i $.
The second factor of $J_0$ comes from the identification $T^*S^1 = \mathbb{C}/\mathbb{Z}$, where $\mathbb{Z}$ acts on $\mathbb{C}$ by translation along the real axis.
This complex structrure is compatible with $\omega_0$ and geometrically bounded with respect to the induced metric, which is the Riemannian metric given by
  \[ d((z_1,p_1,θ_1), (z_2,p_2,θ_2))^2 = \abs{z_2 - z_1}^2 + (p_2 - p_1)^2 + \min_{k ∈ ℤ}\{(θ_2 - θ_1 + 2πk)^2\}\]
  for $(z_i,p_i,θ_i) ∈ ℂ × T^* S¹$.

  Let $u,v ∈ \im μ_0$.
Then we have
  \begin{equation}
    \label{eq:metricineq}
      d(μ_0^{-1}(u),μ_0^{-1}(v))^2 ≥ (\sqrt{v_1}-\sqrt{u_1})^2 + (v_2-u_2)^2 ≕ d_{μ_0}(u,v)^2 \; ,
  \end{equation}
  where $d_{\mu_0}$ defines a metric on $\im μ_0$.

  Let $C,r_0$ be the constants coming from \cref{thm:monotonicity} for $( ℂ × T^* S¹, ω_0, J_0)$.
Take $δ>0$ such that the expression $C(Nr_0^2 + δ_r^2/4)$ in \cref{thm:small_buffer} is greater than $x_1$.
  Set $A_0^- = \{x\}$, 
  \begin{align}
        \label{eq:a0def}
        A_0 &= \{y ∈ \im μ_0 \mid d_{μ_0}(x,y) ≤ δ \} \; ,\\
        A_0^+ &=\{y ∈ \im μ_0 \mid d_{μ_0}(x,y) = δ \} \; .
  \end{align}

  Let us now return to $B_{dpq}$.
  Since $x \notin R$ and $A_0 \subset \mathbb{R}_{≥ 0} \times \mathbb{R}$ is compact, we can perform a nodal slide whose support does not contain $x$ to remove all nodes and branch cuts from $A_0$, see also \cref{thm:nodal_slide}.
  Let $\pi \colon B_{dpq} \rightarrow \Delta_{dpq}$ be the almost toric moment map associated to this almost toric fibration.
  Since $A_0$ does not contain any nodes or branch cuts, the restriction $\pi\vert_{\pi^{-1}(A_0)} \colon \pi^{-1}(A_0) \rightarrow A_0$ is a toric moment map and thus, using Delzant's theorem \cite[Theorem 2.1]{Del88}, we identify $\pi^{-1}(A_0) ⊂ B_{dpq}$ with $μ_0^{-1}(A_0) ⊂ ℂ × T^* S¹$ by an equi\-va\-ri\-ant symplectomorphism.
  Let $J_{B_{dpq}}$ be a geometrically bounded almost complex structure on $B_{dpq}$, which exists by \cref{rem:Bdpq_geometrically_bounded}.
  Let $K$ be a compact set whose interior contains $π^{-1}(A_0)$.
  By \cref{rem:J_compactly_perturbed} there exists a geometrically bounded almost complex structure $J$ on $B_{dpq}$ such that $J=J_{B_{dpq}}$ on $B_{dpq} ∖ K$ and $J=J_0$ on $μ^{-1}(A_0)$.
  Set $A^± = \pi^{-1}(A_0^±), A = \pi^{-1}(A_0)$ and suppose $u\colon (D,∂D) → (B_{dpq}, T(x))$ is a $J$-holomorphic disk. 
  
  If $u(D) ⊂ A$, then, under the identification $A=\pi^{-1}(A_0) \cong μ_0^{-1}(A_0) \subset \mathbb{C} \times T^*S^1$, it defines a relative homology class $[u] ∈ H_2(ℂ × T^*S¹, T(x))$.
Therefore $[u]$ is a positive multiple of the generator $D_0$ of $H_2(ℂ × T^*S¹, T(x))$, which satisfies $∫_{D_0} ω_0 = x_1$.
  
  If $u(D)$ is not contained in $A$, then $u(D) ∩ A^+$ is non-empty.
Let $Σ ⊂ D$ be the connected component of $u^{-1}(A)$ containing $∂D$.
Using \cref{thm:small_buffer} and \eqref{eq:metricineq} for $A^±$ and $u|_Σ$, we get
  \[∫_u ω ≥ ∫_{u|_Σ} ω ≥ C(Nr_0^2 + δ_r^2/4) ≥ x_1 \;. \]

In both cases, we conclude that $∫_{u} ω ≥ x_1$, so $σ_D(B_{dpq},T(x),J) ≥ x_1$.

Since $H_2(B_{dpq})$ is generated by Lagrangian spheres (by \cite[Lemma 7.11]{evans2021atfs}), there are no non-constant $J$-holomorphic spheres, and $σ_S(B_{dpq},J) = ∞$.

Therefore \cref{thm:chekanov} and \cref{thm:upper_bound} allows us to conclude.
\end{proof}

As for the upper bound in \cref{thm:upper_bound_embedded}, there is an analoguous statement for small enough tori in partial $B_{dpq}$\-/embeddings (\cref{def:partial_embedding}).

\begin{proposition}
  \label{thm:displacement_energy_embedded}
    Let $φ \colon B_{dpq} ⊃ U → (X,ω)$ be a partial $B_{dpq}$\-/embedding into a geometrically bounded symplectic manifold $(X,\omega)$.
Then there exists a neighbourhood $V \subset \Delta_{dpq}$ of the origin such that for all $x \in V \setminus R$ we have $e(φ(T(x))) = x_1$.
\end{proposition}

\begin{proof}
  We proceed in a similar way as in \cref{thm:displacement_energy}:
  Set $A_0(x) = \{y ∈ \im μ_0 \mid d_{μ_0}(x,y) ≤ δ \}$ as defined in the proof of \cref{thm:displacement_energy} and take $V ⊂ Δ_{dpq}$ a neighbourhood of the origin such that $\pi^{-1}(A_0(x))$ is contained in $U$ for all $x ∈ V$.
  Assume additionally that $φ(π^{-1}(\symcal{A}_0))$, where $\symcal{A}_0 = ⋃_{x ∈ V} A_0(x)$, is contained in the interior of some compact set $K \subset X$.
  This can be achieved by further restricting $V$.

  Let $J_X$ be a geometrically bounded almost complex structure on $X$, and $J_0$ the almost complex structure on $π^{-1}(\symcal{A}_0)$ obtained by identifying $π^{-1}(\symcal{A}_0)$ with $μ_0^{-1}(\symcal{A}_0)$.
  Let $J$ be a geometrically bounded almost complex structure on $X$ with $J = φ_* J_0$ on $φ(π^{-1}(\symcal{A}_0))$ and $J = J_X$ on $X ∖ K$.
  For any fixed $x ∈ V \setminus R$, we conclude as in \cref{thm:displacement_energy} that any $J$-disk $u \colon (D,∂D) → (X,φ(T(x)))$ has at least area $x_1$, so $σ_D(X,φ(T(x)),J) ≥ x_1$.

  Unlike $B_{dpq}$, the space $X$ might contain $J$-spheres. In order to deduce the claim from \cref{thm:chekanov}, we additionally require that $x_1 < σ_S(X,J)$, which is done by further restricting $V$.
  By \cref{thm:chekanov} we get $e(φ(T(x))) ≥ x_1$.

  Restricting $V$ once more, we use \cref{thm:upper_bound_embedded} to get $e(φ(T(x))) ≤ x_1$.
\end{proof}

\section{Proof of main theorems}
\label{sec:main_thm}

 Let $d,p,q \in \mathbb{N}$ be integers such that $d \geqslant 1$ and $p,q$ coprime, and thinking of $q$ as en element of $ℤ_p/{±1}$.

 \cref{thm:displacement_energy} yields the first step of the outline given in \cref{sec:howto_exotic}. To compute the displacement energy germ $[e]_L$ of $L = T^k_{pq}(a)$ (see \cref{def:our_tori}) on an open dense subset, we adapt the method in \cref{sec:howto_exotic} to the case at hand.

\begin{theorem}
  \label{thm:main}
  The displacement energy germ of $T_{pq}^k(a) \subset B_{dpq}$ satisfies 
  \begin{equation}
    \label{eq:main_germ}
      [e]_{T^k_{pq}(a)} (b) \sim a + \min\qty{b_1, b_1 (1-kpq) + b_2 k p^2}
  \end{equation}
    for some identification $H^1(L;\mathbb{R}) \cong \mathbb{R}^2 = \{(b_1,b_2)\}$.
\end{theorem}

\begin{figure}
  \centering
  \begin{tikzpicture}
    \begin{scope}[shift={(-5,-0.5)}]
      \draw[fill,opacity=0.1] (0,-1) rectangle (4,2);
      \draw[very thin,black!60] \foreach \x in {0.33,0.66,...,3.99} {(\x,-1) -- (\x,2)};
      \draw[ultra thick,white] (0,0) -- (4,2);
      \draw[thick] (0,-1) -- (0,2);
      \draw[dashed] (1,0.5) node[cross] {} -- (2,1) node[cross] {} -- (3,1.5) node[cross] {} -- (4,2);
      \draw[fill] (2.5,1.25) circle[radius=1pt] node[anchor=south] {$x_a$};
      \draw (2,-1) node[anchor=north] {$π$};
    \end{scope}
    \draw[->] (-0.5,0) -- node[anchor=south] {$\overline{S}_{kv}$} (0.5,0);
    \begin{scope}[shift={(1,-0.5)}]
      \draw[fill,opacity=0.1] (0,2) -- (0,0) -- (4,1.2) -- (4,2);
      \begin{scope}
        \clip (0,2) -- (0,0) -- (4,1.2) -- (4,2);
        \draw[very thin,black!60] \foreach \x in {0.33,0.66,...,3.99} {(\x,2) -- (\x, 0.5*\x) -- (4,1.2+0.2*\x)};
      \end{scope}
      \draw[ultra thick,white] (0,0) -- (4,2);
      \draw[thick] (0,2) -- (0,0) -- (4,1.2);
      \draw[dashed] (0,0) -- (1,0.5) node[cross] {} -- (2,1) node[cross] {} (3,1.5) node[cross] {} -- (4,2);
      \draw[fill] (2.5,1.25) circle[radius=1pt] node[anchor=south] {$x_a$};
      \draw (2,-1) node[anchor=north] {$π'$};
    \end{scope}
    \begin{scope}[shift={(7,0)}]
      \begin{scope}
        \clip[draw] (0,0) circle[radius=1];
        \draw[very thin,black!60] \foreach \x in {-5, -4.66,...,1} {(\x,2) -- (\x, 0.5*\x) -- (4,1.2+0.2*\x)};
        \draw[ultra thick,black!20] (-2,-1) -- (2,1);
        \fill (0,0) circle[radius=1pt];
      \end{scope}
      \draw (0,-1) node[anchor=north] {$[e]_{T^k_{pq}(a)}$};
    \end{scope}
  \end{tikzpicture}   
  \caption{Image of the almost toric moment maps $\pi$ and $\pi'$, before and after changing the branch cut. To the right are the level sets of the displacement energy germ of the fibre $T^k_{pq}(a) = T(x_a)$ as in \eqref{eq:displacement_energy_germ}.}
  \label{fig:mod_moment_map}
\end{figure}

\begin{proof}
    Let $\pi \colon B_{dpq} \rightarrow \Delta_{dpq}$ be an almost toric moment map with $k$ nodes to the left of the point $x_a =\left( a, \frac{aq}{p}\right)$.
Then the almost toric fibre of $\pi$ over $x_a$ is $T^k_{pq}(a)$ by \cref{def:our_tori}.
Note that if $k \neq 0$, then $x_a$ lies on a branch cut of $\Delta_{dpq}$, as on the left-hand side of \cref{fig:mod_moment_map}.
To apply \cref{thm:VDatffibres} we perform changes in branch cut to the $k$ nodes to the left of $x_a$.
As a result, we obtain a new almost toric moment map $\pi' \colon B_{dpq} \rightarrow \Delta'$, see the right-hand side of \cref{fig:mod_moment_map}.
By \cref{thm:change_branchcut}, its image $\Delta'$ is given by $\overline{S}_v^k (\Delta_{dpq}) = \overline{S}_{kv}(\Delta_{dpq})$ with $v = (-p,-q)$.
In matrix form, the corresponding shear map is given by 
    \begin{equation}
        \label{eq:displacement_energy_germ}
        S_{kv} = 
        \mqty(kpq+1 & -kp²\\ kq² & 1-kpq), \quad
        v = (-p,-q).
    \end{equation}
    Furthermore, the respective almost toric fibres are identified as follows,
    \begin{equation}
        \label{eq:ATF_fibres_switch}
        (\pi')^{-1}\qty(\overline{S}_{kv}(x)) = \pi^{-1}(x), \quad
        x \in \operatorname{int} \Delta.
    \end{equation}
    By \cref{thm:VDatffibres}, we obtain a versal deformation of $L =T^k_{pq}(a)$ by setting
    \begin{equation}
        \label{eq:VD_piprime}
        v_L(b) = (\pi')^{-1}(x_a + b), \quad
        b \in V \subset H^1(L; \mathbb{R}) \cong \mathbb{R}^2,
    \end{equation}
    where $V$ is a small enough neighbourhood of the origin.
As described in \cref{sec:vd_AL}, we chose the identification $H^1(L; \mathbb{R}) \cong \mathbb{R}^2$ induced by the identification $H_1(L) \cong \mathbb{Z}^2$ via the closed orbits of the local $T^2$-moment map defined by $\pi'$ in a neighbourhood of $x_a$.
Using \eqref{eq:ATF_fibres_switch}, we can apply \cref{thm:displacement_energy} to determine the displacement energy of all fibres $(\pi')^{-1}(x)$ for all $x \in \Delta' \setminus R$.
In light of the fact that \eqref{eq:VD_piprime} is a versal deformation, this proves the claim.
\end{proof}

Now let $\varphi \colon B_{dpq} \supset U \rightarrow (X,\omega)$ be a partial $B_{dpq}$\-/embedding in the sense of \cref{def:partial_embedding}.
In \cref{thm:displacement_energy_embedded}, we have proved that $e(\varphi(T(x))) = e(T(x)) = x_1$ for small enough $x \in \Delta_{dpq}$.
This means that the same method as in the proof of \cref{thm:main} can be used to determine the displacement energy germ of such $\varphi(T(x)) \subset X$. 

\begin{theorem}
    \label{thm:main_embedded}
    Let $\varphi \colon B_{dpq} \supset U \rightarrow (X,\omega)$ be a partial $B_{dpq}$\-/embedding into a geometrically bounded symplectic manifold $(X,\omega)$.
Then there exists $a_0 > 0$ such that for all $a < a_0$, the displacement energy germ of $\varphi(T^k_{pq}(a)) \subset X$ satisfies
        \begin{equation}
            \label{eq:main_germ_embedded}
            [e]_{\varphi(T^k_{pq}(a))} (b) \,\sim\, a + \min\qty{b_1, b_1 (1-kpq) + b_2 k p^2}.
        \end{equation}
\end{theorem}

\begin{proof}
  Let $V ⊂ Δ_{dpq}$ be the subset given by \cref{thm:displacement_energy_embedded} such that $e(φ(T(x))) = x_1$ for $x ∈ V$.
  Let $a_0$ be the supremum over all $a$ such that $x_a = \qty(a,\frac{aq}{p}) ∈ V \setminus R$.
  Picking $a<a_0$ and setting $L = T^k_{pq}(a)$ we construct the versal deformation $v_L$ in the same manner as in \cref{thm:main}.
  Now $v_{φ(L)} = φ ∘ v_L ∘ φ^*$ is a versal deformation of $φ(L)$, where $φ^*$ is the induced map on cohomology.
  As $φ$ preserves the displacement energy of $T(x)$ for $x ∈ V \setminus R$ by \cref{thm:displacement_energy,thm:displacement_energy_embedded}, we have $[e]_L \sim [e]_{φ(L)} ∘ φ^*$.
\end{proof}

Using \cref{thm:main,thm:main_embedded}, we can prove \cref{thm:A,thm:B}: 

\begin{proof}[Proof of \cref{thm:A,thm:B}]
We show that if $[e]_{T^k_{pq}(a)} \circ Φ \sim [e]_{T^{k'}_{p'q'}(a')}$ for some $Φ \in \GL(2;\mathbb{Z})$, then $a = a'$ and either $k=k' = 0$ or $(k,p,q) = (k',p',q')$.
The statement that $a = a'$ is obviously true.
Equations \eqref{eq:main_germ} and \eqref{eq:main_germ_embedded} are both given as the minimum of two linear functions $α^k_{pq},β^k_{pq}$, where
\[α^{ka}_{pq}(b) = a + \det(b,\mqty(0 \\ 1)) \quad β^k_pq(b) = a - \det(b,\mqty(kp² \\ kpq-1)) \; .\]
The set $\{α^k_{pq} = β^k_{pq}\}$ is given by the space spanned by the vector $v=(p,q)$.
Denote by $u_1 = \mqty(0 \\ 1)$ and $u_2 = \mqty(kp² \\ kpq -1)$ the vectors pointing along the level sets of $α^k_{pq}$ and $β^k_{pq}$ respectively, and define the vectors $v',u'_1,u'_2$ similarly.

Similarly to \cref{rem:atf_corner_type_calc}, the integral affine angle between $v$ and $u_1$ (or $u_2$) determines $(p,q) ∈ ℕ_{>0} × ℤ_p/{±1}$, and $u_1+u_2 = k(p,q)$, determining $k$.
So if $\min\qty{α^k_{pq},β^k_{pq}} ∘ Φ \sim \min\qty{α^{k'}_{p'q'},β^{k'}_{p'q'}}$, then $Φ(v') = v$, $Φ(\{u'_1,u'_2\}) = \{u_1,u_2\}$ and by the above $(k,p,q) = (k',p',q')$.

    We show that $T^k_{pq}(a) \sim T^{k'}_{pq}(a)$.
    Denote by $π_k,π_{k'}$ the almost toric moment maps used in \cref{def:our_tori} for $T^k_{pq}(a), T^{k'}_{pq}(a)$ respectively. We have $T^k_{pq}(a) = π_k^{-1}(x_a)$ and $T^{k'}_{pq}(a) = π_{k'}^{-1}(x_a)$.
    Suppose that $ε>0$ and take the Lagrangian isotopies $Λ_t^k = π_k^{-1}(x_a+(0,tε))$ and $Λ_t^{k'} = π_{k'}^{-1}(x_a+(0,tε))$.
    By \cref{thm:VDtoricfibre}, $\Flux(Λ^k) = \Flux(Λ^{k'}) = (0,ε)$.
    Using a nodal slide as in \cref{thm:nodal_slide} we may identify $Λ_1^k$ and $Λ_1^{k'}$.
    Concatenating $Λ^k$ and the inverse of $Λ^{k'}$ we get a Lagrangian isotopy $Λ$ from $T^k_{pq}(a)$ to $T^{k'}_{pq}(a)$ with $\Flux(Λ) = \Flux(Λ^k) - \Flux(Λ^{k'}) = 0$.
    The Maslov class is preserved under Lagrangian isotopies, and $\Flux(Λ) = 0$ means that the area class is preserved as well.
\end{proof}


\begin{remark}
    \label{rk:lekili2}
    As mentioned in \cref{rk:lekili}, some special cases of \cref{thm:A} can be deduced from \cite{LekMay14}. Indeed, 
    \begin{enumerate}
        \item for $p = q = 1$ and arbitrary $d$, the space $B_{d,1,1}$ appears as Milnor fibre of the smoothing of the $A_{d-1}$-singularity (see also \cite[Section 7.3]{evans2021atfs}) and \cite[Lemma 2.19]{LekMay14} yields a count of Maslov index two $J$-holomorphic disks with boundary on the tori $T^k_{1,1}$. This count depends on $k$ and, by monotonicity of the tori, is a symplectic invariant, see \cite{EliPol97}. Thus \cite[Lemma 2.19]{LekMay14} distinguishes the tori.
        \item for $d = 1,p \neq 1$ and $(p,q) ≠ (1,0)$, the torus $T^1_{pq}(a)$ is non-displaceable by \cite[Proposition 3.6]{LekMay14}.
        Since $T^0_{pq}$ is displaceable by the methods used in \cref{sec:upper_bound}, we deduce $T^0_{pq} \ncong T^1_{pq}$.
    \end{enumerate}
    The special case of $d=2,p=1,q=0$ corresponds to $B_{2,1,0} \cong T^*S^2$ and thus follows from earlier work \cite{AlbFra08}, see also the discussion in \cref{ex:cotangent}.
    Our method of proof is different from the one used in \cite{LekMay14}.
    Instead of a count of Maslov index two $J$-holomorphic disks, we rely on the displacement energy germ to distinguish tori.
    The upshot of the method used in \cite{LekMay14} is that it yields non-displaceability results via computing the Floer homology.
    Our methods, on the other hand can be applied to non-monotone tori, which is crucial in \cref{thm:B}. Because of bubbling, the count of Maslov index two $J$-holomorphic disks depends on the choice of $J$ and does not yield an invariant in that case.
\end{remark}

\section{Examples}
\label{sec:examples}

Along with \cref{thm:lag_sphere,thm:pinwheels,thm:quinticgodeaux} given in the introduction, we have the following:

As discussed in \cite[Remark 7.10]{evans2021atfs}, if $d>1$, the space $B_{dpq}$ contains a Lagrangian $S²$.
Together with \cref{thm:lag_sphere}, this means every time we have a partial $B_{dpq}$\-/embedding with $d>1$, we also get a partial $B_{2,1,0}$\-/embedding "for free".
In particular a Polterovich torus $T^2_{1,0} ⊂ B_{2,1,0}$ is contained in any partial $B_{dpq}$\-/embedding with $d>1$.
By \cref{thm:B} small enough such tori are distinct from the $T_{pq}^k$ coming from the same embedding.

\subsection{Stretching an edge}
\label{sec:stretch_edge}

\begin{proposition}
  \label{thm:toric_embeddings}
  Let $Δ ⊂ ℝ²$ be a compact (almost) toric base diagram with finitely many nodes, and $(X,ω)$ the corresponding (almost) toric manifold.
  Then there is a sequence $(d_i,p_i,q_i)$ with $p_i → ∞$ such that there is a partial $B_{d_i,p_i,q_i}$\-/embedding into $M$.
\end{proposition}

We can assume, after performing nodal trades, that every vertex of $Δ$ has one or multiple corresponding nodes and, by nodal slides, that all the branch cuts are negligibly small.

Recall from \cref{def:atf_corner} that an ATF-corner $u$ consists of a pair $u=(x,dv)$ given by a vertex $x$ and a multiple $dv$ of the branch cut direction.

\begin{definition}
  \label{def:mutation_at_atf_corner}
  The \textbf{mutation at $(x,dv)$} is given by performing a change of branch cut at all nodes lying on the branch cut $v$ as in \cref{thm:change_branchcut}, followed by nodal slides to make the newly created branch cut negligibly small.
\end{definition}

Also, recall that the piece-wise linear map associated to the change of branch cut is given by $\overline{S}_{(x,dv)}$, as defined in \eqref{eq:half-shear}.

The idea of the proof of \cref{thm:toric_embeddings} is to perform an infinite sequence of mutations on $Δ$, to obtain a sequence of partial $B_{d_i p_i q_i}$\-/embeddings.
In order to avoid some cyclical behaviour in the sequence $(d_i,p_i,q_i)$, we fix an edge and perform iterated mutations at its left end.
Under this operation the integral affine length of the edge in question increases.

\begin{remark}
  Let us briefly describe what the algorithm in the proof of \cref{thm:toric_embeddings} yields for the case of $X = \mathbb{C}P^2$.
  Vianna \cite{Via16} proved that the set of ATF-base diagrams of $\mathbb{C}P^2$ obtained from the toric Delzant polytope by mutations is, up to nodal slides, in bijection with so-called Markov triples, i.e.\ solutions to the Markov equation.
  In the case of $\mathbb{C}P^2$ it follows immediately from the definition of the sequence of mutations used in the proof of \cref{thm:toric_embeddings} that, starting from the standard toric structure, this sequence corresponds to the unique path of Markov triples in the Markov tree that contain a one.
  If we start at another Markov triple, it corresponds to the path in the Markov tree obtained by fixing one number in the Markov triple.
For more details on this, and in particular the combinatorics of the sequences involved, we refer to \cite[Section~8.4, Appendix~I]{evans2021atfs}.
\end{remark}

\begin{proof}[Proof of \cref{thm:toric_embeddings}]
To simplify, we slightly abuse notation and denote by $u$ the ATF-corner as well as the corresponding vertex $x$. Throughout the proof we assume, possibly after performing nodal slides, that all branch cuts are negligibly small.

\medskip

\emph{Step 1}:
Set $Δ_0 = Δ$ and pick an edge $e_0$ of $Δ_0$.
We may assume $e_0 ⊂ ℝ × \{0\}$ and $Δ_0 ⊂ ℝ × ℝ_{ ≥0}$.
We will elongate $e_0$ by repeated iterations at an adjacent ATF-corner.
In other words, we will define a sequence $\{\Delta_n\}_{n \in  \mathbb{N}}$ of almost toric base diagrams obtained by mutation from $\Delta_0$, which contain a distinguished edge $e_n \subset \Delta_n$.

Let $u_1^0,…,u_{n_c}^0$ be the ATF-corners of $Δ_0$, where $n_c$ is the number of ATF-corners.
Let $Δ_{n+1} = \overline{S}_{u_{k_n}^n} Δ_n$ be the result of mutating $Δ_n$ at the ATF-corner $u_{k_n}^n$ next to $e_n$ in the clockwise direction and if $e_n$ has multiple non-isolated ATF-corners at this vertex, we pick $u_{k_n}^n = (x,v)$ for which $v$ forms the smallest angle with $e_n$.
Let $u_1^{n+1},…,u_{n_c}^{n+1}$ be the corners of $Δ_{n+1}$, such that for $i ≠ k_n$ we have $\overline{S}_{u_{k_n}^n} u_i^n = u_i^{n+1}$ and such that for $i=k_n$, $u_{k_n}^{n+1}$ is the new ATF-corner created by the mutation at $u_{k_n}^n$.\footnote{After a mutation we might loose an ATF-corner if the eigenline of $u_{k_n}^n$ intersects $∂Δ_n$ in another ATF-corner with the same eigenline.
We can assume without loss of generality that this does not happen. Indeed, the sequence $Δ_n$ must attain its minimum number of ATF-corners, so it will be constant for all $n ≥N$ for some $N ∈ ℤ$ and we then take $Δ_0=Δ_N$.} In other words, the elements in the set $\{1,\ldots,n_c\}$ can be thought of as labels of ATF-corners, where every ATF-corner in $Δ_{n+1} = \overline{S}_{u_{k_n}^n} Δ_n$ inherits the label of its preimage in $\Delta_n$, except for the newly created ATF-corner in $\Delta_{n+1}$, which inherits the label of the ATF-corner in $\Delta_n$ at which mutation was performed.
See \cref{fig:stretch_iteration}, where we have indicated the labels by colours.
Note that $e_n$ lies in the half plane fixed by $\overline{S}_{u_{k_n}^n}$.
Take $e_{n+1}$ to be the edge of $Δ_{n+1}$ such that $e_{n+1} ⊃ e_n$.

\begin{figure}
  \centering
  \begin{tikzpicture}[scale=\textwidth/15cm]
    \begin{scope}[shift={(-6,0)}]
      \draw[very thick,fill,fill opacity=0.1,text opacity=1] (5,0) -- node[anchor=north] {$e_n$} (0,0) coordinate(A) -- (-0.5,1.5) coordinate (B) -- (2,4) coordinate (C) -- (3.5,3.5) coordinate (A1) -- (5,3);
      \draw[purple] (A) -- (A1);
      \draw[dashed] (A) node[anchor=north east] {$u_{k_n}^n$} -- +(1,1) node[cross] {};
      \draw[dashed] (B) node[anchor=east] {$u_1^n$} -- +(1,0.4) node[cross] {};
      \draw[dashed] (C) node[anchor=south] {$u_2^n$} -- +(0.2,-1) node[cross] {};
      \fill[purple] (A) circle[radius=2pt];
      \fill[orange] (B) circle[radius=2pt];
      \fill[blue] (C) circle[radius=2pt];
      \draw (0,4) node {$Δ_n$};
    \end{scope}
    \begin{scope}[shift={(2,0)}]
      \draw[very thick,fill,fill opacity=0.1,text opacity=1] (5,0) -- node[anchor=north] {$e_{n+1}$} (0,0) coordinate (A1) -- (-1,0) coordinate (B) -- (0,2) coordinate (C) -- (3.5,3.5) coordinate (A) -- (5,3);
      \draw[purple] (A) -- (A1);
      \draw[dashed] (A) node[anchor=south] {$u_{k_n}^{n+1}$} -- +(-1,-1) node[cross] {};
      \draw[dashed] (B) node[anchor=north] {$u_1^{n+1}$} -- +(0.8,1) node[cross] {};
      \draw[dashed] (C) node[anchor=east] {$u_2^{n+1}$} -- +(1,-0.3) node[cross] {};
      \fill[purple] (A) circle[radius=2pt];
      \fill[orange] (B) circle[radius=2pt];
      \fill[blue] (C) circle[radius=2pt];
      \draw (0,4) node {$Δ_{n+1}$};
    \end{scope}
  \end{tikzpicture}
  \caption{Moving from $Δ_n$ to $Δ_{n+1}$ by performing a mutation at $u_{k_n}^n$.}
  \label{fig:stretch_iteration}
\end{figure}

\medskip

  \emph{Step 2}: If $u_{k_n}^n$ is not isolated, we have $ℓ(e_{n+1}) = ℓ(e_n)$, where $ℓ(e)$ denotes the affine length of an edge $e$, otherwise $ℓ(e_{n+1}) > ℓ(e_n)$.
  Since the first case can only appear finitely many times successively, the monotone sequence $ℓ(e_n)$ has a strictly monotone subsequence.
  It is also bounded from above by the affine length of $∂Δ_0$.
  Define $ℓ_n = ℓ(e_{n}) - ℓ(e_0)$ and denote by $ℓ_∞$ the limit of $ℓ_n$ as $n → ∞$.

  \medskip
  
  \emph{Step 3}: The sequence $k_n ∈ \{1,…,n_c\}$ of labels contains some elements of $\{1,…,n_c\}$ infinitely many times.
  We may assume without loss of generality that all the elements which appear, appear infinitely many times. If this is not the case, we can choose $N$ such that this holds for $k_n$ with $n≥N$ and then set $Δ_0=Δ_N$. Furthermore, we can assume that the labels appearing infinitely many times are $\{1,…,n_c'≤n_c\}$, which can be achieved by relabelling.

  Note that the vertex $u_{k_0}^0 ∈ e_0$ at which we have performed the first mutation is fixed by all subsequent $\overline{S}_{u_{k_n}^n}$, so it makes sense to speak of $u_{k_0}^0 ∈ ∂Δ_n$ for all $n$.
  Denote by $g_n(x)$ the integral affine length of the portion of $\partial \Delta_n$ contained between $u_{k_0}^0$ and $x ∈ ∂Δ_n$ in the clockwise direction.
Note that we have $g_n(x) = g_{n+1}(\overline{S}_{u_{k_n}^n}x)$, since integral linear transformations preserve the affine length.

  Define $a_n = \max_{k ∈\{1,…,n_c'\}} \{g_n(u_k^n)\}$, which is the distance from $u_{k_0}^0$ to the  ATF-corner furthest away in terms of $g_n(\cdot)$ appearing in infinitely many mutations.
We have $a_n ≤ a_{n+1}$, since $g_n(u_k^n) = g_{n+1}(u_k^{n+1})$ if $k ≠ k_n$ and $g_n(u_{k_n}^n) < g_{n+1}(u_{k_n}^{n+1})$ otherwise.
Also $a_n ≥ ℓ_n = g_n(u_{k_n}^n)$ and $a_n ≤ ℓ_m$ for some $m>n$.
The latter claim follows from the fact that for $k ∈ \{1, …, n_c'\}$ realizing the maximum in the definition of $a_n$ we must have $k = k_m$ for some $m>n$, as $k$ appears infinitely many times in $\{k_m\}_{m ∈ ℕ}$, and thus $a_n = g_n(u^n_{k_m}) ≤ g_m(u^m_{k_m}) = ℓ_m$.
In particular, $a_n → ℓ_∞$ and we can choose a strictly monotone subsequence $a_{n_i}$ with $a_{n_i} > a_{n_i-1}$.

  \begin{figure}
    \centering
    \begin{tikzpicture}
      \draw[very thick,fill,fill opacity=0.1,text opacity=1] (5,0) -- (0,0) coordinate(A) -- (-0.5,1.5) coordinate (B) -- (2,4) coordinate (C) --(5,3);
      \draw[dashed] (A) -- +(1,1) node[cross] {};
      \draw[dashed] (B) -- +(1,0.4) node[cross] {};
      \draw[dashed] (C) -- +(0.2,-1) node[cross] {};
      \draw[fill,green!60!black] \foreach \n in {1,...,7} { (4.5-1/\n,3.166+0.333/\n) circle[radius=1.5pt] };
      \draw[->] (3.566,3.7) -- node[anchor=south] {$w_i$} +(1,-.333);
      \draw[fill,green!60!black] \foreach \n in {1,...,7} { (-2+2/\n,0) circle[radius=1.5pt] };
      \draw[->] (0,-.2) -- node[anchor=north] {$w'_i$} +(-2,0);
      \draw (0,4) node {$Δ_0$};
    \end{tikzpicture}
    \caption{Artist's impression of the convergence of $w_i$ and $w'_i$.}
    \label{fig:stretch_wi}
  \end{figure}

  \medskip
  
  \emph{Step 4}: Now chose the natural number $k$ realizing the maximum in the definition of $a_{n_i}$ and define $w_i = u_{k}^{n_i}$.
  Actually it follows from the definitions that $k = k_{n_i-1}$, since $a_{n_i}>a_{n_i-1}$ means that the maximum of $a_{n_i}$ must be created by the newly created ATF-corner in $Δ_{n_i}$, which is $u_{k_{n_i-1}}^{n_i}$.
  We have $w_i ∈ ∂Δ_0$: Indeed, the maps $\overline{S}_{u_{k_n}^n}\colon Δ_n \to Δ_{n+1}$ divide $∂Δ_n$ into two parts:
  If $x∈∂Δ_n$ satisfies $g_n(x) ∈ \qty[g_n(u_{k_n}^n),g_{n+1}(u_{k_n}^{n+1})]$, i.e. $x$ lies in the interval in $∂Δ_n$ from $u_{k_n}^n$ to $u_{k_n}^{n+1}$ in the clockwise direction, we have $\overline{S}_{u_{k_n}^n} x = S_{u_{k_n}^n} x$. Otherwise, $x$ is in the half plane fixed by $\overline{S}_{u_{k_n}^n}$.
  Since $g_{n_i}(w_i) > g_n(u_k^n)$ for all $k ∈ \{1,…,n_c\}$ and $n<n_i$, the point $w_i$ lies in the intersection of the half planes that are fixed by all the mutations that are applied in the sequence from $Δ_0$ to $Δ_{n_i}$.

  Define $w_i' = u_{k_{n_i-1}}^{n_i-1}$, which is the ATF-corner at which we mutated to obtain $Δ_{n_i}$.
  Denote by $w_∞ ∈ ∂Δ_0$ the limit point of $\{w_i\}_{i ∈ ℕ}$ and denote by $w'_∞$ the limit point of $\{w'_i\}_{i ∈ ℕ}$, contained in the line spanned by $e_0$.
  See \cref{fig:stretch_wi}.
  Define $v_i$ to be the primitive vector in the ATF-corner $w_i = (x,dv_i)$ pointing along $w_i'-w_i$, and $v_∞ = w_∞' - w_∞$.
  Denote by $f$ the edge of $Δ_0$ containing infinitely many $w_i$, as well as $w_∞$, and define $x_f$ to be the primitive vector pointing along $f$ in the counter-clockwise direction. Analogously, define $x_e$ to be the primitive vector pointing along $e_0$ in the counter-clockwise direction.
  Then for $i$ large enough $v_{i+1} = ηv_i + λx_f - μx_e$ with $η,λ,μ>0$.
  We have that $\det(x_f,v_i)>0$, by convexity of the ATF-base diagrams $Δ_n$, and also $\det(x_e,v_i)<0$.
  So
  \[
    \det(v_{i+1},v_i) = λ\det(x_f,v_i) - μ\det(x_e,v_i) > 0 \; .
  \]
  Denote the projection onto the unit circle by $π \colon ℝ² ∖\{0\} → S¹$.
  Since $\det(x_e,v_i)<0$, the points $\pi(v_i)$ are contained in a half-circle, and thus they converge strictly monotonically to $π(v_∞)$.
  Since $v_i$ is primitive, the Euclidean length $\norm{v_i}$ satisfies $\norm{v_i} → ∞$.

  The vector $v_∞$ is not parallel to $x_f$, since it would contradict the convergence of $w_i$ if it were parallel. So $p_i = \det(x_f, v_i) → ∞$ and $w_i$ is an ATF-corner of type $(d_i,p_i,q_i)$ in $Δ_{n_i}$.

  Using \cref{thm:atf_bdpq} we get a partial $B_{d_i p_i q_i}$\-/embedding for every $i ∈ ℤ$.
\end{proof}

\begin{remark}
    Based on simulations\footnote{Done using \url{https://github.com/schmijoe/delzant}.}, the situation described in the proof is always very simple: 
    We have $n_c'=2$ so that the number of ATF-corners appearing infinitely many times is two, so we always swap back and forth, as in the sequence of mutations used in \cite{EvaUrz21}.
\end{remark}

\emergencystretch=1em
\printbibliography
\end{document}
